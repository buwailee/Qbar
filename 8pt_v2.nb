(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    251543,       6553]
NotebookOptionsPosition[    247308,       6483]
NotebookOutlinePosition[    247665,       6499]
CellTagsIndexPosition[    247622,       6496]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"<<", "\"\<loop_amplitudes.m\>\""}], ";"}], "Code"], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "fun", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ab", "[", 
    RowBox[{"___", ",", "j_", ",", "___", ",", "j_", ",", "___"}], "]"}], ":=",
    "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sortab", "=", 
   RowBox[{"{", 
    RowBox[{"i_ab", "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Sort", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], "/", 
       RowBox[{"Signature", "[", 
        RowBox[{"Sort", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sortdoubleab", "=", 
   RowBox[{"{", 
    RowBox[{"i_doubleab", "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Sort", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], "/", 
       RowBox[{"Signature", "[", 
        RowBox[{"Sort", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sortcapinR", "=", 
   RowBox[{
    RowBox[{"R", "[", "a__", "]"}], "\[RuleDelayed]", 
    RowBox[{"R", "@@", 
     RowBox[{"(", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"List", "[", "a", "]"}], ",", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"ordercup", "@", "x"}], ",", 
           RowBox[{"ordercup", "[", "y", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Qlog", "[", "1", "]"}], ":=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Dmatrix", "[", "0", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"doubleab", "[", 
    RowBox[{"___", ",", "j_", ",", "___", ",", "j_", ",", "___"}], "]"}], ":=",
    "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Dmatrix", "[", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ab", "[", "x", "]"}], 
    RowBox[{"Dmatrix", "[", "y", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FuseDmatrices", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", "#", "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dmatrix", "[", "i_", "]"}], 
        RowBox[{"Dmatrix", "[", "j_", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"Dmatrix", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"abelim", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"n", "+", "1"}], ",", "y___"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"x", ",", "n", ",", "y"}], "]"}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", "B", ",", "y"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"abtre", "=", " ", 
   RowBox[{
    RowBox[{"ab", "[", 
     RowBox[{"aa___", ",", "B", ",", "bb___"}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"n", "-", "1"}], ",", "bb"}], "]"}], "-", 
     RowBox[{"\[Tau]", " ", 
      RowBox[{"ab", "[", 
       RowBox[{"aa", ",", "1", ",", "bb"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "n", ",", "2", ",", "3"}], "]"}], "/", 
        RowBox[{"ab", "[", 
         RowBox[{"n", ",", "1", ",", "2", ",", "3"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"e", " ", 
      RowBox[{"ab", "[", 
       RowBox[{"aa", ",", "2", ",", "bb"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{
          RowBox[{"n", "-", "2"}], ",", 
          RowBox[{"n", "-", "1"}], ",", "n", ",", "1"}], "]"}], "/", 
        RowBox[{"ab", "[", 
         RowBox[{
          RowBox[{"n", "-", "2"}], ",", 
          RowBox[{"n", "-", "1"}], ",", "2", ",", "1"}], "]"}]}], 
       ")"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"capexpand", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"x___", ",", " ", 
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
         RowBox[{"{", "c__", "}"}]}], "]"}], ",", " ", "y___"}], "]"}], " ", ":>",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"b", ",", " ", "c"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", " ", "a"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"shifexp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"shift", "[", 
        RowBox[{"y_", ",", "z_"}], "]"}], ",", "w___"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"x", ",", 
        RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "w"}], "]"}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", 
         RowBox[{"y", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "w"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mom", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", "+", "i"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"neab", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Det", "[", 
      RowBox[{"mom", "[", 
       RowBox[{"[", 
        RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"neab1", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Det", "[", 
      RowBox[{"mom1", "[", 
       RowBox[{"[", 
        RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"todmatrix", ":=", 
   RowBox[{
    RowBox[{"FuseDmatrices", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{"i_R", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"fromRform", "[", 
              RowBox[{"n", "+", "1"}], "]"}], "[", "i", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], 
          RowBox[{"Dmatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fromRform", "[", 
              RowBox[{"n", "+", "1"}], "]"}], "[", "i", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}]}]}], "//.", 
       "shifexp"}], "//.", "capexpand"}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"todmatrixn", ":=", 
   RowBox[{
    RowBox[{"FuseDmatrices", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{"i_R", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"fromRform", "[", "n", "]"}], "[", "i", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], 
          RowBox[{"Dmatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fromRform", "[", "n", "]"}], "[", "i", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}]}]}], "//.", 
       "shifexp"}], "//.", "capexpand"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DmatrixEval", "[", "fermions__", "]"}], " ", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dmatrix", "[", 
       RowBox[{"i_", "/;", 
        RowBox[{
         RowBox[{"Length", "[", "i", "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"{", "fermions", "}"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", 
              RowBox[{"#1", ",", 
               RowBox[{
                RowBox[{"{", "fermions", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "#2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "i", "]"}], ",", 
             RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Dmatrix", "[", "i_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"order", "[", 
    RowBox[{"exprn_", ",", 
     RowBox[{"option_:", "1"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"option", "\[Equal]", "0"}], ",", 
     RowBox[{"exprn", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Signature", "[", 
          RowBox[{"{", "x", "}"}], "]"}], " ", 
         RowBox[{"ab", "@@", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", "x", "}"}], "]"}]}]}]}], "}"}]}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nGuess", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"List", ",", 
                RowBox[{"Cases", "[", 
                 RowBox[{"exprn", ",", "_ab", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
         ",", "consec", ",", "xLike"}], "}"}], ",", 
       RowBox[{
        RowBox[{"consec", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Range", "[", "nGuess", "]"}], ",", "2", ",", "1", ",", 
           "1"}], "]"}]}], ";", 
        RowBox[{"xLike", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Range", "[", 
                 RowBox[{"#2", ",", "#3"}], "]"}], "]"}], ">", 
               RowBox[{"Length", "[", 
                RowBox[{"Range", "[", 
                 RowBox[{"#4", ",", 
                  RowBox[{"#1", "+", "nGuess"}]}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"#3", ",", "#4", ",", "#1", ",", "#2"}], "}"}], ",", 
              RowBox[{"{", "##1", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Flatten", "/@", 
              RowBox[{"Subsets", "[", 
               RowBox[{"consec", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"#1", "\[Intersection]", "#1"}], "]"}], "\[Equal]", 
               "4"}], "&"}]}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
        RowBox[{"exprn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "x", "}"}], "]"}], "\[Equal]", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#1", "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", "x", "}"}], "]"}]}]}]}], "]"}], "&"}], ")"}],
               "[", 
              RowBox[{"Select", "[", 
               RowBox[{"consec", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"{", "x", "}"}], "\[Intersection]", "#1"}], "]"}],
                   "\[Equal]", "2"}], "&"}], ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#1", "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xLikeLines", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"consec", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"#1", "\[Intersection]", 
                    RowBox[{"{", "x", "}"}]}], "]"}], "\[Equal]", "2"}], 
                    "&"}]}], "]"}]}], ",", "boundaries"}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "xLikeLines", "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", "x", "}"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"boundaries", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"{", "x", "}"}], ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "nGuess", ",", 
                    "0"}], "]"}], "+", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "nGuess", 
                    ",", "0"}], "]"}], "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ">", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "nGuess", ",", 
                    "0"}], "]"}], "+", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "nGuess", 
                    ",", "0"}], "]"}], "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"boundaries", "=", 
                    RowBox[{"Reverse", "[", "boundaries", "]"}]}], ";"}]}], 
                    "]"}], ";", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Signature", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"boundaries", ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], " ", 
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"RotateLeft", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"boundaries", ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "[", 
              RowBox[{"Select", "[", 
               RowBox[{"xLike", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"#1", "\[Intersection]", 
                    RowBox[{"{", "x", "}"}]}], "]"}], "\[Equal]", "4"}], 
                 "&"}]}], "]"}], "]"}]}], "]"}]}], "}"}]}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"twistorSchouten", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a___", ",", "x_", ",", "b___", ",", "y_", ",", "c___"}], 
           "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"d___", ",", "x_", ",", "e___", ",", "y_", ",", "f___"}], 
           "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "x", ",", "b", ",", "y", ",", "c"}], "}"}], 
           "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"d", ",", "x", ",", "e", ",", "y", ",", "f"}], "}"}], 
           "]"}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}]}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a___", ",", "x_", ",", "b___", ",", "y_", ",", "c___"}], 
           "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"d___", ",", "y_", ",", "e___", ",", "x_", ",", "f___"}], 
           "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "x", ",", "b", ",", "y", ",", "c"}], "}"}], 
           "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"d", ",", "y", ",", "e", ",", "x", ",", "f"}], "}"}], 
           "]"}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}]}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}]}]}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "d_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "c_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "d_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ab", "[", 
            RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}]}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "c_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ab", "[", 
            RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}]}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "d_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}]}], "}"}]}], 
    "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"twistorSimplify", "[", 
    RowBox[{"exprn_", ",", 
     RowBox[{"orderQ_:", "0"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"exprn", ",", 
        RowBox[{"ab", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ",", "\[Infinity]"}], "]"}], ">", 
      "0"}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"order", "[", "exprn", "]"}], "/.", 
       RowBox[{"Apply", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", 
              RowBox[{"twistorSchouten", "[", "#1", "]"}]}], "}"}], "&"}], 
           ")"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"exprn", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ab", "[", "x__", "]"}], " ", 
               RowBox[{"ab", "[", "y__", "]"}]}], "-", 
              RowBox[{
               RowBox[{"ab", "[", "z__", "]"}], " ", 
               RowBox[{"ab", "[", "w__", "]"}]}]}], "|", 
             RowBox[{
              RowBox[{
               RowBox[{"ab", "[", "x__", "]"}], " ", 
               RowBox[{"ab", "[", "y__", "]"}]}], "+", 
              RowBox[{
               RowBox[{"ab", "[", "z__", "]"}], " ", 
               RowBox[{"ab", "[", "w__", "]"}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"order", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"orderQ", "\[Equal]", "1"}], ",", 
           RowBox[{"order", "[", 
            RowBox[{
             RowBox[{"FullSimplify", "[", 
              RowBox[{
               RowBox[{"order", "[", 
                RowBox[{"exprn", ",", "0"}], "]"}], ",", 
               RowBox[{"TransformationFunctions", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "twistorSchouten"}], "}"}]}]}], 
              "]"}], ",", "1"}], "]"}], ",", "exprn"}], "]"}], ",", 
         RowBox[{"TransformationFunctions", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "twistorSchouten"}], "}"}]}]}], "]"}], 
       ",", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"toqlog", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "n", ",", 
       RowBox[{"n", "+", "1"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "===", "1"}], "&&", 
        RowBox[{"k", "===", 
         RowBox[{"n", "-", "1"}]}]}], ",", 
       RowBox[{
        RowBox[{"dlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", 
            RowBox[{"n", "-", "2"}], ",", 
            RowBox[{"n", "-", "1"}]}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", "1", ",", "2"}], "]"}]], "]"}], 
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "2"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}]], 
         "]"}]}], ",", 
       RowBox[{"k", "===", 
        RowBox[{"n", "-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"dlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", "i", ",", "j"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", 
            RowBox[{"n", "-", "2"}], ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]], "]"}], 
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "i"}], "]"}]], 
         "]"}]}], ",", 
       RowBox[{"i", "===", "1"}], ",", 
       RowBox[{
        RowBox[{"dlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", "j", ",", "k"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"X", ",", "1", ",", "2"}], "]"}]], "]"}], 
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}]], 
         "]"}]}], ",", "True", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"dlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"X", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"X", ",", "j", ",", "k"}], "]"}]], "]"}], 
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "i"}], "]"}]], 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{"dlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"X", ",", "j", ",", "k"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"X", ",", "i", ",", "k"}], "]"}]], "]"}], 
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "i"}], "]"}]], 
          "]"}]}]}]}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dab", "[", 
    RowBox[{"___", ",", "i_", ",", "___", ",", "i_", ",", "___"}], "]"}], ":=",
    "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sortdab", "=", 
   RowBox[{"{", 
    RowBox[{"i_dab", "\[RuleDelayed]", 
     FractionBox[
      RowBox[{
       RowBox[{"Sort", "[", "i", "]"}], " ", 
       RowBox[{"Signature", "[", "i", "]"}]}], 
      RowBox[{"Signature", "[", 
       RowBox[{"Sort", "[", "i", "]"}], "]"}]]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dabRcanel", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Expand", "[", "exp", "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", "x__", "]"}], 
      RowBox[{"dab", "[", "y__", "]"}]}], "\[RuleDelayed]", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", "x", "}"}], "]"}], "\[Equal]", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", "y", "}"}], "]"}]}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"qlogRcanel", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Expand", "[", "exp", "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", "x__", "]"}], 
      RowBox[{"Qlog", "[", 
       FractionBox[
        RowBox[{"ab", "[", "z__", "]"}], 
        RowBox[{"ab", "[", "y__", "]"}]], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", "x", "}"}], "]"}], "\[Equal]", 
       RowBox[{"Sort", "[", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "]"}], "]"}]}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"qlogtodab", "=", 
   RowBox[{
    RowBox[{"Qlog", "[", 
     FractionBox[
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "i_", ",", 
        RowBox[{"n", "-", "1"}], ",", "n"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "j_", ",", 
        RowBox[{"n", "-", "1"}], ",", "n"}], "]"}]], "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{"dab", "[", 
      RowBox[{"1", ",", "i", ",", "j", ",", 
       RowBox[{"n", "-", "1"}], ",", "n"}], "]"}], 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "i", ",", 
        RowBox[{"n", "-", "1"}], ",", "n"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "j", ",", 
        RowBox[{"n", "-", "1"}], ",", "n"}], "]"}]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Rtodab", "=", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "n", ",", 
      RowBox[{"n", "+", "1"}]}], "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"dab", "[", 
       RowBox[{"i", ",", "j", ",", "k", ",", "n", ",", "B"}], "]"}], " ", 
      RowBox[{"ab", "[", 
       RowBox[{"i", ",", "j", ",", "k", ",", "n"}], "]"}]}], 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"i", ",", "j", ",", "n", ",", "B"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"j", ",", "k", ",", "n", ",", "B"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"k", ",", "i", ",", "n", ",", "B"}], "]"}]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dabBexp", "=", 
   RowBox[{
    RowBox[{"dab", "[", 
     RowBox[{"x___", ",", "B", ",", "y___"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dab", "[", 
      RowBox[{"x", ",", 
       RowBox[{"n", "-", "1"}], ",", "y"}], "]"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "n", ",", "2", ",", "3"}], "]"}], 
       RowBox[{"ab", "[", 
        RowBox[{"n", ",", "1", ",", "2", ",", "3"}], "]"}]], " ", "\[Tau]", 
      " ", 
      RowBox[{"dab", "[", 
       RowBox[{"x", ",", "1", ",", "y"}], "]"}]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}], ",", "n", ",", "1"}], "]"}], 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}], ",", "2", ",", "1"}], "]"}]], " ", "e", " ", 
      RowBox[{"dab", "[", 
       RowBox[{"x", ",", "2", ",", "y"}], "]"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dabtoqlog", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dab", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_", ",", "n"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "===", "1"}], "&&", 
        RowBox[{"l", "===", 
         RowBox[{"n", "-", "1"}]}]}], ",", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}]], 
         "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "j", ",", 
          RowBox[{"n", "-", "1"}], ",", "n"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "k", ",", 
          RowBox[{"n", "-", "1"}], ",", "n"}], "]"}]}], ",", 
       RowBox[{"l", "===", 
        RowBox[{"n", "-", "1"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "i"}], "]"}]], 
          "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "i"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "j", ",", "k"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}]], 
          "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "i", ",", "j"}], "]"}]}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"i", "===", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "l"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}]], 
          "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "k"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"n", ",", "1", ",", "l", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "l"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}]], 
          "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "j"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"n", ",", "1", ",", "k", ",", "l"}], "]"}]}]}], ",", "True",
        ",", 
       RowBox[{"dab", "[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "n"}], "]"}]}], 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dabcapexpand", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dab", "[", 
      RowBox[{"x___", ",", " ", 
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
         RowBox[{"{", "c__", "}"}]}], "]"}], ",", " ", "y___"}], "]"}], " ", ":>",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"b", ",", " ", "c"}], "]"}], " ", 
       RowBox[{"dab", "[", 
        RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", " ", "a"}], "]"}], " ", 
       RowBox[{"dab", "[", 
        RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"dabshifexp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dab", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"shift", "[", 
        RowBox[{"y_", ",", "z_"}], "]"}], ",", "w___"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"dab", "[", 
       RowBox[{"x", ",", 
        RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "w"}], "]"}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"dab", "[", 
        RowBox[{"x", ",", 
         RowBox[{"y", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "w"}], "]"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullabB", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"exp", "//.", "shifexp"}], "//.", "capexpand"}], "/.", 
      "abelim"}], "/.", "abtre"}], "/.", "sortab"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"reduceR", " ", "series"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ab", "[", 
     RowBox[{"___", ",", "j_", ",", "___", ",", "j_", ",", "___"}], "]"}], ":=",
     "0"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ordercup", "[", "exp_", "]"}], ":=", 
    RowBox[{"SortBy", "[", 
     RowBox[{"exp", ",", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], ",", "1.5", ",", 
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "shift"}], ",", "1.4", ",", 
         "True", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"sortR", "=", 
   RowBox[{"{", 
    RowBox[{"i_R", ":>", 
     RowBox[{
      RowBox[{"ordercup", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], "/", 
       RowBox[{"Signature", "[", 
        RowBox[{"ordercup", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"reduceR1", "[", 
    RowBox[{"Rinv1_", ",", "Rinv2_"}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"Rinv1", ",", "\n", "_Plus", ",", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"reduceR1", "[", 
          RowBox[{"#1", ",", "Rinv2"}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"List", "@@", "Rinv1"}]}], "]"}], ",", "\n", "_Times", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Rinv1", " ", 
           RowBox[{"reduceR1", "[", 
            RowBox[{"#1", ",", "Rinv2"}], "]"}]}], ")"}], "/", "#1"}], "&"}], 
       ")"}], "[", 
      RowBox[{"FirstCase", "[", 
       RowBox[{"Rinv1", ",", "_R"}], "]"}], "]"}], ",", "\n", "_R", ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"plist1", "=", 
          RowBox[{"List", "@@", "Rinv1"}]}], ",", 
         RowBox[{"plist2", "=", 
          RowBox[{"List", "@@", "Rinv2"}]}]}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"foo", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"plist1", "\[Intersection]", "plist2"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"plist1", ",", "foo"}], "]"}]}], ",", 
             RowBox[{"j", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"plist2", ",", "foo"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"SubsetQ", "[", 
               RowBox[{"foo", ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ",", "Rinv1", 
             ",", 
             RowBox[{
              RowBox[{"Length", "[", "foo", "]"}], "===", "4"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Signature", "[", "plist1", "]"}], 
                RowBox[{"Signature", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], "  ", 
                RowBox[{
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"R", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "foo", "]"}], "===", "3"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Signature", "[", "plist1", "]"}], "  ", 
                RowBox[{"Signature", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"i", ",", "foo"}], "]"}]}], "]"}], " ", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "i"}], 
                    "]"}]}], " ", 
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{"i", ",", "foo"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}], " ", 
                RowBox[{"R", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"cap", "[", 
                   RowBox[{"i", ",", "foo"}], "]"}]}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "@@", 
                 RowBox[{"Join", "[", 
                  RowBox[{"foo", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                RowBox[{"ab", "@@", 
                 RowBox[{"Join", "[", 
                  RowBox[{"foo", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"foo", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "foo", "]"}], "===", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Signature", "[", "plist1", "]"}], " ", 
                RowBox[{"Signature", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"i", ",", "foo"}], "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "n", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], " ", 
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"foo", ",", "i"}], "]"}]}], "]"}], " ", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], " ", 
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "n", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "n"}], "]"}], "/.", 
                  " ", 
                  RowBox[{
                   RowBox[{"cap", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
                   RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"Sort", "[", "x", "]"}], ",", 
                    RowBox[{"Sort", "[", "y", "]"}]}], "]"}]}]}], ")"}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ")"}], "^", "2"}], 
                " ", 
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"i", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", "n", ",", 
                  RowBox[{"n", "+", "1"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "[", 
                 RowBox[{"n", ",", 
                  RowBox[{"n", "+", "1"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"i", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
                RowBox[{"ab", "@@", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}], ",", "i"}], "]"}]}]}], 
               ")"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "\n", "_", 
     ",", "Rinv1"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"prefreduceR", "[", "Rinv_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ppp", " ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"StringCount", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], ",", "\"\<cap\>\""}], 
              "]"}], "&"}]}], "]"}], "&"}], "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"List", "@@", "Rinv"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], ")"}], "&&", 
             RowBox[{"IntersectingQ", "[", 
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"List", "@@", "#"}], "]"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"List", "@@", "Rinv"}], ",", 
                 RowBox[{"{", "#", "}"}]}], "]"}]}], "]"}]}], "&"}]}], 
          "]"}]}]}], "}"}], ",", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "ppp"}], "==", "0"}], ",", "Rinv", ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pp", "=", 
            RowBox[{"First", "@", "ppp"}]}], "}"}], ",", "\n", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qq", "=", " ", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"List", "@@", "Rinv"}], ",", "pp"}], "]"}]}], "}"}], 
            ",", "\n", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"bbbb1", "=", 
                 RowBox[{"First", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", "qq"}], "]"}], "]"}]}],
                 ",", 
                RowBox[{"bbbb2", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", "qq"}], "]"}]}], 
                   "]"}]}]}]}], "}"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb1", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "Rinv"}], ",", 
                    RowBox[{"pp", "|", "bbbb1"}]}], "]"}]}], "]"}], ")"}]}], 
                    ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb2", "}"}], ",", 
                    RowBox[{"Last", "@", "pp"}]}], "]"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "pp"}], ",", 
                    RowBox[{"{", "bbbb1", "}"}]}], "]"}], ")"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb2", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "Rinv"}], ",", 
                    RowBox[{"pp", "|", "bbbb1"}]}], "]"}]}], "]"}], ")"}]}], 
                    ")"}]}], ")"}]}]}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}]}], " ", "Rinv"}], "/.", 
               RowBox[{"pp", "->", "bbbb2"}]}]}], "]"}]}], "\n", "]"}]}], 
         "]"}]}], "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"freduceR", "[", "$Rinv_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Rinv", "=", 
       RowBox[{"Expand", "[", "$Rinv", "]"}]}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{"Rinv", ",", "\n", "\t", "_Plus", ",", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"freduceR", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"List", " ", "@@", " ", "Rinv"}], ")"}]}], "]"}], ",", "\n",
        "\t", "_Times", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rinv", "/", "#"}], " ", 
           RowBox[{"freduceR", "[", "#", "]"}]}], ")"}], " ", "&"}], "[", 
        RowBox[{"FirstCase", "[", 
         RowBox[{"Rinv", ",", " ", "_R"}], "]"}], "]"}], ",", "\n", "\t", 
       "_R", ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"Rinv", "===", 
           RowBox[{"prefreduceR", "[", "Rinv", "]"}]}]}], ",", 
         RowBox[{"freduceR", "[", 
          RowBox[{"prefreduceR", "[", "Rinv", "]"}], "]"}], ",", "\n", "\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"cc", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"Rinv", ",", "_cap", ",", "1"}], "]"}]}], ",", 
             RowBox[{"pp", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"Rinv", ",", 
                RowBox[{"Except", "[", "_cap", "]"}], ",", "1"}], "]"}]}]}], 
            "}"}], ",", "\n", 
           RowBox[{"If", "[", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "cc", "]"}], ">=", "1"}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"plist", "=", 
                  RowBox[{"List", "@@", "Rinv"}]}], ",", 
                 RowBox[{"c", "=", 
                  RowBox[{"First", "[", "cc", "]"}]}]}], "}"}], ",", "\n", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"foo", "=", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"First", "[", "c", "]"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pl", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "c", "]"}], ",", "foo"}], "]"}], 
                    "]"}]}], "}"}], ",", "\n", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{
                    RowBox[{"Length", "[", "foo", "]"}], "==", "1"}]}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"prefreduceR", "/@", 
                    RowBox[{"(", 
                    RowBox[{"R", "@@@", 
                    RowBox[{"RotateLeft", "[", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"plist", ",", 
                    RowBox[{"{", "pl", "}"}]}], "]"}], ",", "5", ",", "1", 
                    ",", "1"}], "]"}], "]"}]}], ")"}]}], ")"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], ")"}], 
                    ",", "Rinv"}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
             "\n", "Rinv"}], "\n", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"redR", "[", "exp_", "]"}], ":=", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{"i_R", "\[RuleDelayed]", 
         RowBox[{"prefreduceR", "[", "i", "]"}]}]}], "&"}], ",", "exp"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fuse", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", "#", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"doubleab", "[", "i_", "]"}], " ", 
        RowBox[{"Dmatrix", "[", "j_", "]"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"doubleab", "@", 
         RowBox[{"Join", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], " ", 
        RowBox[{"Dmatrix", "[", "j", "]"}]}]}], "}"}]}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DmatrixEval3", "[", 
   RowBox[{"a_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fermions", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "a", "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Dmatrix", "[", 
        RowBox[{"i_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "\[Equal]", 
          RowBox[{"Length", "[", 
           RowBox[{"fermions", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "[", 
              RowBox[{"[", 
               RowBox[{"#1", ",", 
                RowBox[{"fermions", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "#2"}], "]"}], "]"}]}], "]"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "[", "i", "]"}], ",", 
              RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "k"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Dmatrix", "[", "i_", "]"}], "\[RuleDelayed]", "0"}]}], 
     "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dabne", "[", "fermions__", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"doubleab", "[", 
       RowBox[{"i_", "/;", 
        RowBox[{
         RowBox[{"Length", "[", "i", "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"{", "fermions", "}"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", 
              RowBox[{"#1", ",", 
               RowBox[{
                RowBox[{"{", "fermions", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "#2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "i", "]"}], ",", 
             RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"doubleab", "[", "i_", "]"}], "\[RuleDelayed]", "0"}]}], 
    "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortall", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sortR", ",", "sortab", ",", "sortdab", ",", 
     RowBox[{"{", "sortcapinR", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"todoubleab", ":=", 
  RowBox[{
   RowBox[{"FuseDmatrices", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "/.", "\[VeryThinSpace]", 
       RowBox[{"i_dab", "\[RuleDelayed]", " ", 
        RowBox[{"doubleab", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fromRform", "[", "n", "]"}], "[", 
           RowBox[{"R", "@@", "i"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}]}], "//.",
       "\[VeryThinSpace]", "shifexp"}], "//.", "\[VeryThinSpace]", 
     "capexpand"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandlog", "[", "exp_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", 
     RowBox[{
      RowBox[{"exp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"log", "[", "a_", "]"}], ":>", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"log", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}], "/@", " ", 
           RowBox[{"FactorList", "[", "a", "]"}]}], "]"}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"log", "[", 
         RowBox[{"a_", "^", "x_"}], "]"}], ":>", 
        RowBox[{"x", " ", 
         RowBox[{"log", "[", "a", "]"}]}]}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766725156612133*^9, 3.7667251920570707`*^9}, {
  3.7667252584967785`*^9, 3.7667252592622967`*^9}, {3.766725312438665*^9, 
  3.7667254491018367`*^9}, {3.7667254865604415`*^9, 3.7667255080781174`*^9}, {
  3.7667255489319024`*^9, 3.7667257044423504`*^9}, {3.766725762708913*^9, 
  3.76672577635964*^9}, {3.766982286608833*^9, 3.7669822868095045`*^9}, {
  3.7670752597166977`*^9, 3.7670752600295687`*^9}, {3.767844943466468*^9, 
  3.767844970606693*^9}, {3.7678451726960235`*^9, 3.7678452083573303`*^9}, {
  3.767848424709075*^9, 3.767848453904866*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"1eb69f41-f261-4b3f-bc73-68e8910216c5"],

Cell[BoxData[
 PanelBox[
  TagBox[GridBox[{
     {
      PanelBox[
       GraphicsBox[
        {RGBColor[
          NCache[
           Rational[8, 9], 0.8888888888888888], 
          NCache[
           Rational[8, 9], 0.8888888888888888], 
          NCache[
           Rational[43, 45], 0.9555555555555556]], EdgeForm[{GrayLevel[0], 
         Opacity[0], AbsoluteThickness[3]}], 
         CircleBox[{0, 0}, 4.164213562373095], 
         {GrayLevel[1], 
          DiskBox[{0, 0}, NCache[
           Rational[5, 3] + 2^Rational[1, 2], 3.080880229039762]]}, 
         {GrayLevel[0], AbsoluteThickness[4], 
          LineBox[{{-1, -1}, {-1, 1}, {1, 1}, {1, -1}, {-1, -1}}], 
          LineBox[NCache[{{1, 1}, {
             Rational[1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 3^Rational[1, 2]),
               Rational[1, 12] (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[1, 2])}}, {{1, 1}, {0.7973904789553065, 
             2.975901780932886}}]], 
          LineBox[NCache[{{1, 1}, {
             Rational[1, 12] (6 + 5 2^Rational[1, 2]) (1 + 3^Rational[1, 2]), 
              Rational[1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2])}}, {{1, 1}, {2.975901780932886, 
             0.7973904789553065}}]], 
          LineBox[NCache[{{1, -1}, {
             Rational[1, 12] (6 + 5 2^Rational[1, 2]) (1 + 3^Rational[1, 2]), 
              Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2])}}, {{1, -1}, {
             2.975901780932886, -0.7973904789553065}}]], 
          LineBox[NCache[{{1, -1}, {
             Rational[1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 3^Rational[1, 2]),
               Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[1, 2])}}, {{1, -1}, {
             0.7973904789553065, -2.975901780932886}}]], 
          LineBox[NCache[{{-1, -1}, {
             Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2]), 
              Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[
                 1, 2])}}, {{-1, -1}, {-0.7973904789553065, \
-2.975901780932886}}]], 
          LineBox[NCache[{{-1, -1}, {
             Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (1 + 3^Rational[1, 2]),
               Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[
                 1, 2])}}, {{-1, -1}, {-2.975901780932886, \
-0.7973904789553065}}]], 
          LineBox[NCache[{{-1, 1}, {
             Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (1 + 3^Rational[1, 2]),
               Rational[1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2])}}, {{-1, 1}, {-2.975901780932886, 
             0.7973904789553065}}]], 
          LineBox[NCache[{{-1, 1}, {
             Rational[-1, 12] (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2]), 
              Rational[1, 12] (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[1, 2])}}, {{-1, 1}, {-0.7973904789553065, 
             2.975901780932886}}]], 
          {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[1], 
           AbsoluteThickness[
           3]}], {DiskBox[{1.295565513555934, 2.103065513555934}, 0.075], 
            DiskBox[{1.8075, 1.8075}, 0.075], 
            DiskBox[{2.103065513555934, 1.295565513555934}, 0.075]}, {
            DiskBox[{2.103065513555934, -1.295565513555934}, 0.075], 
            DiskBox[{1.8075, -1.8075}, 0.075], 
            DiskBox[{1.295565513555934, -2.103065513555934}, 0.075]}, {
            DiskBox[{-1.295565513555934, -2.103065513555934}, 0.075], 
            DiskBox[{-1.8075, -1.8075}, 0.075], 
            DiskBox[{-2.103065513555934, -1.295565513555934}, 0.075]}, {
            DiskBox[{-2.103065513555934, 1.295565513555934}, 0.075], 
            DiskBox[{-1.8075, 1.8075}, 0.075], 
            DiskBox[{-1.295565513555934, 2.103065513555934}, 0.075]}, InsetBox[
            StyleBox["a",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {0.8611817172717309, 3.2139739234075164}, 
            NCache[{Rational[-1, 12] (Rational[5, 3] + 
                2^Rational[1, 2])^(-1) (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[
                 1, 2]), -0.7159258262890681}, {-0.2588190451025207, \
-0.7159258262890681}]], InsetBox[
            StyleBox["B",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {3.2139739234075164, 0.8611817172717309}, 
            NCache[{Rational[-1, 12] (Rational[5, 3] + 
                2^Rational[1, 2])^(-1) (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[
                 1, 2]), -0.008819045102520684}, {-0.9659258262890681, \
-0.008819045102520684}]], InsetBox[
            StyleBox["b",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {3.2139739234075164, -0.8611817172717309}, 
            NCache[{Rational[-1, 12] (Rational[5, 3] + 
                2^Rational[1, 2])^(-1) (6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[1, 2]), 0.5088190451025207}, {-0.9659258262890681, 
             0.5088190451025207}]], InsetBox[
            StyleBox["C",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {0.8611817172717309, -3.2139739234075164}, 
            NCache[{Rational[-1, 12] (Rational[5, 3] + 
                2^Rational[1, 2])^(-1) (6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2]), 1.2159258262890682`}, {-0.2588190451025207, 
             1.2159258262890682`}]], InsetBox[
            StyleBox["c",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {-0.8611817172717309, -3.2139739234075164}, 
            NCache[{Rational[1, 12] (Rational[5, 3] + 2^Rational[1, 2])^(-1) (
               6 + 5 2^Rational[1, 2]) (-1 + 3^Rational[1, 2]), 
              1.2159258262890682`}, {0.2588190451025207, 
             1.2159258262890682`}]], InsetBox[
            StyleBox["D",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {-3.2139739234075164, -0.8611817172717309}, 
            NCache[{Rational[1, 12] (Rational[5, 3] + 2^Rational[1, 2])^(-1) (
               6 + 5 2^Rational[1, 2]) (1 + 3^Rational[1, 2]), 
              0.5088190451025207}, {0.9659258262890681, 0.5088190451025207}]],
            InsetBox[
            StyleBox["d",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {-3.2139739234075164, 0.8611817172717309}, 
            NCache[{Rational[1, 12] (Rational[5, 3] + 2^Rational[1, 2])^(-1) (
               6 + 5 2^Rational[1, 2]) (1 + 
               3^Rational[1, 2]), -0.008819045102520684}, {
             0.9659258262890681, -0.008819045102520684}]], InsetBox[
            StyleBox["A",
             StripOnInput->False,
             FontFamily->"Times",
             FontSize->26], {-0.8611817172717309, 3.2139739234075164}, 
            NCache[{Rational[1, 12] (Rational[5, 3] + 2^Rational[1, 2])^(-1) (
               6 + 5 2^Rational[1, 2]) (-1 + 
               3^Rational[1, 2]), -0.7159258262890681}, {
             0.2588190451025207, -0.7159258262890681}]], 
           {GrayLevel[0.825], EdgeForm[{GrayLevel[0], Opacity[1], 
            AbsoluteThickness[4]}], DiskBox[{1, 1}, 0.65], 
            {GrayLevel[0]}}, 
           {GrayLevel[0.825], EdgeForm[{GrayLevel[0], Opacity[1], 
            AbsoluteThickness[4]}], DiskBox[{1, -1}, 0.65], 
            {GrayLevel[0]}}, 
           {GrayLevel[0.8525], EdgeForm[{GrayLevel[0], Opacity[1], 
            AbsoluteThickness[4]}], DiskBox[{-1, -1}, 0.65], 
            {GrayLevel[0]}}, 
           {GrayLevel[0.825], EdgeForm[{GrayLevel[0], Opacity[1], 
            AbsoluteThickness[4]}], DiskBox[{-1, 1}, 0.65], 
            {GrayLevel[0]}}, 
           {GrayLevel[0], AbsoluteThickness[5], 
            CircleBox[{0, 0}, NCache[
             Rational[5, 3] + 2^Rational[1, 2], 3.080880229039762]], 
            {GrayLevel[0]}}}}},
        Background->RGBColor[
          Rational[8, 9], 
          Rational[8, 9], 
          Rational[43, 45]],
        ImageSize->250],
       Background->RGBColor[
         Rational[235, 243], 
         Rational[235, 243], 
         Rational[1199, 1215]],
       FrameMargins->6]},
     {
      TemplateBox[{
       StyleBox[
        "\"One-Loop Amplitude Integrands\"", FontFamily -> "Times", FontSize -> 
         18, StripOnInput -> False]},
       "RowDefault"]},
     {
      TemplateBox[{
       StyleBox[
        "\"and Integrals in \"", FontFamily -> "Times", FontSize -> 18, 
         StripOnInput -> False],StyleBox[
        "\"N\"", FontFamily -> "Mathematica5", FontSize -> 18, StripOnInput -> 
         False],StyleBox[
        "\"=4 SYM\"", FontFamily -> "Times", FontSize -> 18, StripOnInput -> 
         False]},
       "RowDefault"]},
     {
      TemplateBox[{
       StyleBox[
        "\"Jacob L. Bourjaily, 2013\"", FontFamily -> "Times", FontSize -> 14,
          StripOnInput -> False]},
       "RowDefault"]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  Background->RGBColor[
    Rational[3, 4], 
    Rational[3, 4], 
    Rational[9, 10]],
  FrameMargins->{{15, 15}, {0, 12.5}}]], "Print",
 CellChangeTimes->{{3.7668876257226863`*^9, 3.7668876284586773`*^9}, 
   3.7669783557631984`*^9, 3.7669822983553267`*^9, {3.767063590170338*^9, 
   3.767063592827039*^9}, 3.767063906993066*^9, {3.767072377237424*^9, 
   3.767072379447626*^9}, 3.7673158223325615`*^9, {3.7674427385379095`*^9, 
   3.767442740067045*^9}, {3.7674955890529146`*^9, 3.767495590997735*^9}, {
   3.767495657155464*^9, 3.767495660442734*^9}, {3.767844957129815*^9, 
   3.7678449714189944`*^9}, 3.76784521030389*^9, 3.76784702820531*^9, 
   3.767848454810916*^9, {3.7680211648443365`*^9, 3.7680211662270184`*^9}, {
   3.768368235699318*^9, 3.768368237025213*^9}, {3.7683682672707086`*^9, 
   3.7683682688058386`*^9}, {3.769135225409283*^9, 3.769135227113727*^9}, 
   3.7691353067222605`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[119]:=",ExpressionUUID->"287eaf14-3d4b-4805-\
ad48-1fff1686a70e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "8"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"source", "=", 
   RowBox[{"analyticIntegral", "[", 
    RowBox[{
     RowBox[{"scalarBoxExpansion", "[", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], ",", "False"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"c1lvan", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"source", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2", ",", "1", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "===", "0"}], ",", "i"}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "source"}]}], "}"}]}], "]"}], "//", 
    "Union"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c2lvan", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"source", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2", ",", "2", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "===", "0"}], ",", "i"}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "source"}]}], "}"}]}], "]"}], "//", 
    "Union"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c1landc2lvan", "=", 
   RowBox[{"Intersection", "[", 
    RowBox[{"c1lvan", ",", "c2lvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c1nvan", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"source", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2", ",", "1", ",", "n"}], "]"}], "]"}], "===", 
         "0"}], ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "source"}]}], "}"}]}], "]"}], "//", 
    "Union"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c2nvan", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"source", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2", ",", "2", ",", "n"}], "]"}], "]"}], "===", 
         "0"}], ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "source"}]}], "}"}]}], "]"}], "//", 
    "Union"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c1nandc2nvan", "=", 
   RowBox[{"Intersection", "[", 
    RowBox[{"c1nvan", ",", "c2nvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eitherlnonvan", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"c1lvan", ",", "c2lvan"}], "]"}], ",", "Null"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"eithernnonvan", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"c1nvan", ",", "c2nvan"}], "]"}], ",", "Null"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bothnvan", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Intersection", "[", 
      RowBox[{"c1nvan", ",", "c2nvan"}], "]"}], ",", "Null"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bothlnonvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "source", "]"}], "]"}], ",", "eitherlnonvan"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bothnnonvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "source", "]"}], "]"}], ",", "eithernnonvan"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bothnlnonvan", "=", 
   RowBox[{"Intersection", "[", 
    RowBox[{"bothnnonvan", ",", "bothlnonvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"onlyc1lvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"c1lvan", ",", "c1landc2lvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"onlyc2lvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"c2lvan", ",", "c1landc2lvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"onlyc1nvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"c1nvan", ",", "c1nandc2nvan"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"onlyc2nvan", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"c2nvan", ",", "c1nandc2nvan"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7667259259423065`*^9, 3.7667259284953966`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"7d83c21e-99eb-4f02-a0db-54ee4c61b216"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "data1", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rformoc1lvan", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"#1", ",", "_R", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
          RowBox[{"#1", "/.", 
           RowBox[{
            RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
         "}"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rForm", "[", 
         RowBox[{"scalarBoxExpansion", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Complement", "[", 
            RowBox[{"onlyc1lvan", ",", "onlyc2nvan"}], "]"}], ",", 
           "c1nandc2nvan"}], "]"}], "]"}], "]"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rformoc2lvan", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"#1", ",", "_R", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
          RowBox[{"#1", "/.", 
           RowBox[{
            RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
         "}"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rForm", "[", 
         RowBox[{"scalarBoxExpansion", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Complement", "[", 
            RowBox[{"onlyc2lvan", ",", "onlyc1nvan"}], "]"}], ",", 
           "c1nandc2nvan"}], "]"}], "]"}], "]"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"data1", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"rformoc1lvan", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "rformoc2lvan"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data11", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"redR", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"redR", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "sortall"}], "/.", 
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"n", "-", "1"}], ",", "n", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], ":>", "0"}]}], ",", 
             RowBox[{"First", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"analyticIntegral", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "False"}], "]"}]}]}]}],
             "}"}], "&"}], "/@", "data1"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", 
            RowBox[{"-", 
             RowBox[{"Li", "[", "1", "]"}]}]}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"_", ",", "0", ",", "_"}], "}"}]}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], ",", "\"\<Sqrt\>\""}], 
          "]"}]}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data12", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Limit", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"freduceR", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "fullabB"}], ",", 
            RowBox[{"e", "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Limit", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"freduceR", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", "fullabB"}], 
                    ")"}], "/.", "sortall"}], "/.", "Rtodab"}], "/.", 
                  "dabBexp"}], ")"}], "//", "fullabB"}], ")"}], "/.", 
              RowBox[{"_R", ":>", "0"}]}], ",", 
             RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data11"}], 
      ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7667259858595023`*^9, 3.7667259858639216`*^9}, {
  3.7667274051596704`*^9, 3.766727429671007*^9}, {3.7667282004839506`*^9, 
  3.766728218372013*^9}, {3.767067740956972*^9, 3.76706775124192*^9}, {
  3.7673159155904756`*^9, 3.767315917226396*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"a1377f54-a0ae-4592-a14d-97dc9cbdf068"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data12", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"data12", ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "0", ",", "_"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data13", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "//", "dabRcanel"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Li", "[", "1", "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"Li", "[", "1", "]"}], "/", "2"}]}]}], ")"}], "//", 
             "fullabB"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{"e", " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}], ",", 
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{
               RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Li", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}]}]}], "}"}], "&"}], "/@",
     "data12"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7673158401944942`*^9, 3.767315891204522*^9}, {
  3.767315934896397*^9, 3.767315935171962*^9}, {3.767316060520975*^9, 
  3.7673160892539234`*^9}, {3.7673163534365997`*^9, 3.767316372275384*^9}, {
  3.767317060609254*^9, 3.767317062749135*^9}, {3.7673185047880745`*^9, 
  3.7673185546613884`*^9}, {3.7673185909702363`*^9, 3.767318779268235*^9}, {
  3.767318829824215*^9, 3.7673188440481653`*^9}, {3.7673189207833543`*^9, 
  3.7673189574184093`*^9}, {3.767352414494072*^9, 3.767352426443262*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"62742f98-fdb5-4681-89c6-98fb8c6798ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "data2", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"#1", ",", "_R", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
          RowBox[{"#1", "/.", 
           RowBox[{
            RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
         "}"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rForm", "[", 
         RowBox[{"scalarBoxExpansion", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], "]"}], "[", 
        RowBox[{"[", "bothnlnonvan", "]"}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data21", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"redR", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "sortall"}], "/.", 
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"n", "-", "1"}], ",", "n", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], ":>", "0"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"redR", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "sortall"}], "/.", 
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"n", "-", "1"}], ",", "n", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], ":>", "0"}]}], ",", 
             RowBox[{"First", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"analyticIntegral", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "False"}], "]"}]}]}]}],
             "}"}], "&"}], "/@", "data2"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", 
            RowBox[{"-", 
             RowBox[{"Li", "[", "1", "]"}]}]}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"_", ",", "0", ",", "_"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], ",", "\"\<Sqrt\>\""}], 
          "]"}]}], "&"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.766729769884041*^9, 3.7667298168978367`*^9}, {
  3.766729864063639*^9, 3.766729895293455*^9}, {3.7667299441013823`*^9, 
  3.766729997056176*^9}, {3.767067760075467*^9, 3.7670677606553025`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"64f84a89-9109-4fb4-afaf-6d7467ca0621"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"capnlreduce", "[", 
   RowBox[{"R1_", ",", "R2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"R1", ",", 
    RowBox[{"R2", "/.", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"cap", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", "c__", "}"}]}], "]"}], ",", "d___"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hh", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"n", "+", "1"}], ",", "c"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "d"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"jj", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"{", "c", "}"}], ",", "hh"}], "]"}]}], ",", 
            RowBox[{"kk", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "d"}], "}"}], ",", "hh"}], "]"}]}]}], "}"}],
           ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "hh", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"R", "[", 
             RowBox[{"a", ",", 
              RowBox[{"cap", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"n", "+", "1"}]}], "}"}], ",", 
                RowBox[{"{", "c", "}"}]}], "]"}], ",", "d"}], "]"}], ",", 
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Length", "[", "hh", "]"}], ",", "\[IndentingNewLine]", 
              "1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"{", "d", "}"}]}], "-", "1"}], ")"}]}], " ", 
               RowBox[{"R", "[", 
                RowBox[{"a", ",", "d", ",", 
                 RowBox[{"cap", "[", 
                  RowBox[{"jj", ",", 
                   RowBox[{"Join", "[", 
                    RowBox[{"hh", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
                "]"}], " ", 
               RowBox[{
                RowBox[{"ab", "@@", 
                 RowBox[{"(", 
                  RowBox[{"Join", "[", 
                   RowBox[{"kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"cap", "[", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{"hh", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], 
                    "}"}]}], "]"}], ")"}]}], "/", 
                RowBox[{"ab", "@@", 
                 RowBox[{"(", 
                  RowBox[{"Join", "[", 
                   RowBox[{"kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}], ",", 
                    RowBox[{"{", "c", "}"}]}], "]"}], "}"}]}], "]"}], 
                  ")"}]}]}]}], ",", "\[IndentingNewLine]", "2", ",", 
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"First", "[", "jj", "]"}], ",", "d"}], "]"}], " ", 
               RowBox[{"ab", "@@", 
                RowBox[{"(", 
                 RowBox[{"Join", "[", 
                  RowBox[{"jj", ",", "kk", ",", 
                   RowBox[{"{", 
                    RowBox[{"First", "@", "hh"}], "}"}]}], "]"}], ")"}]}], 
               " ", 
               RowBox[{"ab", "@@", 
                RowBox[{"(", 
                 RowBox[{"Join", "[", 
                  RowBox[{"jj", ",", "kk", ",", 
                   RowBox[{"{", 
                    RowBox[{"Last", "@", "hh"}], "}"}]}], "]"}], ")"}]}], " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ab", "@@", 
                   RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}], ",", "hh"}], "]"}], 
                    ")"}]}], ")"}], "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}], ",", "kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"First", "[", "hh", "]"}], "}"}]}], "]"}], 
                    ")"}]}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", "c"}], "}"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], ")"}]}]}], "-", 
                    RowBox[{
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "n", "}"}], ",", "kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"First", "[", "hh", "]"}], "}"}]}], "]"}], 
                    ")"}]}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", "c"}], "}"}], ",", "n"}], 
                    "]"}], ")"}]}]}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}], ",", "kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"Last", "[", "hh", "]"}], "}"}]}], "]"}], ")"}]}],
                     " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", "c"}], "}"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], ")"}]}]}], "-", 
                    RowBox[{
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "n", "}"}], ",", "kk", ",", 
                    RowBox[{"{", 
                    RowBox[{"Last", "[", "hh", "]"}], "}"}]}], "]"}], ")"}]}],
                     " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", "c"}], "}"}], ",", "n"}], 
                    "]"}], ")"}]}]}]}], ")"}]}], ")"}]}]}], ",", "True", ",", 
              RowBox[{"R", "[", 
               RowBox[{"a", ",", 
                RowBox[{"cap", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}], ",", 
                  RowBox[{"{", "c", "}"}]}], "]"}], ",", "d"}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incapreduce", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c_", ",", "d_"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"7", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "b_"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a_", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "a_", ",", 
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d_", ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c_", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "c_", ",", 
       "8"}], "]"}], ":>", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a", ",", "b", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"c", ",", "d", ",", "8", ",", "9"}], "]"}]}], ")"}], "2"], 
       " ", 
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", "7", ",", "8", ",", "9"}], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "c", ",", 
         "d", ",", "7", ",", "8"}], "]"}]}], 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"a", ",", "c", ",", "8", ",", "9"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"b", ",", "7", ",", "8", ",", "9"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", "d", ",", "7", ",", "8"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", "d", ",", "8", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "9"}], "}"}]}], "]"}]}], "]"}]}]]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data22", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Numerator", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"i_R", "\[RuleDelayed]", "1"}]}], ")"}]}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data21"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data23", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/.", 
        RowBox[{"i_R", ":>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"i", ",", 
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"8", ",", "9"}], "}"}], ",", 
               RowBox[{"{", "___", "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"redR", "[", 
             RowBox[{
              RowBox[{"reduceR1", "[", 
               RowBox[{"i", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/.", 
              "sortcapinR"}], "]"}], "/.", "incapreduce"}], ",", "i"}], 
          "]"}]}]}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data22"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data24", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"capnlreduce", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", 
                    "2", ",", "3", ",", "4"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", 
                    "2", ",", "3", ",", "4", ",", "5"}], "]"}], "-", 
                   RowBox[{"R", "[", 
                    RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "1"}], 
                    "]"}], "+", 
                   RowBox[{"R", "[", 
                    RowBox[{"3", ",", "4", ",", "5", ",", "1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}]}], 
                    "]"}], "-", 
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "5", ",", "1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", 
                   RowBox[{"R", "[", 
                    RowBox[{"5", ",", "1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", 
                    "2", ",", "3"}], "]"}]}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}], "&"}], "/@", 
          "data23"}], ")"}], "/.", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"___", ",", 
           RowBox[{"cap", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"7", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "___"}],
           "]"}], "\[RuleDelayed]", "0"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "0", ",", "_"}], "}"}]}], "]"}], "/.", "sortall"}], 
    "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "6", ",", 
         "7", ",", "8"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"freduceR", "[", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", 
          RowBox[{"cap", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "6", ",",
           "7", ",", "8"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "6", ",", 
         "7", ",", "8"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"freduceR", "[", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", 
          RowBox[{"cap", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "6", ",",
           "7", ",", "8"}], "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7668899400500765`*^9, 3.7668899454928474`*^9}, {
  3.766890681378989*^9, 3.7668907107298975`*^9}, {3.766890758137971*^9, 
  3.766890782430047*^9}, {3.76706769200673*^9, 3.7670676922722907`*^9}, {
  3.767067757340353*^9, 3.767067766540988*^9}, {3.7673314774481573`*^9, 
  3.7673314903739715`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"83c8cdcd-379f-4944-bc3f-06b8dddf62a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data25", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/.", "Rtodab"}], ")"}], 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "/.", "dabBexp"}], "//", 
             "dabRcanel"}], "//", "fullabB"}], ",", 
           RowBox[{"e", "\[Rule]", "0"}]}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data24"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "_"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data26", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "sortall"}], "/.", 
               RowBox[{
                RowBox[{"R", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"cap", "[", "a__", "]"}], ",", 
                  RowBox[{"cap", "[", 
                   RowBox[{"b_", ",", 
                    RowBox[{"{", 
                    RowBox[{"c_", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
                  "d___"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"freduceR", "[", 
                 RowBox[{"R", "[", 
                  RowBox[{
                   RowBox[{"cap", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
                   "1", ",", 
                   RowBox[{"cap", "[", "a", "]"}], ",", "d"}], "]"}], 
                 "]"}]}]}], "/.", "sortall"}], "/.", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"1", ",", 
                RowBox[{"cap", "[", 
                 RowBox[{"a_", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
                "b_", ",", "7", ",", "8"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"freduceR", "[", 
               RowBox[{"R", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"cap", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
                 "b", ",", "7", ",", "8"}], "]"}], "]"}]}]}], "/.", 
            "sortall"}], "/.", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"a___", ",", 
              RowBox[{"cap", "[", 
               RowBox[{"b_", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "8", ",", "9"}], "}"}], "|", 
                 RowBox[{"{", 
                  RowBox[{"7", ",", "8", ",", "9"}], "}"}]}]}], "]"}], ",", 
              "c___"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"R", "[", 
             RowBox[{"a", ",", 
              RowBox[{"cap", "[", 
               RowBox[{"b", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "7", ",", "8"}], "}"}]}], "]"}], ",", 
              "c"}], "]"}]}]}], "/.", 
          RowBox[{"(", 
           RowBox[{"9", "->", "B"}], ")"}]}], "/.", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"a___", ",", 
            RowBox[{"cap", "[", 
             RowBox[{"b_", ",", 
              RowBox[{"{", 
               RowBox[{"c__", ",", "B"}], "}"}]}], "]"}], ",", "d___"}], 
           "]"}], ":>", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "a", "}"}], "]"}], ")"}]}], 
           RowBox[{"freduceR", "[", 
            RowBox[{"R", "[", 
             RowBox[{
              RowBox[{"cap", "[", 
               RowBox[{"b", ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "B"}], "}"}]}], "]"}], ",", "a", ",", 
              "d"}], "]"}], "]"}]}]}]}], ")"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "data25"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.766889998128924*^9, 3.7668900023683386`*^9}, {
   3.7668900896850147`*^9, 3.7668901052292767`*^9}, {3.7668902446933994`*^9, 
   3.7668902665544586`*^9}, {3.7668903462494936`*^9, 3.766890404025639*^9}, {
   3.7668905161860266`*^9, 3.76689053723687*^9}, {3.766890859294871*^9, 
   3.7668909072503686`*^9}, {3.7668910215706625`*^9, 3.766891034793231*^9}, {
   3.7668925443125086`*^9, 3.766892547126397*^9}, {3.7669792494463787`*^9, 
   3.7669792899846883`*^9}, {3.766980298345436*^9, 3.766980337062839*^9}, {
   3.767067683962154*^9, 3.767067722098601*^9}, {3.7673216593637686`*^9, 
   3.7673216691329393`*^9}, {3.7673220648180094`*^9, 3.76732207080424*^9}, {
   3.767322105346551*^9, 3.767322145237892*^9}, 3.767323014245344*^9, {
   3.767332066069991*^9, 3.7673320681082444`*^9}, 3.767332269227389*^9, {
   3.767333049525217*^9, 3.767333243187722*^9}, {3.767334309481778*^9, 
   3.7673343128123827`*^9}, {3.7674974724844074`*^9, 3.7674975320892324`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"44111d37-6cae-4b45-888c-91fb498a0752"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"data27", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dabRcanel", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<B\>\""}], 
              "]"}], ",", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Simplify", "/@", 
                 RowBox[{"Limit", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"e", "\[Rule]", "0"}]}], "]"}]}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{"Collect", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "fullabB"}], ",", 
                    "_R"}], "]"}], ")"}]}], ")"}]}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ")"}], "&"}], "/@", 
       "data26"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data28", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], "//", "dabRcanel"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Li", "[", "1", "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"Li", "[", "1", "]"}], "/", "2"}]}]}], ")"}], "//", 
             "fullabB"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{"e", " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}], ",", 
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{
               RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Li", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}]}]}], "}"}], "&"}], "/@",
     "data27"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76732168878094*^9, 3.7673217841507025`*^9}, {
   3.767322025909557*^9, 3.767322032969042*^9}, {3.767322074798831*^9, 
   3.7673220962785707`*^9}, {3.7673222273024406`*^9, 
   3.7673222937275476`*^9}, {3.7673223692253695`*^9, 3.7673223733697853`*^9}, 
   3.767323022224222*^9, {3.7673303406138287`*^9, 3.7673303513240356`*^9}, {
   3.767333847013862*^9, 3.767333893582705*^9}, {3.767334155920311*^9, 
   3.7673342365773563`*^9}, 3.767334369183076*^9, {3.7673344004675455`*^9, 
   3.7673344122499123`*^9}, 3.767334607388509*^9, {3.7673347440613565`*^9, 
   3.76733475252981*^9}, {3.7673348192219543`*^9, 3.7673348947290945`*^9}, {
   3.767334950045119*^9, 3.7673349701559978`*^9}, {3.7673350104121957`*^9, 
   3.767335012943367*^9}, {3.767335042976268*^9, 3.7673350458380775`*^9}, {
   3.7673350805864134`*^9, 3.7673351148049526`*^9}, {3.767335469068558*^9, 
   3.7673354911489944`*^9}, {3.767351344939557*^9, 3.7673513468884697`*^9}, {
   3.767351398138476*^9, 3.7673513983584003`*^9}, {3.7673523577641163`*^9, 
   3.767352376613976*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"a6d313c0-0fc9-4230-ad91-affb4365d7ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15.2015469`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.7674428155688686`*^9, 3.7674957802010145`*^9, 
  3.7674975733874063`*^9, 3.7678470645244236`*^9, 3.768021223183575*^9, 
  3.7683683232391615`*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"98677dde-0a9e-4f4e-a294-a1e2628bf659"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "]"}], "-", 
      RowBox[{"R", "[", 
       RowBox[{"b", ",", "c", ",", "d", ",", "e", ",", "f"}], "]"}], "+", 
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "c", ",", "d", ",", "e", ",", "f"}], "]"}], "-", 
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "b", ",", "d", ",", "e", ",", "f"}], "]"}], "+", 
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "e", ",", "f"}], "]"}], "-", 
      RowBox[{"R", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "f"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", "4"}], ",", 
       RowBox[{"b", "\[Rule]", "5"}], ",", 
       RowBox[{"c", "\[Rule]", "3"}], ",", 
       RowBox[{"d", "\[Rule]", "6"}], ",", 
       RowBox[{"e", "\[Rule]", "7"}], ",", 
       RowBox[{"f", "\[Rule]", "8"}]}], "}"}]}], ")"}], "/.", "sortall"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7673486246877527`*^9, 3.7673487772929993`*^9}, {
  3.767348808053249*^9, 3.76734883107983*^9}, {3.7673491172474046`*^9, 
  3.767349200383771*^9}, {3.767349249232695*^9, 3.767349281064608*^9}, {
  3.767349313524473*^9, 3.7673494146621704`*^9}, {3.767349913556312*^9, 
  3.7673499141059995`*^9}, {3.767350093675337*^9, 3.7673501053852067`*^9}, {
  3.7673503681139283`*^9, 3.767350370464381*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"0c80907b-685f-4f34-b643-7f5b740cbe66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "data3", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data3", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ContainsAll", "[", 
            RowBox[{
             RowBox[{"List", "@@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "#"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#1", ",", "_R", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
              RowBox[{"#1", "/.", 
               RowBox[{
                RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
             "}"}], "]"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"rForm", "[", 
            RowBox[{"scalarBoxExpansion", "[", 
             RowBox[{
              RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{"bothlnonvan", ",", "bothnlnonvan"}], "]"}], ",", 
              "bothnvan"}], "]"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], ",", "\"\<Sqrt\>\""}], 
          "]"}]}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data31", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"redR", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "sortall"}], "/.",
              "sortcapinR"}], "/.", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"1", ",", "2", ",", 
               RowBox[{"n", "-", "1"}], ",", "n", ",", 
               RowBox[{"n", "+", "1"}]}], "]"}], ":>", "0"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"redR", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "sortall"}], "/.",
              "sortcapinR"}], "/.", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"1", ",", "2", ",", 
               RowBox[{"n", "-", "1"}], ",", "n", ",", 
               RowBox[{"n", "+", "1"}]}], "]"}], ":>", "0"}]}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"analyticIntegral", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "False"}], "]"}]}]}]}], 
          "}"}], "&"}], "/@", "data3"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", 
          RowBox[{"-", 
           RowBox[{"Li", "[", "1", "]"}]}]}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"_", ",", "0", ",", "_"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "_", ",", "_"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data32", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Limit", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "fullabB"}], ",", 
                  RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"a__", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
                    "b__", ",", "9"}], "]"}], "\[RuleDelayed]", 
                   RowBox[{"R", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7", ",", "8"}], "}"}]}], "]"}], ",", 
                    "b", ",", "8"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "9"}], "}"}], ",", "a_"}], "]"}], ",", 
                    "b___"}], "]"}], "\[RuleDelayed]", 
                   RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}], ",", "a"}], "]"}], ",", 
                    "b"}], "]"}]}]}], "}"}]}], "/.", 
               RowBox[{
                RowBox[{"R", "[", 
                 RowBox[{"x___", ",", 
                  RowBox[{"n", "+", "1"}], ",", "y___"}], "]"}], ":>", 
                RowBox[{"R", "[", 
                 RowBox[{"x", ",", "n", ",", "y"}], "]"}]}]}], ")"}], "//", 
             "Simplify"}], ",", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "9"}], "}"}], ",", "a_"}], "]"}], ",", 
                    "b___"}], "]"}], "\[RuleDelayed]", "0"}]}], ")"}], "//", 
                    "fullabB"}], ")"}], "/.", "sortall"}], "/.", "Rtodab"}], "/.",
                    "dabBexp"}], ")"}], "//", "fullabB"}], ")"}], ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data31"}],
         ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "0", ",", "_"}], "}"}]}], "]"}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.766730188884262*^9, 3.7667301890139017`*^9}, 
   3.766730408702194*^9, {3.7667304637285624`*^9, 3.7667304670855*^9}, {
   3.766730624794157*^9, 3.7667306365419674`*^9}, {3.766730716520525*^9, 
   3.766730720455834*^9}, {3.7667308935465565`*^9, 3.7667308938130074`*^9}, {
   3.7667313614939027`*^9, 3.766731368710772*^9}, 3.766731889392579*^9, {
   3.767067670379475*^9, 3.7670676773406944`*^9}, {3.767067827447935*^9, 
   3.767067832777223*^9}, {3.767068467168408*^9, 3.7670684691293464`*^9}, {
   3.7670685281186466`*^9, 3.767068534759308*^9}, {3.7670686860032263`*^9, 
   3.767068688726822*^9}, 3.7670687569149113`*^9, {3.767068861367261*^9, 
   3.767068862431823*^9}, 3.767068991542901*^9, 3.767069033601575*^9, {
   3.767075298447401*^9, 3.767075315617447*^9}, {3.76735038317068*^9, 
   3.7673503834930105`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"f3872656-b5a5-426c-8a5b-e263cc82f98d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data33", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "//", "dabRcanel"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Li", "[", "1", "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"Li", "[", "1", "]"}], "/", "2"}]}]}], ")"}], "//", 
             "fullabB"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{"e", " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}], ",", 
            RowBox[{
             RowBox[{"log", "[", 
              RowBox[{
               RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], ":>", 
             RowBox[{"log", "[", "y", "]"}]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"log", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Li", "[", 
             RowBox[{"Limit", "[", 
              RowBox[{"x", ",", 
               RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}]}]}], "}"}], "&"}], "/@",
     "data32"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767069058784033*^9, 3.7670690858265457`*^9}, {
   3.7670694182230177`*^9, 3.7670694372900686`*^9}, {3.7670696753129835`*^9, 
   3.7670696864273252`*^9}, {3.7670697197272687`*^9, 3.767069722644767*^9}, {
   3.7670697678913507`*^9, 3.7670698050467615`*^9}, {3.7673503812350473`*^9, 
   3.7673504151333895`*^9}, 3.767352456392902*^9},
 CellLabel->
  "In[140]:=",ExpressionUUID->"8b1a656e-5f13-4d39-930e-e5a2ef3205fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "tree", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amp1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"rAmp", "[", 
                RowBox[{"9", ",", "2"}], "]"}], "/.", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"i", "\[Rule]", 
                    RowBox[{"i", "-", "1"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "9"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", "\[Rule]", "9"}], "}"}]}], "]"}]}], "/.", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"i", "\[Rule]", 
                   RowBox[{"i", "-", "1"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "2", ",", "9"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", "9"}], "}"}]}], "]"}]}], ")"}], "/.",
             "sortR"}], "/.", "Rtodab"}], "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "x___", "]"}], 
            RowBox[{"R", "[", "y___", "]"}]}], "\[RuleDelayed]", "0"}]}], 
         "]"}], "/.", "dabBexp"}], "/.", "dabcapexpand"}], "//", 
      "dabRcanel"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amp2", "=", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"amp1", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"x___", ",", 
               RowBox[{"cap", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"9", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"b__", ",", "8"}], "}"}]}], "]"}], ",", "y___"}], 
              "]"}], "\[RuleDelayed]", 
             RowBox[{"R", "[", 
              RowBox[{"x", ",", "8", ",", "y"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"x___", ",", 
             RowBox[{"cap", "[", 
              RowBox[{"a__", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "9", ",", "8"}], "}"}]}], "]"}], ",", 
             "y___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"R", "[", 
            RowBox[{"x", ",", 
             RowBox[{"cap", "[", 
              RowBox[{"a", ",", 
               RowBox[{"{", 
                RowBox[{"8", ",", "7", ",", "1"}], "}"}]}], "]"}], ",", "y"}],
             "]"}]}]}], ")"}], "//", "fullabB"}], ",", 
       RowBox[{"e", "\[Rule]", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"etree92", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"scalarBoxRatioExpansion", "[", 
              RowBox[{"9", ",", "2"}], "]"}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"onShellGraph", "[", "x__", "]"}], "[", "y__", "]"}], 
              "\[RuleDelayed]", "0"}]}], ",", "0"}], "]"}], "/.", 
          RowBox[{"i_scalarBox", "\[RuleDelayed]", 
           RowBox[{"First", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"analyticIntegral", "[", 
              RowBox[{"i", ",", "False"}], "]"}], "]"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"amp", "[", 
           RowBox[{"9", ",", "2"}], "]"}], 
          RowBox[{"Li", "[", "1", "]"}]}]}], "]"}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data4", "=", 
     RowBox[{"{", 
      RowBox[{"amp2", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"etree92", "//", "fullabB"}], ")"}], "/.", 
             RowBox[{
              RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
              RowBox[{"log", "[", 
               RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"log", "[", 
                RowBox[{"e", " ", "y_"}], "]"}], ":>", 
               RowBox[{"log", "[", "y", "]"}]}], ",", 
              RowBox[{
               RowBox[{"log", "[", 
                RowBox[{
                 RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], ":>", 
               RowBox[{"log", "[", "y", "]"}]}]}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
              RowBox[{"log", "[", 
               RowBox[{"Limit", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
              RowBox[{"Li", "[", 
               RowBox[{"Limit", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "}"}]}], "/.", 
          RowBox[{
           RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}]}], ")"}], "/.", 
        RowBox[{
         RowBox[{"amp", "[", 
          RowBox[{"9", ",", "2"}], "]"}], "\[Rule]", "1"}]}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7673504774564114`*^9, 3.7673504777334228`*^9}, {
   3.7673506798552275`*^9, 3.7673507092423363`*^9}, {3.7673509969404526`*^9, 
   3.7673509984307337`*^9}, {3.767351062360458*^9, 3.76735106973024*^9}, {
   3.7673511836697617`*^9, 3.767351185189365*^9}, {3.767355742860555*^9, 
   3.767355746926326*^9}, {3.7675003809642696`*^9, 3.7675004315910063`*^9}, {
   3.767500553670021*^9, 3.767500557882005*^9}, 3.7678449850736055`*^9, 
   3.767845062369665*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"c66c8e56-93bf-4443-9fd1-0de0fe13b03b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"easy", " ", "4", " ", "massbox"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"easy4massbox", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
          RowBox[{"dab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "8"}], "}"}]}], "]"}], ",", "7", 
            ",", "8", ",", "2"}], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"8", ",", "2", ",", "3", ",", "4", ",", "5"}], "]"}]}], 
         RowBox[{"\[Tau]", " ", 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "4", ",", "8"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "5", ",", "8"}], "]"}]}]}], ")"}], 
          " ", 
          RowBox[{"ab", "[", 
           RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}]], ",", 
        RowBox[{
         RowBox[{"Li", "[", "1", "]"}], "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]]}], "]"}], 
         "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]]}], "]"}], 
         "+", 
         RowBox[{
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]]}], "]"}],
           " ", 
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]]}], 
           "]"}]}], "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]], "]"}], 
          " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "4", ",", "5"}], "]"}]}]], 
           "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
          RowBox[{"dab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "8"}], "}"}]}], "]"}], ",", "7", 
            ",", "8", ",", "2"}], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"8", ",", "2", ",", "3", ",", "5", ",", "6"}], "]"}]}], 
         RowBox[{"\[Tau]", " ", 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "5", ",", "8"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "6", ",", "8"}], "]"}]}]}], ")"}], 
          " ", 
          RowBox[{"ab", "[", 
           RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}]], ",", 
        RowBox[{
         RowBox[{"Li", "[", "1", "]"}], "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}], 
         "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}], 
         "+", 
         RowBox[{
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}],
           " ", 
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], 
           "]"}]}], "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]], "]"}], 
          " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "2", ",", "3"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]], 
           "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
          RowBox[{"dab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4", ",", "8"}], "}"}]}], "]"}], ",", "7", 
            ",", "8", ",", "2"}], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"8", ",", "3", ",", "4", ",", "5", ",", "6"}], "]"}]}], 
         RowBox[{"\[Tau]", " ", 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "5", ",", "8"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "6", ",", "8"}], "]"}]}]}], 
           ")"}]}]], ",", 
        RowBox[{
         RowBox[{"Li", "[", "1", "]"}], "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}], 
         "-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "3", ",", "4"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}], 
         "+", 
         RowBox[{
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], "]"}],
           " ", 
          RowBox[{"log", "[", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "3", ",", "4"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
              RowBox[{"ab", "[", 
               RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]]}], 
           "]"}]}], "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "9", ",", "1"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]], "]"}], 
          " ", 
          RowBox[{"log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "3", ",", "4"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
             RowBox[{"ab", "[", 
              RowBox[{"9", ",", "1", ",", "5", ",", "6"}], "]"}]}]], 
           "]"}]}]}]}], "}"}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7675643344043264`*^9, 3.7675643452838016`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"2a1e7ffc-7e32-40cf-a8b2-5962b056a7dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"easy4massbox", "//", "fullabB"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"log", "[", 
         RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"log", "[", 
          RowBox[{"e", " ", "y_"}], "]"}], ":>", 
         RowBox[{"log", "[", "y", "]"}]}], ",", 
        RowBox[{
         RowBox[{"log", "[", 
          RowBox[{
           RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], ":>", 
         RowBox[{"log", "[", "y", "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"log", "[", 
         RowBox[{"Limit", "[", 
          RowBox[{"x", ",", 
           RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Li", "[", 
         RowBox[{"Limit", "[", 
          RowBox[{"x", ",", 
           RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7673511934294577`*^9, 3.767351197799703*^9}, {
  3.7673555704709415`*^9, 3.767355574367226*^9}, {3.767442879176613*^9, 
  3.7674429263470244`*^9}, {3.7683683689441514`*^9, 3.768368373754884*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"8c1c76f0-618f-4ce5-bb98-38b8cb1d69fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"coefficents", " ", "of", " ", 
    RowBox[{"1", "/", "\[Tau]"}], " ", "in", " ", "hard4massbox"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"hardlogt", "[", "1", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"rForm", "[", 
                RowBox[{
                 RowBox[{"onShellGraph", "[", "2", "]"}], "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "1"}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
                 "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
                RowBox[{"sqrt", "[", 
                 RowBox[{"Limit", "[", 
                  RowBox[{
                   RowBox[{"x", "//", "fullabB"}], ",", 
                   RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "/.", 
              "sortR"}], "/.", "Rtodab"}], "/.", "dabBexp"}], "/.", 
           "dabshifexp"}], "//", "fullabB"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}], 
          "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"log", "[", "\[Tau]", "]"}], "+", 
           RowBox[{"log", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]], "]"}]}],
           ")"}], 
         RowBox[{"log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]], 
          "]"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hardlogt", "[", "2", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"rForm", "[", 
                RowBox[{
                 RowBox[{"onShellGraph", "[", "2", "]"}], "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "1"}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
                 "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
                RowBox[{"sqrt", "[", 
                 RowBox[{"Limit", "[", 
                  RowBox[{
                   RowBox[{"x", "//", "fullabB"}], ",", 
                   RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "/.", 
              "sortR"}], "/.", "Rtodab"}], "/.", "dabBexp"}], "/.", 
           "dabshifexp"}], "//", "fullabB"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}]}]]}], 
          "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"log", "[", "\[Tau]", "]"}], "+", 
           RowBox[{"log", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}]}]], "]"}]}],
           ")"}], 
         RowBox[{"log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}]}]], 
          "]"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hardlogt", "[", "3", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"rForm", "[", 
                RowBox[{
                 RowBox[{"onShellGraph", "[", "2", "]"}], "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "1", ",", "2"}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
                 "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
                RowBox[{"sqrt", "[", 
                 RowBox[{"Limit", "[", 
                  RowBox[{
                   RowBox[{"x", "//", "fullabB"}], ",", 
                   RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "/.", 
              "sortR"}], "/.", "Rtodab"}], "/.", "dabBexp"}], "/.", 
           "dabshifexp"}], "//", "fullabB"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Li", "[", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"2", ",", "3", ",", "6", ",", "7"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}], 
          "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"log", "[", "\[Tau]", "]"}], "+", 
           RowBox[{"log", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}], 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"2", ",", "3", ",", "6", ",", "7"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]], "]"}]}],
           ")"}], 
         RowBox[{"log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "6", ",", "7"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]], 
          "]"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Warning", ":", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "coefficents", " ", "of", " ", "these", " ", "four"}], "-", 
      RowBox[{
      "mass", " ", "must", " ", "be", " ", "taken", " ", "numerically", " ", 
       "for", " ", "now"}]}]}], "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"Residue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fuse", "[", 
              RowBox[{"todmatrix", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"hardlogt", "[", "3", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "//", "todoubleab"}], "]"}], 
              "]"}], ")"}], "//", "neab1"}], "]"}], "/.", 
          RowBox[{"dabne", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "]"}]}], "/.", 
         RowBox[{"DmatrixEval3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", "4"}], "}"}], ",", "3"}], "]"}]}], 
        ",", 
        RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "x", "]"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Tau]", ",", "0"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7678454434997373`*^9, 3.7678455500627584`*^9}, {
  3.767845609855941*^9, 3.76784584091637*^9}, {3.7678460037314157`*^9, 
  3.7678460053025255`*^9}, {3.7678461073863845`*^9, 3.767846165107677*^9}, {
  3.7678462351741934`*^9, 3.7678462452830544`*^9}, {3.7678462767123594`*^9, 
  3.767846292323882*^9}, {3.767846332932496*^9, 3.7678463882241364`*^9}, {
  3.767846418905261*^9, 3.7678465377374697`*^9}, {3.7678466847071257`*^9, 
  3.767846688362564*^9}, {3.7678469162126083`*^9, 3.7678469408664193`*^9}, {
  3.7678475232086353`*^9, 3.7678475269929695`*^9}, {3.767848491851914*^9, 
  3.7678485535902977`*^9}, {3.7683698887083054`*^9, 3.7683698965926456`*^9}},
 CellLabel->
  "In[512]:=",ExpressionUUID->"c3633c37-c1d6-4cfc-a56e-7903243ac297"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", "800"]}]], "Output",
 CellChangeTimes->{{3.7678469321721563`*^9, 3.767846941709381*^9}, 
   3.767847071197502*^9, {3.767848483146817*^9, 3.767848528292014*^9}, 
   3.7678485613749933`*^9},
 CellLabel->
  "Out[515]=",ExpressionUUID->"7ebb5da6-d4f7-4526-a0d2-c8e563a14629"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"(", 
        RowBox[{"fuse", "[", 
         RowBox[{"todmatrix", "[", 
          RowBox[{
           RowBox[{"hardlogt3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//", "todoubleab"}], "]"}], 
         "]"}], ")"}], "]"}], "/.", 
      RowBox[{"dabne", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "]"}]}], "/.", 
     RowBox[{"DmatrixEval3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "4"}], "}"}], ",", "3"}], "]"}]}], "//", 
    "neab1"}], ",", 
   RowBox[{"e", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767846711430772*^9, 3.7678468039706*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"e896a891-4c8b-4f28-b33b-a8d15546aace"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "12474205821000000000000"}], " ", "\[Tau]"}], "+", 
            RowBox[{"1364718988080000000000000", " ", 
             SuperscriptBox["\[Tau]", "2"]}], "+", 
            TemplateBox[{"152"},
             "OutputSizeLimit`Skeleton"], "+", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "+", 
            RowBox[{"19972065004093440000000000000000000000", " ", 
             SuperscriptBox["\[Tau]", "10"], " ", 
             SuperscriptBox[
              RowBox[{"sqrt", "[", 
               RowBox[{
                FractionBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], 
                 RowBox[{"2", " ", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"]}]], "+", 
                SuperscriptBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], "2"]}], "]"}], "10"]}], "+", 
            RowBox[{"39944130008186880000000000000000000000", " ", 
             SuperscriptBox["\[Tau]", "11"], " ", 
             SuperscriptBox[
              RowBox[{"sqrt", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "50"}], "-", 
                    RowBox[{"50", " ", "\[Tau]"}]}], ")"}], " ", "\[Tau]"}], 
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}], "2"]}]], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "+", 
                   FractionBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]]}], ")"}], "2"]}], "]"}], 
              "10"]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "60379349184000000000000"}], " ", "\[Tau]", " ", 
             RowBox[{"sqrt", "[", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "50"}], "-", 
                   RowBox[{"50", " ", "\[Tau]"}]}], ")"}], " ", "\[Tau]"}], 
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "6"}], "-", 
                    RowBox[{"120", " ", "\[Tau]"}]}], ")"}], "2"]}]], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "50"}], "-", 
                    RowBox[{"50", " ", "\[Tau]"}]}], 
                   RowBox[{"20", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], "-", 
                    RowBox[{"120", " ", "\[Tau]"}]}], ")"}]}]], "+", 
                  FractionBox[
                   RowBox[{"5", " ", "\[Tau]"}], 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], "-", 
                    RowBox[{"120", " ", "\[Tau]"}]}], ")"}]}]]}], ")"}], 
                "2"]}], "]"}]}], "+", 
            RowBox[{"7113088120320000000000000", " ", 
             SuperscriptBox["\[Tau]", "2"], " ", 
             RowBox[{"sqrt", "[", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "50"}], "-", 
                   RowBox[{"50", " ", "\[Tau]"}]}], ")"}], " ", "\[Tau]"}], 
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}]}], "2"]}]], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], ")"}], "2"]}], "]"}]}], "+", 
            TemplateBox[{"124"},
             "OutputSizeLimit`Skeleton"], "+", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "+", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "+", 
            RowBox[{"159776520032747520000000000000000000000", " ", 
             SuperscriptBox["\[Tau]", "11"], " ", 
             SuperscriptBox[
              RowBox[{"sqrt", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "50"}], "-", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}], " ", "\[Tau]"}], 
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "2"]}]], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], ")"}], "2"]}], "]"}], 
              "9"]}]}], ")"}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{240., {9., 50.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{244., {8., 50.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{244., {8., 50.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 375, 27399892357398596456, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{244., {9., 50.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 375, 27399892357398596456, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{244., {8., 51.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 375, 27399892357398596456, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{411., {9., 51.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[27399892357398596456 === $SessionID, 
   Out[375], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.767846712758584*^9, 3.7678468046257505`*^9}, 
   3.7678470714006186`*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"eec8c9ad-9ef2-4010-ad24-d21b111c8083"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"coefficients", " ", "of", " ", 
    RowBox[{"1", "/", "\[Tau]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"temp1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Tau]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "data13"}], 
         ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "data13"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Tau]"}], ",", 
         RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
      "data28"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"temp22", ",", "Indeterminate"}], "]"}], "//", "Flatten"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"{", 
     RowBox[{"18", ",", "31", ",", "40"}], "}"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp2", "=", 
     RowBox[{
      RowBox[{"ReplacePart", "[", 
       RowBox[{"temp2", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"18", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"\[Tau]", " ", 
                    RowBox[{"data27", "[", 
                    RowBox[{"[", 
                    RowBox[{"18", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Tau]", ",", "0", ",", "0"}], "}"}]}], "]"}], "/.",
                  "sortall"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "7"}], 
                   "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"R", "[", 
                    RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "8"}], 
                    "]"}]}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"1", ",", "2", ",", "3", ",", "7", ",", "8"}], 
                    "]"}], "-", 
                    RowBox[{"R", "[", 
                    RowBox[{"1", ",", "2", ",", "6", ",", "7", ",", "8"}], 
                    "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"1", ",", "3", ",", "6", ",", "7", ",", "8"}], 
                    "]"}], "-", 
                    RowBox[{"R", "[", 
                    RowBox[{"2", ",", "3", ",", "6", ",", "7", ",", "8"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "/.", "sortall"}], "//", 
              "dabRcanel"}], ")"}]}], "/.", "sortall"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"31", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"\[Tau]", " ", 
                    RowBox[{"data27", "[", 
                    RowBox[{"[", 
                    RowBox[{"31", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Tau]", ",", "0", ",", "0"}], "}"}]}], "]"}], "/.",
                  "sortall"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"2", ",", "3", ",", "6", ",", "7", ",", "8"}], 
                   "]"}], "->", 
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "2", ",", "3", ",", "6", ",", "7"}], 
                    "]"}], "-", 
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "2", ",", "3", ",", "6", ",", "8"}], 
                    "]"}], "+", 
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "2", ",", "3", ",", "7", ",", "8"}], 
                    "]"}], "-", 
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "2", ",", "6", ",", "7", ",", "8"}], 
                    "]"}], "+", 
                   RowBox[{"R", "[", 
                    RowBox[{"4", ",", "3", ",", "6", ",", "7", ",", "8"}], 
                    "]"}]}]}], "}"}]}], ")"}]}], "/.", "sortall"}], "//", 
            "Simplify"}], "//", "dabRcanel"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"40", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SeriesCoefficient", "[", 
                  RowBox[{
                   RowBox[{"\[Tau]", " ", 
                    RowBox[{"data27", "[", 
                    RowBox[{"[", 
                    RowBox[{"40", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Tau]", ",", "0", ",", "0"}], "}"}]}], "]"}], "/.",
                  "sortall"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
                   "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"R", "[", 
                    RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "8"}], 
                    "]"}]}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"3", ",", "4", ",", "5", ",", "7", ",", "8"}], 
                    "]"}], "-", 
                    RowBox[{"R", "[", 
                    RowBox[{"3", ",", "4", ",", "6", ",", "7", ",", "8"}], 
                    "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"3", ",", "5", ",", "6", ",", "7", ",", "8"}], 
                    "]"}], "-", 
                    RowBox[{"R", "[", 
                    RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "/.", "sortall"}], "//", 
              "dabRcanel"}], ")"}]}], "/.", "sortall"}]}], "}"}]}], "]"}], 
      ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "data28"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp3", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Tau]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "data33"}], 
         ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "data33"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp4", "=", 
     RowBox[{
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"\[Tau]", " ", 
         RowBox[{"data4", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{"Last", "@", "data4"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.76733516754533*^9, 3.767335242113552*^9}, {
   3.7673484537925262`*^9, 3.7673484544723997`*^9}, {3.767349681176793*^9, 
   3.767349704926837*^9}, {3.7673497772023783`*^9, 3.767349800813236*^9}, 
   3.7673498439062486`*^9, {3.7673499916261015`*^9, 3.7673500021861334`*^9}, 
   3.7673501633350945`*^9, {3.7673502187240424`*^9, 3.767350235614176*^9}, {
   3.767350285987753*^9, 3.76735029111438*^9}, {3.7673503401839857`*^9, 
   3.767350355403927*^9}, {3.7673507981414995`*^9, 3.767350798815029*^9}, {
   3.767350887741394*^9, 3.767351052780389*^9}, {3.767351201879651*^9, 
   3.7673512020397344`*^9}, {3.767351404888627*^9, 3.767351405428643*^9}, {
   3.7673534382184544`*^9, 3.7673534598286066`*^9}, {3.767502427770816*^9, 
   3.7675024407895083`*^9}, 3.767564470806455*^9},
 CellLabel->
  "In[376]:=",ExpressionUUID->"08fc5c82-d3b5-4359-acaf-d12eed3aa6a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", 
    RowBox[{
     RowBox[{"log", "[", "tau", "]"}], "/", "tau"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "minideg", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minideg", "[", 
     RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"minideg", "[", 
      RowBox[{"x", ",", "\[Tau]"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"var", ",", "0", ",", "0"}], "}"}]}], "]"}], "===", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"minideg", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"f", ",", "var"}], "]"}], ",", "var"}], "]"}], "+", "1"}], 
       ",", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tempall", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"temp1", "+", "temp2", "+", "temp3", "+", "temp4"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hh", "=", 
              RowBox[{"minideg", "[", 
               RowBox[{"x", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"hh", "===", "0"}], ",", 
              RowBox[{"log", "[", 
               RowBox[{"Limit", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"minideg", "[", 
                 RowBox[{"x", ",", "\[Tau]"}], "]"}], 
                RowBox[{"log", "[", "0", "]"}]}], "+", 
               RowBox[{"log", "[", 
                RowBox[{"SeriesCoefficient", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Tau]", ",", "0", ",", "hh"}], "}"}]}], "]"}], 
                "]"}]}]}], "]"}]}], "]"}]}], "}"}]}], "/.", 
       RowBox[{
        RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Li", "[", 
         RowBox[{"Limit", "[", 
          RowBox[{"x", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"Li", "[", "0", "]"}], "\[Rule]", "0"}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"numtemp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"tempall", "//", "neab1"}], ")"}], "//", 
                "todoubleab"}], "//", "todmatrix"}], "//", "fuse"}], ")"}], "/.", 
            RowBox[{"dabne", "[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "6"}], "}"}], "]"}]}], "/.", 
           RowBox[{"DmatrixEval3", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", "7"}], "}"}], ",", "3"}], "]"}]}], 
          ")"}], "//", "neab1"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hardall", "=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Residue", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Limit", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fuse", "[", 
                    RowBox[{"todmatrix", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"hardlogt", "[", "a", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "todoubleab"}], 
                    "]"}], "]"}], "//", "neab1"}], ")"}], "]"}], "/.", 
                   RowBox[{"dabne", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "6"}], "}"}], "]"}]}], "/.", 
                  RowBox[{"DmatrixEval3", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "7"}], "}"}], ",", "3"}], 
                   "]"}]}], "//", "neab1"}], ",", 
                RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "/.", 
              RowBox[{
               RowBox[{"sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
               RowBox[{"-", 
                RowBox[{"Sqrt", "[", "x", "]"}]}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Tau]", ",", "0"}], "}"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"hardlogt", "[", "a", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "/.", 
             RowBox[{"\[Tau]", "\[RuleDelayed]", "0"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "3"}], "}"}]}], "]"}], "//", "neab1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"numtemp", "+", "hardall"}], ",", 
          RowBox[{"log", "[", "0", "]"}]}], "]"}], "/.", 
        RowBox[{"log", "\[Rule]", "Log"}]}], "//", "FullSimplify"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "i", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7673512137193956`*^9, 3.7673512226994257`*^9}, {
   3.767351271909619*^9, 3.767351321278403*^9}, {3.767351488037235*^9, 
   3.7673515204976273`*^9}, {3.767351902395968*^9, 3.767352138394955*^9}, 
   3.7673525249831743`*^9, {3.7673527363819885`*^9, 3.76735274415699*^9}, {
   3.7673534256384883`*^9, 3.767353430208596*^9}, {3.7673553205181*^9, 
   3.767355377829213*^9}, {3.7673558123066535`*^9, 3.767355814756591*^9}, {
   3.7673560210255938`*^9, 3.767356022825491*^9}, {3.767356053284639*^9, 
   3.767356053978794*^9}, {3.7674960070924034`*^9, 3.7674960398694143`*^9}, {
   3.767496137530118*^9, 3.7674961377880077`*^9}, {3.767496168800311*^9, 
   3.7674961714318166`*^9}, {3.767500696737708*^9, 3.767500699129017*^9}, {
   3.767502434849035*^9, 3.7675024354882555`*^9}, {3.7675025076166906`*^9, 
   3.767502508358825*^9}, {3.767564432342944*^9, 3.767564473211378*^9}, {
   3.7678466251472282`*^9, 3.7678466723247757`*^9}, {3.767846869412722*^9, 
   3.7678468765841417`*^9}, {3.7678469621956606`*^9, 
   3.7678470196654034`*^9}, {3.767847275774788*^9, 3.7678472795670433`*^9}, {
   3.7678481186816835`*^9, 3.767848123324956*^9}, {3.767848153757457*^9, 
   3.767848179150933*^9}, {3.767848212157223*^9, 3.7678482335778236`*^9}, {
   3.7678488449085484`*^9, 3.7678488543313293`*^9}, {3.7678489704042206`*^9, 
   3.7678489718971634`*^9}, {3.7678492707568493`*^9, 
   3.7678492779439497`*^9}, {3.7678493604102182`*^9, 3.7678493638838367`*^9}},
 CellLabel->
  "In[555]:=",ExpressionUUID->"6470cc11-dc98-49fe-be38-9e2690478d9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.767500780266278*^9, 3.767500808429081*^9}, 
   3.767501001076558*^9, 3.7678471572613716`*^9, 3.767847890764063*^9, {
   3.7678481731514573`*^9, 3.7678481947121134`*^9}, 3.76784822819838*^9, 
   3.767848645446327*^9, 3.7678489199475174`*^9, 3.76784903380591*^9, 
   3.767849330873686*^9, 3.767849423664798*^9},
 CellLabel->
  "Out[558]=",ExpressionUUID->"3f6aee25-ddd8-47c3-9c93-393f1c810a7d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "inf"}], ",", " ", 
    RowBox[{"coefficients", " ", "of", " ", 
     RowBox[{"1", "/", "\[Tau]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"temp1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "Infinity"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Tau]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "data13"}], 
         ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", " ", "data13"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Tau]"}], ",", 
         RowBox[{"\[Tau]", "\[Rule]", "Infinity"}]}], "]"}], "&"}], "/@", 
      "data28"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"temp22", ",", "Indeterminate"}], "]"}], "//", "Flatten"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"{", 
     RowBox[{"18", ",", "31", ",", "40"}], "}"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp2", "=", 
     RowBox[{"temp2", ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "data28"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp3", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "Infinity"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Tau]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "data33"}], 
         ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "data33"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp4", "=", 
     RowBox[{
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"\[Tau]", " ", 
         RowBox[{"data4", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\[Tau]", "\[Rule]", "Infinity"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{"Last", "@", "data4"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.768368429582944*^9, 3.7683684416565523`*^9}, {
  3.7683691821168375`*^9, 3.7683691957386646`*^9}, {3.768369255394183*^9, 
  3.7683692563044868`*^9}, {3.7683693830051885`*^9, 3.7683693955845795`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"701aec9d-f05e-422b-9eeb-96d5e2b99b55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "/.", 
   RowBox[{"\[Tau]", "\[Rule]", 
    RowBox[{"1", "/", "\[Tau]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.768369512911619*^9, 3.768369534611364*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"7af2fa07-856a-4dc9-84c1-283fb83ea307"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "3", ",", "5"}], "]"}]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
         RowBox[{"dab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8", ",", "2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"dab", "[", 
             RowBox[{"1", ",", "4", ",", "5", ",", "8", ",", "7"}], "]"}]}], 
           "+", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"dab", "[", 
             RowBox[{"1", ",", "4", ",", "7", ",", "8", ",", "2"}], "]"}]}]}],
           ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Li", "[", "1", "]"}], "+", 
        RowBox[{
         RowBox[{"log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "4", ",", "5", ",", "8"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "3", ",", "4", ",", "8"}], "]"}]}]], "]"}], 
         " ", 
         RowBox[{"log", "[", 
          FractionBox[
           RowBox[{"\[Tau]", " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}]], "]"}]}]}],
        ")"}], " ", 
      RowBox[{"R", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "]"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
      RowBox[{"ab", "[", 
       RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "3", ",", "5"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"ab", "[", 
       RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.768369520381741*^9, 3.7683695349588575`*^9}},
 CellLabel->
  "Out[200]=",ExpressionUUID->"82b6ba99-9138-4d58-a7f7-86b2b1220e0b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", 
    RowBox[{
     RowBox[{"log", "[", "tau", "]"}], "/", "tau"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "minideg", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minideg", "[", 
     RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"minideg", "[", 
      RowBox[{"x", ",", "\[Tau]"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"var", ",", "0", ",", "0"}], "}"}]}], "]"}], "===", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"minideg", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"f", ",", "var"}], "]"}], ",", "var"}], "]"}], "+", "1"}], 
       ",", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tempall", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"temp1", "+", "temp2", "+", "temp3", "+", "temp4"}], ")"}], 
         "/.", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", "\[Rule]", 
           RowBox[{"1", "/", "\[Tau]"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hh", "=", 
              RowBox[{"minideg", "[", 
               RowBox[{"x", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"hh", "===", "0"}], ",", 
              RowBox[{"log", "[", 
               RowBox[{"Limit", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"minideg", "[", 
                 RowBox[{"x", ",", "\[Tau]"}], "]"}], 
                RowBox[{"log", "[", "0", "]"}]}], "+", 
               RowBox[{"log", "[", 
                RowBox[{"SeriesCoefficient", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Tau]", ",", "0", ",", "hh"}], "}"}]}], "]"}], 
                "]"}]}]}], "]"}]}], "]"}]}], "}"}]}], "/.", 
       RowBox[{
        RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Li", "[", 
         RowBox[{"Limit", "[", 
          RowBox[{"x", ",", 
           RowBox[{"\[Tau]", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"log", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"Li", "[", "0", "]"}], "\[Rule]", "0"}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numtemp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tempall", "//", "neab1"}], ")"}], "//", 
                 "todoubleab"}], "//", "todmatrix"}], "//", "fuse"}], ")"}], "/.", 
             RowBox[{"dabne", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "6"}], "}"}], "]"}]}], "/.", 
            RowBox[{"DmatrixEval3", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "7"}], "}"}], ",", "3"}], "]"}]}], 
           ")"}], "//", "neab1"}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hardall", "=", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Residue", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Limit", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fuse", "[", 
                    RowBox[{"todmatrix", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"hardlogt", "[", "a", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "todoubleab"}], 
                    "]"}], "]"}], "//", "neab1"}], ")"}], "]"}], "/.", 
                    RowBox[{"dabne", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "6"}], "}"}], "]"}]}], "/.", 
                   RowBox[{"DmatrixEval3", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "7"}], "}"}], ",", "3"}], 
                    "]"}]}], "//", "neab1"}], ",", 
                 RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "/.", 
               RowBox[{
                RowBox[{"sqrt", "[", "x_", "]"}], "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"Sqrt", "[", "x", "]"}]}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Tau]", ",", "0"}], "}"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"hardlogt", "[", "a", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/.", 
              RowBox[{"\[Tau]", "\[RuleDelayed]", "0"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "3"}], "}"}]}], "]"}], "//", "neab1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"numtemp", "+", "hardall"}], ",", 
           RowBox[{"log", "[", "0", "]"}]}], "]"}], "/.", 
         RowBox[{"log", "\[Rule]", "Log"}]}], "//", "FullSimplify"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i", ",", "3"}], "}"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.768369550005934*^9, 3.7683695711519804`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"1560d60f-e4ff-4dfc-b0ee-1004f46ba8b4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"numtemp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tempall", "//", "neab1"}], ")"}], "//", "todoubleab"}],
             "//", "todmatrix"}], "//", "fuse"}], ")"}], "/.", 
         RowBox[{"dabne", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "6"}], "}"}], "]"}]}], "/.", 
        RowBox[{"DmatrixEval3", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "8", ",", "7"}], "}"}], ",", "3"}], "]"}]}], 
       ")"}], "//", "neab1"}], "//", "Simplify"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7683695793430424`*^9, 3.7683696934109573`*^9}, {
  3.7683697247777214`*^9, 3.7683697251318235`*^9}, {3.768369766157777*^9, 
  3.7683697663737383`*^9}, {3.7683698004508333`*^9, 3.768369800582528*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"720deb0e-add7-42f7-8399-828c1230600e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{"numtemp", ",", 
   RowBox[{"log", "[", "0", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76836970457679*^9, 3.768369705824891*^9}, {
  3.7683697360166035`*^9, 3.768369743048245*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"fb155c0b-222c-4a19-8b56-57389565fd79"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.768369706303714*^9, 3.768369743519368*^9}, 
   3.768369780269977*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"5d4f1661-8752-4cbf-ae2f-e7b76929017d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "e", " ", "num", " ", "check"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"logecoeff", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
           RowBox[{"log", "[", 
            RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "//.", 
         RowBox[{
          RowBox[{"log", "[", 
           RowBox[{
            SuperscriptBox["e", "a_"], " ", "b_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"log", "[", "e", "]"}]}], "+", 
           RowBox[{"log", "[", "b", "]"}]}]}]}], ",", 
        RowBox[{"log", "[", "e", "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"log", "[", "x__", "]"}], "\[RuleDelayed]", 
       RowBox[{"log", "[", 
        RowBox[{"Limit", "[", 
         RowBox[{"x", ",", 
          RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data12", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data12"}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data32", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "data32"}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logedata1", "=", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//", "fullabB"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
               RowBox[{"log", "[", 
                RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"log", "[", 
               RowBox[{
                RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"x", " ", 
                RowBox[{"log", "[", "e", "]"}]}], "+", 
               RowBox[{"log", "[", "y", "]"}]}]}]}], "/.", 
            RowBox[{"e", "\[Rule]", "0"}]}], ",", 
           RowBox[{"log", "[", "0", "]"}]}], "]"}]}], "&"}], "/@", "data12"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logedata2", "=", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//", "fullabB"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
               RowBox[{"log", "[", 
                RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"log", "[", 
               RowBox[{
                RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"x", " ", 
                RowBox[{"log", "[", "e", "]"}]}], "+", 
               RowBox[{"log", "[", "y", "]"}]}]}]}], "/.", 
            RowBox[{"e", "\[Rule]", "0"}]}], ",", 
           RowBox[{"log", "[", "0", "]"}]}], "]"}]}], "&"}], "/@", "data25"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logedata2", "=", 
     RowBox[{
      RowBox[{"logedata2", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
            "z___"}], "]"}], ":>", 
          RowBox[{"R", "[", 
           RowBox[{"x", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", "y", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "z"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", 
            "z___"}], "]"}], ":>", 
          RowBox[{"R", "[", 
           RowBox[{"x", ",", 
            RowBox[{"cap", "[", 
             RowBox[{
              RowBox[{"{", "y", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "z"}], 
           "]"}]}]}], "}"}]}], "/.", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "8", ",", "9"}], "}"}]}], "]"}], ",", "z___"}],
         "]"}], ":>", 
       RowBox[{"R", "[", 
        RowBox[{"x", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "8", ",", "B"}], "}"}]}], "]"}], ",", "z"}], 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logedata3", "=", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//", "fullabB"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"log", "[", "x_", "]"}], "\[RuleDelayed]", 
               RowBox[{"log", "[", 
                RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"log", "[", 
               RowBox[{
                RowBox[{"e", "^", "x_"}], " ", "y_"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"x", " ", 
                RowBox[{"log", "[", "e", "]"}]}], "+", 
               RowBox[{"log", "[", "y", "]"}]}]}]}], "/.", 
            RowBox[{"e", "\[Rule]", "0"}]}], ",", 
           RowBox[{"log", "[", "0", "]"}]}], "]"}]}], "&"}], "/@", "data32"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"treeresult", "=", 
     RowBox[{"2", " ", "*", "amp2", "  ", 
      RowBox[{"log", "[", 
       FractionBox[
        RowBox[{"\[Tau]", " ", 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Tau]", " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "5", ",", "6", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}]}]}], ")"}]}]],
        "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loge4massbox", "=", 
     RowBox[{"Total", "[", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"logecoeff", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "//", "fullabB"}], "]"}]}], 
          "}"}], "&"}], "/@", "easy4massbox"}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.766894838048583*^9, 3.7668948736143503`*^9}, {
   3.7668949654501514`*^9, 3.766894972674495*^9}, {3.766895012500351*^9, 
   3.7668951279297*^9}, {3.7668951899460583`*^9, 3.7668952305569315`*^9}, {
   3.7668952628534527`*^9, 3.7668952952301292`*^9}, {3.766895368015938*^9, 
   3.766895406656046*^9}, 3.7668954367149167`*^9, {3.7669808951071377`*^9, 
   3.766980895298674*^9}, {3.766982246565626*^9, 3.7669822551195545`*^9}, {
   3.767502620654873*^9, 3.767502621667703*^9}, 3.767564449401415*^9, 
   3.767564487456358*^9, {3.767564525057121*^9, 3.767564610654614*^9}},
 CellLabel->
  "In[385]:=",ExpressionUUID->"11fbb98d-a811-48fa-83bb-4bccedd05c66"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "treeresult", "+", "logedata1", "+", "logedata2", "+", 
                "logedata3", "+", "loge4massbox"}], ")"}], "//", 
              "todoubleab"}], "//", "todmatrix"}], "//", "fuse"}], ")"}], "/.", 
          RowBox[{"dabne", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "/.", 
         RowBox[{"DmatrixEval3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", "3"}], "]"}]}], "//",
         "fullabB"}], ")"}], "//", "neab1"}], ",", 
     RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"%", "/.", 
         RowBox[{"Log", "\[Rule]", "log"}]}], ")"}], "//", "expandlog"}], 
      "]"}], ",", "_log"}], "]"}], "/.", 
   RowBox[{"log", "\[Rule]", "Log"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7668974196203575`*^9, 3.7668974365204706`*^9}, {
   3.7668975002116394`*^9, 3.7668976056118526`*^9}, 3.7668977117520742`*^9, {
   3.7668978066480355`*^9, 3.766897857405505*^9}, 3.7668979023310165`*^9, 
   3.7668981157981615`*^9, {3.76689817889607*^9, 3.766898184412934*^9}, {
   3.766899514739865*^9, 3.7668996209446588`*^9}, {3.766899692953624*^9, 
   3.766899704742385*^9}, {3.7668998473157406`*^9, 3.766899848360237*^9}, {
   3.766899898278793*^9, 3.7669000447999487`*^9}, {3.7669001802876883`*^9, 
   3.766900184890535*^9}, {3.7669003682325945`*^9, 3.766900371282627*^9}, {
   3.7669004915987315`*^9, 3.766900493962633*^9}, {3.766900613356896*^9, 
   3.7669007230524883`*^9}, {3.76690139974481*^9, 3.7669014123558536`*^9}, {
   3.7669014882635994`*^9, 3.7669014917730684`*^9}, {3.7669809224964066`*^9, 
   3.7669809287679806`*^9}, {3.7669822208744164`*^9, 
   3.7669822318486533`*^9}, {3.766983767884972*^9, 3.7669837700855045`*^9}, {
   3.766983819042461*^9, 3.766983918197514*^9}, {3.7670656294304423`*^9, 
   3.767065636237156*^9}, {3.767066031335593*^9, 3.7670660364640074`*^9}, {
   3.7670660690656185`*^9, 3.767066093371242*^9}, {3.7670663279136024`*^9, 
   3.7670663540909033`*^9}, {3.767067044407302*^9, 3.7670670558517313`*^9}, {
   3.7670700350220375`*^9, 3.7670700460195055`*^9}, 3.7670701883106327`*^9, 
   3.767072538208495*^9, {3.76707283934925*^9, 3.767072876642256*^9}, {
   3.7670743511158457`*^9, 3.7670743588348875`*^9}, {3.767502353465554*^9, 
   3.7675023606926203`*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"1f23a438-d20f-451b-9aad-bb35f5a6228b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"70", " ", "\[Tau]", " ", 
    RowBox[{"(", 
     RowBox[{"353", "+", 
      RowBox[{"469", " ", "\[Tau]"}]}], ")"}], " ", 
    RowBox[{"Log", "[", "\[Tau]", "]"}]}], "-", 
   RowBox[{"2030", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Tau]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"5", " ", "\[Tau]"}]}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", "\[Tau]"}], "]"}]}], "+", 
   RowBox[{"4536", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "\[Tau]", " ", 
       RowBox[{"Log", "[", "5", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"5", " ", "\[Tau]"}]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{"5", " ", "\[Tau]"}]}], "]"}]}]}], ")"}]}]}], 
  RowBox[{"28125", " ", "\[Tau]", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"5", " ", "\[Tau]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.7670725559046564`*^9, 3.7670726000025277`*^9, 
  3.767072844334113*^9, 3.767072886502353*^9, 3.767074364185695*^9, 
  3.767502215801257*^9, 3.7675023197568274`*^9, 3.767502364527389*^9, 
  3.7678471598877354`*^9},
 CellLabel->
  "Out[395]=",ExpressionUUID->"3ff6989e-775f-412b-8198-82f5db11e739"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"70", " ", "\[Tau]", " ", 
      RowBox[{"(", 
       RowBox[{"353", "+", 
        RowBox[{"469", " ", "\[Tau]"}]}], ")"}], " ", 
      RowBox[{"Log", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"2030", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Tau]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"5", " ", "\[Tau]"}]}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "\[Tau]"}], "]"}]}], "+", 
     RowBox[{"4536", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"5", " ", "\[Tau]", " ", 
         RowBox[{"Log", "[", "5", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"5", " ", "\[Tau]"}]}], ")"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "+", 
           RowBox[{"5", " ", "\[Tau]"}]}], "]"}]}]}], ")"}]}]}], 
    RowBox[{"28125", " ", "\[Tau]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Tau]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"5", " ", "\[Tau]"}]}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Tau]", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767502329652131*^9, 3.767502370289474*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"535bf63d-eb80-479b-ad0c-0c524ae665b3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.767502347806649*^9, 3.76750237167759*^9}, 
   3.7678471604032393`*^9},
 CellLabel->
  "Out[396]=",ExpressionUUID->"ba756c55-13b2-4c0c-96e1-7143b172f882"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"aaa", "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hh", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "treeresult", "+", "logedata1", "+", "logedata2", "+", 
                  "logedata33", "+", "loge4massbox"}], ")"}], "//", 
                "todoubleab"}], "//", "todmatrix"}], "//", "fuse"}], ")"}], "/.", 
            RowBox[{"dabne", "[", 
             RowBox[{"{", 
              RowBox[{"5", ",", "3"}], "}"}], "]"}]}], "/.", 
           RowBox[{"DmatrixEval3", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "3"}], "]"}]}], 
          "//", "fullabB"}], ")"}], "//", "neab1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"FirstCase", "[", 
             RowBox[{"#", ",", "_log"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"List", "@@", 
             RowBox[{"Collect", "[", 
              RowBox[{"hh", ",", "_log"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", 
              RowBox[{"Collect", "[", 
               RowBox[{"hh", ",", "_log"}], "]"}]}], ")"}], "/.", 
            RowBox[{
             RowBox[{"log", "[", "_", "]"}], "\[Rule]", "1"}]}], ",", 
           RowBox[{"e", "\[Rule]", "0"}]}], "]"}]}], "]"}], "//", 
       "Simplify"}], ")"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7670663846197877`*^9, 3.7670664006650095`*^9}, {
  3.767066441669154*^9, 3.7670664881448174`*^9}, {3.7670667584780827`*^9, 
  3.767066758826457*^9}, {3.767070571695351*^9, 3.7670705904580793`*^9}, {
  3.7670707084327593`*^9, 3.767070779262597*^9}, {3.767070933506209*^9, 
  3.767070953447939*^9}, {3.767502414122552*^9, 3.7675024160296164`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"843d633c-6610-4305-a70b-010b7df59461"],

Cell[BoxData[{
 RowBox[{"randomPositiveZs", "[", "20", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neab1", "[", "exp_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"exp", "/.", "\[VeryThinSpace]", "shifexp"}], "//.", 
    "\[VeryThinSpace]", "capexpand"}], "/.", "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
    RowBox[{"Det", "[", 
     RowBox[{"Zs", "\[LeftDoubleBracket]", 
      RowBox[{"{", "x", "}"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.767066227584905*^9, 3.767066228153845*^9}, {
  3.7670662792836814`*^9, 3.7670663150313187`*^9}, {3.767072568368286*^9, 
  3.7670725828257*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"fc035b73-6d61-45f7-a774-76a1ede485a3"]
},
WindowSize->{1447, 764},
WindowMargins->{{-13, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670828\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 77828, 2047, 4046, "Input",ExpressionUUID->"1eb69f41-f261-4b3f-bc73-68e8910216c5",
 InitializationCell->True],
Cell[78411, 2071, 10248, 215, 363, "Print",ExpressionUUID->"287eaf14-3d4b-4805-ad48-1fff1686a70e"]
}, Open  ]],
Cell[88674, 2289, 4448, 142, 672, "Input",ExpressionUUID->"7d83c21e-99eb-4f02-a0db-54ee4c61b216",
 InitializationCell->True],
Cell[93125, 2433, 5743, 157, 250, "Input",ExpressionUUID->"a1377f54-a0ae-4592-a14d-97dc9cbdf068"],
Cell[98871, 2592, 2942, 76, 138, "Input",ExpressionUUID->"62742f98-fdb5-4681-89c6-98fb8c6798ba"],
Cell[101816, 2670, 3140, 83, 158, "Input",ExpressionUUID->"64f84a89-9109-4fb4-afaf-6d7467ca0621"],
Cell[104959, 2755, 17848, 468, 602, "Input",ExpressionUUID->"83c8cdcd-379f-4944-bc3f-06b8dddf62a2"],
Cell[122810, 3225, 5663, 141, 385, "Input",ExpressionUUID->"44111d37-6cae-4b45-888c-91fb498a0752"],
Cell[CellGroupData[{
Cell[128498, 3370, 4864, 122, 385, "Input",ExpressionUUID->"a6d313c0-0fc9-4230-ad91-affb4365d7ae"],
Cell[133365, 3494, 337, 7, 107, "Output",ExpressionUUID->"98677dde-0a9e-4f4e-a294-a1e2628bf659"]
}, Open  ]],
Cell[133717, 3504, 1536, 34, 71, "Input",ExpressionUUID->"0c80907b-685f-4f34-b643-7f5b740cbe66"],
Cell[135256, 3540, 8375, 212, 784, "Input",ExpressionUUID->"f3872656-b5a5-426c-8a5b-e263cc82f98d"],
Cell[143634, 3754, 2570, 67, 214, "Input",ExpressionUUID->"8b1a656e-5f13-4d39-930e-e5a2ef3205fa"],
Cell[146207, 3823, 6307, 163, 670, "Input",ExpressionUUID->"c66c8e56-93bf-4443-9fd1-0de0fe13b03b"],
Cell[152517, 3988, 15068, 377, 1050, "Input",ExpressionUUID->"2a1e7ffc-7e32-40cf-a8b2-5962b056a7dc"],
Cell[167588, 4367, 1626, 44, 157, "Input",ExpressionUUID->"8c1c76f0-618f-4ce5-bb98-38b8cb1d69fb"],
Cell[CellGroupData[{
Cell[169239, 4415, 12997, 327, 990, "Input",ExpressionUUID->"c3633c37-c1d6-4cfc-a56e-7903243ac297"],
Cell[182239, 4744, 319, 7, 128, "Output",ExpressionUUID->"7ebb5da6-d4f7-4526-a0d2-c8e563a14629"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182595, 4756, 847, 25, 71, "Input",ExpressionUUID->"e896a891-4c8b-4f28-b33b-a8d15546aace"],
Cell[183445, 4783, 13125, 338, 518, "Output",ExpressionUUID->"eec8c9ad-9ef2-4010-ad24-d21b111c8083"]
}, Open  ]],
Cell[196585, 5124, 8760, 219, 984, "Input",ExpressionUUID->"08fc5c82-d3b5-4359-acaf-d12eed3aa6a0"],
Cell[CellGroupData[{
Cell[205370, 5347, 7390, 180, 699, "Input",ExpressionUUID->"6470cc11-dc98-49fe-be38-9e2690478d9b"],
Cell[212763, 5529, 630, 14, 107, "Output",ExpressionUUID->"3f6aee25-ddd8-47c3-9c93-393f1c810a7d"]
}, Open  ]],
Cell[213408, 5546, 2898, 87, 499, "Input",ExpressionUUID->"701aec9d-f05e-422b-9eeb-96d5e2b99b55"],
Cell[CellGroupData[{
Cell[216331, 5637, 353, 9, 99, "Input",ExpressionUUID->"7af2fa07-856a-4dc9-84c1-283fb83ea307"],
Cell[216687, 5648, 3568, 93, 298, "Output",ExpressionUUID->"82b6ba99-9138-4d58-a7f7-86b2b1220e0b"]
}, Open  ]],
Cell[220270, 5744, 6242, 167, 784, "Input",ExpressionUUID->"1560d60f-e4ff-4dfc-b0ee-1004f46ba8b4"],
Cell[226515, 5913, 1065, 28, 157, "Input",ExpressionUUID->"720deb0e-add7-42f7-8399-828c1230600e"],
Cell[CellGroupData[{
Cell[227605, 5945, 323, 7, 99, "Input",ExpressionUUID->"fb155c0b-222c-4a19-8b56-57389565fd79"],
Cell[227931, 5954, 203, 4, 107, "Output",ExpressionUUID->"5d4f1661-8752-4cbf-ae2f-e7b76929017d"]
}, Open  ]],
Cell[228149, 5961, 9730, 268, 748, "Input",ExpressionUUID->"11fbb98d-a811-48fa-83bb-4bccedd05c66"],
Cell[CellGroupData[{
Cell[237904, 6233, 2898, 62, 186, "Input",ExpressionUUID->"1f23a438-d20f-451b-9aad-bb35f5a6228b"],
Cell[240805, 6297, 1469, 42, 134, "Output",ExpressionUUID->"3ff6989e-775f-412b-8198-82f5db11e739"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242311, 6344, 1500, 43, 113, "Input",ExpressionUUID->"535bf63d-eb80-479b-ad0c-0c524ae665b3"],
Cell[243814, 6389, 204, 4, 107, "Output",ExpressionUUID->"ba756c55-13b2-4c0c-96e1-7143b172f882"]
}, Open  ]],
Cell[244033, 6396, 2498, 65, 186, "Input",ExpressionUUID->"843d633c-6610-4305-a70b-010b7df59461"],
Cell[246534, 6463, 770, 18, 157, "Input",ExpressionUUID->"fc035b73-6d61-45f7-a774-76a1ede485a3"]
}
]
*)

