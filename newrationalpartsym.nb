(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    242914,       6177]
NotebookOptionsPosition[    234213,       6053]
NotebookOutlinePosition[    234581,       6069]
CellTagsIndexPosition[    234538,       6066]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "pre", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "+", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"<<", "PolyLogTools`"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7775532682827644`*^9, 3.777553285244376*^9}, {
  3.7775533296408997`*^9, 3.777553346446686*^9}, {3.7775534194609365`*^9, 
  3.777553420197796*^9}, {3.777553460516944*^9, 3.777553460651885*^9}, {
  3.777557751679666*^9, 3.7775577557814293`*^9}, {3.77890184170251*^9, 
  3.77890184242092*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"fc7f3f57-40d1-4ffe-9e20-9017892b93bc"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(****** PolyLogTools \"\>", 
   "\[InvisibleSpace]", "\<\"1.3.1\"\>", 
   "\[InvisibleSpace]", "\<\" ******)\"\>"}],
  SequenceForm["(****** PolyLogTools ", "1.3.1", " ******)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7775534317023525`*^9, {3.777558047616954*^9, 3.7775580592492085`*^9}, 
   3.7776063168931804`*^9, 3.777606371289198*^9, 3.7776064124196386`*^9, 
   3.777606453758315*^9, 3.7776129447662764`*^9, 3.777635945239413*^9, 
   3.777641123760209*^9, 3.777688819166765*^9, 3.777709556343478*^9, 
   3.7777095924571304`*^9, 3.7780523144733715`*^9, {3.7780531153952045`*^9, 
   3.778053123613944*^9}, 3.77805534161397*^9, 3.7780568363485575`*^9, 
   3.778070793817051*^9, 3.778329893516901*^9, 3.7783374367668*^9, 
   3.778378858454339*^9, 3.7783827164077883`*^9, 3.7783885285015993`*^9, 
   3.7783991510170317`*^9, 3.7784632156885977`*^9, {3.778476311727728*^9, 
   3.7784763216352787`*^9}, {3.7784771318737016`*^9, 3.778477140895338*^9}, 
   3.778637687422742*^9, 3.7786497738217173`*^9, {3.778821178829787*^9, 
   3.7788211888923445`*^9}, 3.7789018484162292`*^9, 3.7790109541480455`*^9, 
   3.779013093304181*^9, {3.779102204569968*^9, 3.779102214350936*^9}, {
   3.779108272679519*^9, 3.779108280366962*^9}},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"e3e64a0e-8996-4cfa-989d-f9f31969f208"],

Cell[BoxData["\<\"    Authors: Claude Duhr, Falko Dulat\"\>"], "Print",
 CellChangeTimes->{
  3.7775534317023525`*^9, {3.777558047616954*^9, 3.7775580592492085`*^9}, 
   3.7776063168931804`*^9, 3.777606371289198*^9, 3.7776064124196386`*^9, 
   3.777606453758315*^9, 3.7776129447662764`*^9, 3.777635945239413*^9, 
   3.777641123760209*^9, 3.777688819166765*^9, 3.777709556343478*^9, 
   3.7777095924571304`*^9, 3.7780523144733715`*^9, {3.7780531153952045`*^9, 
   3.778053123613944*^9}, 3.77805534161397*^9, 3.7780568363485575`*^9, 
   3.778070793817051*^9, 3.778329893516901*^9, 3.7783374367668*^9, 
   3.778378858454339*^9, 3.7783827164077883`*^9, 3.7783885285015993`*^9, 
   3.7783991510170317`*^9, 3.7784632156885977`*^9, {3.778476311727728*^9, 
   3.7784763216352787`*^9}, {3.7784771318737016`*^9, 3.778477140895338*^9}, 
   3.778637687422742*^9, 3.7786497738217173`*^9, {3.778821178829787*^9, 
   3.7788211888923445`*^9}, 3.7789018484162292`*^9, 3.7790109541480455`*^9, 
   3.779013093304181*^9, {3.779102204569968*^9, 3.779102214350936*^9}, {
   3.779108272679519*^9, 3.779108280366962*^9}},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"440a07c1-f6a3-40cc-a931-f93f0edea4de"],

Cell[BoxData["\<\"    Emails: claude.duhr@cern.ch, dulatf@slac.stanford.edu\"\
\>"], "Print",
 CellChangeTimes->{
  3.7775534317023525`*^9, {3.777558047616954*^9, 3.7775580592492085`*^9}, 
   3.7776063168931804`*^9, 3.777606371289198*^9, 3.7776064124196386`*^9, 
   3.777606453758315*^9, 3.7776129447662764`*^9, 3.777635945239413*^9, 
   3.777641123760209*^9, 3.777688819166765*^9, 3.777709556343478*^9, 
   3.7777095924571304`*^9, 3.7780523144733715`*^9, {3.7780531153952045`*^9, 
   3.778053123613944*^9}, 3.77805534161397*^9, 3.7780568363485575`*^9, 
   3.778070793817051*^9, 3.778329893516901*^9, 3.7783374367668*^9, 
   3.778378858454339*^9, 3.7783827164077883`*^9, 3.7783885285015993`*^9, 
   3.7783991510170317`*^9, 3.7784632156885977`*^9, {3.778476311727728*^9, 
   3.7784763216352787`*^9}, {3.7784771318737016`*^9, 3.778477140895338*^9}, 
   3.778637687422742*^9, 3.7786497738217173`*^9, {3.778821178829787*^9, 
   3.7788211888923445`*^9}, 3.7789018484162292`*^9, 3.7790109541480455`*^9, 
   3.779013093304181*^9, {3.779102204569968*^9, 3.779102214350936*^9}, {
   3.779108272679519*^9, 3.779108280366962*^9}},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"6900b06f-feeb-4730-999a-2f9ce9a25f6f"],

Cell[BoxData["\<\"    PolyLogTools uses the implementation of the PSLQ \
algorithm by P. Bertok \
(http://library.wolfram.com/infocenter/MathSource/4263/)\"\>"], "Print",
 CellChangeTimes->{
  3.7775534317023525`*^9, {3.777558047616954*^9, 3.7775580592492085`*^9}, 
   3.7776063168931804`*^9, 3.777606371289198*^9, 3.7776064124196386`*^9, 
   3.777606453758315*^9, 3.7776129447662764`*^9, 3.777635945239413*^9, 
   3.777641123760209*^9, 3.777688819166765*^9, 3.777709556343478*^9, 
   3.7777095924571304`*^9, 3.7780523144733715`*^9, {3.7780531153952045`*^9, 
   3.778053123613944*^9}, 3.77805534161397*^9, 3.7780568363485575`*^9, 
   3.778070793817051*^9, 3.778329893516901*^9, 3.7783374367668*^9, 
   3.778378858454339*^9, 3.7783827164077883`*^9, 3.7783885285015993`*^9, 
   3.7783991510170317`*^9, 3.7784632156885977`*^9, {3.778476311727728*^9, 
   3.7784763216352787`*^9}, {3.7784771318737016`*^9, 3.778477140895338*^9}, 
   3.778637687422742*^9, 3.7786497738217173`*^9, {3.778821178829787*^9, 
   3.7788211888923445`*^9}, 3.7789018484162292`*^9, 3.7790109541480455`*^9, 
   3.779013093304181*^9, {3.779102204569968*^9, 3.779102214350936*^9}, {
   3.779108272679519*^9, 3.7791082803825865`*^9}},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"1597d80e-8c36-4535-9b64-6ef0b522a341"],

Cell[BoxData["\<\"    Modified By Buwai Lee, for the support of ginsh in WSL \
on windows 10. Please make sure that GiNaC & sed & gcc are installed.\"\>"], \
"Print",
 CellChangeTimes->{
  3.7775534317023525`*^9, {3.777558047616954*^9, 3.7775580592492085`*^9}, 
   3.7776063168931804`*^9, 3.777606371289198*^9, 3.7776064124196386`*^9, 
   3.777606453758315*^9, 3.7776129447662764`*^9, 3.777635945239413*^9, 
   3.777641123760209*^9, 3.777688819166765*^9, 3.777709556343478*^9, 
   3.7777095924571304`*^9, 3.7780523144733715`*^9, {3.7780531153952045`*^9, 
   3.778053123613944*^9}, 3.77805534161397*^9, 3.7780568363485575`*^9, 
   3.778070793817051*^9, 3.778329893516901*^9, 3.7783374367668*^9, 
   3.778378858454339*^9, 3.7783827164077883`*^9, 3.7783885285015993`*^9, 
   3.7783991510170317`*^9, 3.7784632156885977`*^9, {3.778476311727728*^9, 
   3.7784763216352787`*^9}, {3.7784771318737016`*^9, 3.778477140895338*^9}, 
   3.778637687422742*^9, 3.7786497738217173`*^9, {3.778821178829787*^9, 
   3.7788211888923445`*^9}, 3.7789018484162292`*^9, 3.7790109541480455`*^9, 
   3.779013093304181*^9, {3.779102204569968*^9, 3.779102214350936*^9}, {
   3.779108272679519*^9, 3.7791082803825865`*^9}},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"0dd3a82f-e44a-48de-868b-d6771b4d10ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"test", " ", "ginsh"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Ginsh", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[Pi]", "2"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", "u", "]"}], " ", 
       RowBox[{"Log", "[", "v", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "del6", "+", "u", "-", "v"}], ")"}]}], "]"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "del6", "-", "u", "+", "v"}], ")"}]}], "]"}]}], 
      "+", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "del6", "+", "u", "-", "v"}], ")"}]}]}], "]"}], 
      "+", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "del6", "-", "u", "+", "v"}], ")"}]}]}], "]"}]}], 
     "/.", 
     RowBox[{"del6", "->", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "u", "-", "v"}], ")"}], "^", "2"}], "-", 
        RowBox[{"4", "u", "*", "v"}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", "0.1"}], ",", 
      RowBox[{"v", "\[Rule]", "0.23"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7776082592025146`*^9, 3.777608263937038*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"79f40ed2-03df-4afd-82e1-9bb0cd59327a"],

Cell[BoxData["2.16212312544219832054475828171981748253`38.33488042189183"], \
"Output",
 CellChangeTimes->{3.777558071848339*^9, 3.777606478494148*^9, 
  3.777709642918454*^9, 3.778053128988945*^9, 3.7780553500598435`*^9, 
  3.7780708058795557`*^9, 3.7783299036886206`*^9, 3.7783788685520816`*^9, 
  3.7783827261170263`*^9, 3.778388537844944*^9, 3.7783991566891017`*^9, 
  3.7784632249229946`*^9, 3.778901857907633*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"3263128d-a4f7-4fb3-a6f3-5739111b9e88"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"capexpand", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"x___", ",", " ", 
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
         RowBox[{"{", "c__", "}"}]}], "]"}], ",", " ", "y___"}], "]"}], " ", ":>",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"b", ",", " ", "c"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"c", ",", " ", "a"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"shifexp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"shift", "[", 
        RowBox[{"y_", ",", "z_"}], "]"}], ",", "w___"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"x", ",", 
        RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "w"}], "]"}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"ab", "[", 
        RowBox[{"x", ",", 
         RowBox[{"y", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "w"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ordercup", "[", "exp_", "]"}], ":=", 
   RowBox[{"SortBy", "[", 
    RowBox[{"exp", ",", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], ",", "1.5", ",", 
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "shift"}], ",", "1.4", ",", 
        "True", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", "+", "i"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"neab1", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Det", "[", 
      RowBox[{"mom1", "[", 
       RowBox[{"[", 
        RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortR", "=", 
   RowBox[{"{", 
    RowBox[{"i_R", ":>", 
     RowBox[{
      RowBox[{"ordercup", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], "/", 
       RowBox[{"Signature", "[", 
        RowBox[{"ordercup", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortab", "=", 
   RowBox[{"{", 
    RowBox[{"i_ab", "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"ordercup", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], "/", 
       RowBox[{"Signature", "[", 
        RowBox[{"ordercup", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", "+", "i"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"randomPositiveZs", "[", "n_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Zs", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "mat", "}"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"hatted", "=", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"mat", "\[LeftDoubleBracket]", 
                    RowBox[{"#1", ";;", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], 
                    ",", "1"}], "]"}], "&"}], ")"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"2", ",", 
                   RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"PadRight", "[", 
                   RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "mat", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", "1"}], 
                 "]"}]}], "]"}]}], ",", 
             RowBox[{"newRow", "=", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "mat", "]"}], "}"}]}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{"newRow", " ", "hatted"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "+", "8"}], ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], ";", 
    RowBox[{"Zs", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Zs", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}], ".", 
        RowBox[{"Transpose", "[", "Zs", "]"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", 
       RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   ")"}]}], "\n", 
 RowBox[{
  RowBox[{"randomPositiveZs", "[", "20", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"neabp", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", "\[VeryThinSpace]", "shifexp"}], "//.", 
     "\[VeryThinSpace]", "capexpand"}], "/.", "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Det", "[", 
      RowBox[{"Zs", "\[LeftDoubleBracket]", 
       RowBox[{"{", "x", "}"}], "\[RightDoubleBracket]"}], "]"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"order", "[", 
    RowBox[{"exprn_", ",", 
     RowBox[{"option_:", "1"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"option", "\[Equal]", "0"}], ",", 
     RowBox[{"exprn", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Signature", "[", 
          RowBox[{"{", "x", "}"}], "]"}], " ", 
         RowBox[{"ab", "@@", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", "x", "}"}], "]"}]}]}]}], "}"}]}], ",", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nGuess", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"List", ",", 
                RowBox[{"Cases", "[", 
                 RowBox[{"exprn", ",", "_ab", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
         ",", "consec", ",", "xLike"}], "}"}], ",", 
       RowBox[{
        RowBox[{"consec", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Range", "[", "nGuess", "]"}], ",", "2", ",", "1", ",", 
           "1"}], "]"}]}], ";", 
        RowBox[{"xLike", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Range", "[", 
                 RowBox[{"#2", ",", "#3"}], "]"}], "]"}], ">", 
               RowBox[{"Length", "[", 
                RowBox[{"Range", "[", 
                 RowBox[{"#4", ",", 
                  RowBox[{"#1", "+", "nGuess"}]}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"#3", ",", "#4", ",", "#1", ",", "#2"}], "}"}], ",", 
              RowBox[{"{", "##1", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Flatten", "/@", 
              RowBox[{"Subsets", "[", 
               RowBox[{"consec", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"#1", "\[Intersection]", "#1"}], "]"}], "\[Equal]", 
               "4"}], "&"}]}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
        RowBox[{"exprn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "x", "}"}], "]"}], "\[Equal]", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#1", "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", "x", "}"}], "]"}]}]}]}], "]"}], "&"}], ")"}],
               "[", 
              RowBox[{"Select", "[", 
               RowBox[{"consec", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"{", "x", "}"}], "\[Intersection]", "#1"}], "]"}],
                   "\[Equal]", "2"}], "&"}], ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#1", "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xLikeLines", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"consec", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"#1", "\[Intersection]", 
                    RowBox[{"{", "x", "}"}]}], "]"}], "\[Equal]", "2"}], 
                    "&"}]}], "]"}]}], ",", "boundaries"}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "xLikeLines", "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", "x", "}"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"boundaries", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"{", "x", "}"}], ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "nGuess", ",", 
                    "0"}], "]"}], "+", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "nGuess", 
                    ",", "0"}], "]"}], "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ">", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "nGuess", ",", 
                    "0"}], "]"}], "+", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "nGuess", 
                    ",", "0"}], "]"}], "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"boundaries", "=", 
                    RowBox[{"Reverse", "[", "boundaries", "]"}]}], ";"}]}], 
                    "]"}], ";", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Signature", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"boundaries", ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], " ", 
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", "x", "}"}], "]"}], " ", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"RotateLeft", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"boundaries", ",", 
                    RowBox[{"xLikeLines", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "[", 
              RowBox[{"Select", "[", 
               RowBox[{"xLike", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"#1", "\[Intersection]", 
                    RowBox[{"{", "x", "}"}]}], "]"}], "\[Equal]", "4"}], 
                 "&"}]}], "]"}], "]"}]}], "]"}]}], "}"}]}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"twistorSchouten", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a___", ",", "x_", ",", "b___", ",", "y_", ",", "c___"}], 
           "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"d___", ",", "x_", ",", "e___", ",", "y_", ",", "f___"}], 
           "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "x", ",", "b", ",", "y", ",", "c"}], "}"}], 
           "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"d", ",", "x", ",", "e", ",", "y", ",", "f"}], "}"}], 
           "]"}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}]}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a___", ",", "x_", ",", "b___", ",", "y_", ",", "c___"}], 
           "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"d___", ",", "y_", ",", "e___", ",", "x_", ",", "f___"}], 
           "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "x", ",", "b", ",", "y", ",", "c"}], "}"}], 
           "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}], "]"}], " ", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"d", ",", "y", ",", "e", ",", "x", ",", "f"}], "}"}], 
           "]"}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], "}"}], 
            "]"}]}], " ", 
          RowBox[{"ab", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"d", ",", "e", ",", "f"}], "}"}], "]"}]}], "}"}], 
            "]"}]}]}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "d_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "c_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "d_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ab", "[", 
            RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}]}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "b_", ",", "c_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ab", "[", 
            RowBox[{"x_", ",", "y_", ",", "a_", ",", "b_"}], "]"}]}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "c_", ",", "d_"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x_", ",", "y_", ",", "d_", ",", "b_"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", "y", ",", "c", ",", "b"}], "]"}]}]}]}], "}"}]}], 
    "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"twistorSimplify", "[", 
    RowBox[{"exprn_", ",", 
     RowBox[{"orderQ_:", "0"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"exprn", ",", 
        RowBox[{"ab", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ",", "\[Infinity]"}], "]"}], ">", 
      "0"}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"order", "[", "exprn", "]"}], "/.", 
       RowBox[{"Apply", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", 
              RowBox[{"twistorSchouten", "[", "#1", "]"}]}], "}"}], "&"}], 
           ")"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"exprn", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ab", "[", "x__", "]"}], " ", 
               RowBox[{"ab", "[", "y__", "]"}]}], "-", 
              RowBox[{
               RowBox[{"ab", "[", "z__", "]"}], " ", 
               RowBox[{"ab", "[", "w__", "]"}]}]}], "|", 
             RowBox[{
              RowBox[{
               RowBox[{"ab", "[", "x__", "]"}], " ", 
               RowBox[{"ab", "[", "y__", "]"}]}], "+", 
              RowBox[{
               RowBox[{"ab", "[", "z__", "]"}], " ", 
               RowBox[{"ab", "[", "w__", "]"}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"order", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"orderQ", "\[Equal]", "1"}], ",", 
           RowBox[{"order", "[", 
            RowBox[{
             RowBox[{"FullSimplify", "[", 
              RowBox[{
               RowBox[{"order", "[", 
                RowBox[{"exprn", ",", "0"}], "]"}], ",", 
               RowBox[{"TransformationFunctions", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "twistorSchouten"}], "}"}]}]}], 
              "]"}], ",", "1"}], "]"}], ",", "exprn"}], "]"}], ",", 
         RowBox[{"TransformationFunctions", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "twistorSchouten"}], "}"}]}]}], "]"}], 
       ",", "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cap1exp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"cap1", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b_", ",", "c_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d_", ",", "e_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"f_", ",", "g_"}], "}"}]}], "]"}]}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "]"}], 
       RowBox[{"ab", "[", 
        RowBox[{"a", ",", "c", ",", "f", ",", "g"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"a", ",", "b", ",", "f", ",", "g"}], "]"}], 
       RowBox[{"ab", "[", 
        RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tocaps", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"ab", "[", "a__", "]"}]}], 
       RowBox[{"ab", "[", "b__", "]"}]}], "+", 
      RowBox[{
       RowBox[{"ab", "[", "c__", "]"}], 
       RowBox[{"ab", "[", "d__", "]"}]}]}], "\[RuleDelayed]", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg2", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", "d", "}"}]}], "]"}]}], ",", 
         RowBox[{"hh", "=", 
          RowBox[{"Tally", "/@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Outer", "[", 
                 RowBox[{"List", ",", 
                  RowBox[{"{", "a", "}"}], ",", 
                  RowBox[{"{", "b", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"SubsetQ", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "#"}], "]"}], "||", 
                  RowBox[{"SubsetQ", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "#"}], "]"}]}], ")"}]}], 
               "&"}]}], "]"}]}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"neab1", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"ab", "[", "a", "]"}]}], 
                   RowBox[{"ab", "[", "b", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"ab", "[", "c", "]"}], 
                   RowBox[{"ab", "[", "d", "]"}]}]}], ")"}]}], ")"}], "/.", 
              "cap1exp"}], "]"}], "===", "0"}], ",", "#", ",", 
           RowBox[{"-", "#"}]}], "]"}], "&"}], "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"deg2", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{
               RowBox[{"cap", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], "&"}], "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "\[Equal]", "1"}], 
                    "&"}]}], "]"}]}], ",", 
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "\[Equal]", "3"}], 
                    "&"}]}], "]"}]}]}], "}"}], "&"}], "/@", "hh"}], ",", 
              "1"}], "]"}]}], ")"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "deg2", "]"}], "===", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"First", "[", "deg2", "]"}], ",", 
                RowBox[{"cap1", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], 
             "@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"First", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "\[Equal]", "1"}], 
                    "&"}]}], "]"}]}], ",", 
                    RowBox[{"First", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "\[Equal]", "2"}], 
                    "&"}]}], "]"}]}]}], "}"}], "&"}], "/@", "hh"}], ")"}], 
               ",", "1"}], "]"}]}], ",", 
            RowBox[{"twistorSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"ab", "[", "a", "]"}]}], 
               RowBox[{"ab", "[", "b", "]"}]}], "+", 
              RowBox[{
               RowBox[{"ab", "[", "c", "]"}], 
               RowBox[{"ab", "[", "d", "]"}]}]}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortcap1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"cap1", "[", 
        RowBox[{"b_", ",", "c_", ",", "d_"}], "]"}]}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"a", ",", 
        RowBox[{"cap1", "@@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sort", "[", "b", "]"}], ",", 
             RowBox[{"Sort", "[", "c", "]"}], ",", 
             RowBox[{"Sort", "[", "d", "]"}]}], "}"}], ",", "First"}], 
          "]"}]}]}], "]"}], 
      RowBox[{"Signature", "[", "b", "]"}], 
      RowBox[{"Signature", "[", "c", "]"}], 
      RowBox[{"Signature", "[", "d", "]"}], 
      RowBox[{"Signature", "[", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sort", "[", "b", "]"}], ",", 
           RowBox[{"Sort", "[", "c", "]"}], ",", 
           RowBox[{"Sort", "[", "d", "]"}]}], "}"}], ",", "First"}], "]"}], 
       "]"}], 
      RowBox[{"Signature", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sort", "[", "b", "]"}], ",", 
         RowBox[{"Sort", "[", "c", "]"}], ",", 
         RowBox[{"Sort", "[", "d", "]"}]}], "}"}], "]"}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"sixR", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_", ",", "f_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "f"}], "]"}], "+", 
   RowBox[{"R", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "f", ",", "e"}], "]"}], "+", 
   RowBox[{"R", "[", 
    RowBox[{"a", ",", "b", ",", "d", ",", "e", ",", "f"}], "]"}], "+", 
   RowBox[{"R", "[", 
    RowBox[{"a", ",", "c", ",", "d", ",", "f", ",", "e"}], "]"}], "+", 
   RowBox[{"R", "[", 
    RowBox[{"b", ",", "c", ",", "d", ",", "e", ",", "f"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tocap2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"z___", ",", 
       RowBox[{"cap", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", "w___"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"neab", "[", 
            RowBox[{"#", "/.", "expandcap2"}], "]"}], "/", 
           RowBox[{"neab", "[", 
            RowBox[{"ab", "[", 
             RowBox[{"z", ",", 
              RowBox[{"cap", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", "w"}], "]"}], "]"}]}], 
          ")"}], "#"}], "&"}], "[", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Sort", "[", "x", "]"}], ")"}]}], ",", 
         RowBox[{"cap2", "@@", 
          RowBox[{"(", 
           RowBox[{"SortBy", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sort", "[", "y", "]"}], ",", 
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "w"}], "}"}], "]"}]}], "}"}], ",", 
             "First"}], "]"}], ")"}]}]}], "]"}], "]"}], ")"}]}], "}"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.7775531968387003`*^9, 3.777553222030857*^9}, {
   3.777553253822054*^9, 3.7775532583929625`*^9}, {3.777606846184349*^9, 
   3.777606847498816*^9}, {3.777606905411373*^9, 3.7776069307827115`*^9}, {
   3.777611985020844*^9, 3.777611985446699*^9}, {3.7776122134359894`*^9, 
   3.7776122188817396`*^9}, 3.7776123149898396`*^9, 3.777612496751523*^9, 
   3.777612914339672*^9, {3.7776131787286053`*^9, 3.7776131789798875`*^9}, {
   3.778056417676592*^9, 3.7780564184420767`*^9}, {3.7780565713643208`*^9, 
   3.77805657931767*^9}, {3.778056829614346*^9, 3.778056829911721*^9}, {
   3.7780683639268847`*^9, 3.7780683649892845`*^9}, {3.778832956126677*^9, 
   3.778832956486583*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"18a4c61e-41a1-4a4d-a058-b41b9bcf268e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "redRs", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reduceR1", "[", 
     RowBox[{"Rinv1_", ",", "Rinv2_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{"Rinv1", ",", "\n", "_Plus", ",", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"reduceR1", "[", 
           RowBox[{"#1", ",", "Rinv2"}], "]"}], "&"}], ")"}], "/@", 
        RowBox[{"List", "@@", "Rinv1"}]}], "]"}], ",", "\n", "_Times", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Rinv1", " ", 
            RowBox[{"reduceR1", "[", 
             RowBox[{"#1", ",", "Rinv2"}], "]"}]}], ")"}], "/", "#1"}], "&"}],
         ")"}], "[", 
       RowBox[{"FirstCase", "[", 
        RowBox[{"Rinv1", ",", "_R"}], "]"}], "]"}], ",", "\n", "_R", ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"plist1", "=", 
           RowBox[{"List", "@@", "Rinv1"}]}], ",", 
          RowBox[{"plist2", "=", 
           RowBox[{"List", "@@", "Rinv2"}]}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"foo", "=", 
            RowBox[{"Sort", "[", 
             RowBox[{"plist1", "\[Intersection]", "plist2"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"Complement", "[", 
                RowBox[{"plist1", ",", "foo"}], "]"}]}], ",", 
              RowBox[{"j", "=", 
               RowBox[{"Complement", "[", 
                RowBox[{"plist2", ",", "foo"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"SubsetQ", "[", 
                RowBox[{"foo", ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", 
                   RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ",", "Rinv1", 
              ",", 
              RowBox[{
               RowBox[{"Length", "[", "foo", "]"}], "===", "4"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Signature", "[", "plist1", "]"}], 
                 RowBox[{"Signature", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], "  ", 
                 RowBox[{
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"R", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"Length", "[", "foo", "]"}], "===", "3"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Signature", "[", "plist1", "]"}], "  ", 
                 RowBox[{"Signature", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ab", "[", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"i", ",", "foo"}], "]"}]}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"foo", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "i"}], 
                    "]"}]}], " ", 
                   RowBox[{"ab", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{"i", ",", "foo"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}], " ", 
                 RowBox[{"R", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"cap", "[", 
                    RowBox[{"i", ",", "foo"}], "]"}]}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ab", "[", 
                   RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "^", "3"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                 RowBox[{"ab", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{"foo", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"foo", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"Length", "[", "foo", "]"}], "===", "2"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Signature", "[", "plist1", "]"}], " ", 
                 RowBox[{"Signature", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"i", ",", "foo"}], "]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ab", "[", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "n", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], " ", 
                   RowBox[{"ab", "[", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{"foo", ",", "i"}], "]"}]}], "]"}], " ", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], " ", 
                   RowBox[{"ab", "[", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "n", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "+", "1"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"j", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "n"}], "]"}], "/.", 
                   " ", 
                   RowBox[{
                    RowBox[{"cap", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
                    RowBox[{"cap", "[", 
                    RowBox[{
                    RowBox[{"Sort", "[", "x", "]"}], ",", 
                    RowBox[{"Sort", "[", "y", "]"}]}], "]"}]}]}], ")"}]}], 
                ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ab", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ")"}], "^", "2"}], 
                 " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"i", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "n", ",", 
                   RowBox[{"n", "+", "1"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "[", 
                  RowBox[{"n", ",", 
                   RowBox[{"n", "+", "1"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"ab", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}], ",", "i"}], "]"}]}]}], 
                ")"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "\n", "_", 
      ",", "Rinv1"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prefreduceR", "[", "Rinv_", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ppp", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"StringCount", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", "\"\<cap\>\""}], 
               "]"}], "&"}]}], "]"}], "&"}], "@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"List", "@@", "Rinv"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], ")"}], "&&", 
              RowBox[{"IntersectingQ", "[", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"List", "@@", "#"}], "]"}], ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"List", "@@", "Rinv"}], ",", 
                  RowBox[{"{", "#", "}"}]}], "]"}]}], "]"}]}], "&"}]}], 
           "]"}]}]}], "}"}], ",", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "ppp"}], "==", "0"}], ",", "Rinv", ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pp", "=", 
             RowBox[{"First", "@", "ppp"}]}], "}"}], ",", "\n", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"qq", "=", " ", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"List", "@@", "Rinv"}], ",", "pp"}], "]"}]}], "}"}], 
             ",", "\n", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"bbbb1", "=", 
                  RowBox[{"First", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", "qq"}], "]"}], "]"}]}],
                  ",", 
                 RowBox[{"bbbb2", "=", 
                  RowBox[{"First", "@", 
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "pp"}], ",", "qq"}], "]"}]}], 
                    "]"}]}]}]}], "}"}], ",", "\n", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb1", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "Rinv"}], ",", 
                    RowBox[{"pp", "|", "bbbb1"}]}], "]"}]}], "]"}], ")"}]}], 
                    ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb2", "}"}], ",", 
                    RowBox[{"Last", "@", "pp"}]}], "]"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "pp"}], ",", 
                    RowBox[{"{", "bbbb1", "}"}]}], "]"}], ")"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"ab", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "bbbb2", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "Rinv"}], ",", 
                    RowBox[{"pp", "|", "bbbb1"}]}], "]"}]}], "]"}], ")"}]}], 
                    ")"}]}], ")"}]}]}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}]}], " ", "Rinv"}], "/.", 
                RowBox[{"pp", "->", "bbbb2"}]}]}], "]"}]}], "\n", "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"freduceR", "[", "$Rinv_", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Rinv", "=", 
         RowBox[{"Expand", "[", "$Rinv", "]"}]}], "}"}], ",", 
       RowBox[{"Switch", "[", 
        RowBox[{"Rinv", ",", "\n", "\t", "_Plus", ",", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"freduceR", "/@", " ", 
           RowBox[{"(", 
            RowBox[{"List", " ", "@@", " ", "Rinv"}], ")"}]}], "]"}], ",", 
         "\n", "\t", "_Times", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Rinv", "/", "#"}], " ", 
             RowBox[{"freduceR", "[", "#", "]"}]}], ")"}], " ", "&"}], "[", 
          RowBox[{"FirstCase", "[", 
           RowBox[{"Rinv", ",", " ", "_R"}], "]"}], "]"}], ",", "\n", "\t", 
         "_R", ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"Rinv", "===", 
             RowBox[{"prefreduceR", "[", "Rinv", "]"}]}]}], ",", 
           RowBox[{"freduceR", "[", 
            RowBox[{"prefreduceR", "[", "Rinv", "]"}], "]"}], ",", "\n", "\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cc", "=", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Rinv", ",", "_cap", ",", "1"}], "]"}]}], ",", 
               RowBox[{"pp", "=", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Rinv", ",", 
                  RowBox[{"Except", "[", "_cap", "]"}], ",", "1"}], "]"}]}]}],
               "}"}], ",", "\n", 
             RowBox[{"If", "[", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "cc", "]"}], ">=", "1"}], ",", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"plist", "=", 
                    RowBox[{"List", "@@", "Rinv"}]}], ",", 
                   RowBox[{"c", "=", 
                    RowBox[{"First", "[", "cc", "]"}]}]}], "}"}], ",", "\n", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"foo", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"pp", ",", 
                    RowBox[{"First", "[", "c", "]"}]}], "]"}]}], "}"}], ",", 
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pl", "=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "c", "]"}], ",", "foo"}], "]"}], 
                    "]"}]}], "}"}], ",", "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{
                    RowBox[{"Length", "[", "foo", "]"}], "==", "1"}]}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"prefreduceR", "/@", 
                    RowBox[{"(", 
                    RowBox[{"R", "@@@", 
                    RowBox[{"RotateLeft", "[", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"plist", ",", 
                    RowBox[{"{", "pl", "}"}]}], "]"}], ",", "5", ",", "1", 
                    ",", "1"}], "]"}], "]"}]}], ")"}]}], ")"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], ")"}], 
                    ",", "Rinv"}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
               "\n", "Rinv"}], "\n", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"redR", "[", "exp_", "]"}], ":=", 
     RowBox[{"FixedPoint", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{"i_R", "\[RuleDelayed]", 
          RowBox[{"prefreduceR", "[", "i", "]"}]}]}], "&"}], ",", "exp"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cyc", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "\[Rule]", 
         RowBox[{"i", "+", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "8"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"8", "+", "1"}], "\[Rule]", "1"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cyclic", "[", "exp_", "]"}], ":=", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R", "[", "x", "]"}], "/.", "cyc"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ab", "[", "x", "]"}], "/.", "cyc"}], ")"}]}]}], 
          "}"}]}], ")"}], "&"}], ",", "exp", ",", 
      RowBox[{"8", "-", "1"}]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.778833235767874*^9, 3.7788332359708095`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"89ffd185-ce06-4f2a-a5ca-43f218fab69a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"abswithcap1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"#", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"i", ",", 
           RowBox[{"cap1", "@@", "#"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", "8", "]"}], ",", 
             RowBox[{"Flatten", "[", "#", "]"}]}], "]"}]}], "}"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"Transpose", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "vava", "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"vava", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], "/@", 
              RowBox[{"Permutations", "[", 
               RowBox[{"vava", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "]"}], "/@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Subsets", "[", 
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"Range", "[", "8", "]"}], ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntersectingQ", "@@", "#"}]}], "&"}]}], "]"}]}], ",", 
          "1"}], "]"}]}], ")"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "/@", 
   RowBox[{"First", "/@", 
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"abswithcap1", "/.", "cap1exp"}], "//", "neabp"}], ",", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abswithcap1", "=", 
   RowBox[{"Last", "/@", 
    RowBox[{"abswithcap1", "[", 
     RowBox[{"[", "%", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abswithcap", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"#", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{";;", "2"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"6", ";;"}], "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Permutations", "@", 
           RowBox[{"Range", "[", "8", "]"}]}]}], ")"}], "/.", "sortab"}], "/.", 
       RowBox[{
        RowBox[{"ab", "[", "a__", "]"}], "\[RuleDelayed]", 
        RowBox[{"ab", "@@", 
         RowBox[{"(", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"List", "[", "a", "]"}], ",", 
            RowBox[{
             RowBox[{"cap", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"ordercup", "@", "x"}], ",", 
               RowBox[{"ordercup", "[", "y", "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ")"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"ab", "[", "x__", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"ab", "[", "x", "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "/@", 
   RowBox[{"First", "/@", 
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{"abswithcap", "//", "neabp"}], ",", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abswithcap", "=", 
   RowBox[{"Last", "/@", 
    RowBox[{"abswithcap", "[", 
     RowBox[{"[", "%", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abtwocaps", "=", 
   RowBox[{"DeleteDuplicatesBy", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "8", ",", 
         "2", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", "1", ",", 
         "5", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "8", ",", 
         "6", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "8"}], "}"}]}], "]"}], ",", "1", ",", 
         "6", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "]"}], ",", "4", ",", 
         "1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", "4", ",", 
         "1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", "1", ",", 
         "4", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], ",", "4", ",", 
         "7", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"8", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", "3", ",", 
         "8", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "6"}], "}"}]}], "]"}], ",", "3", ",", 
         "8", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", "8", ",", 
         "3", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "8"}], "}"}]}], "]"}], ",", "5", ",", 
         "1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "8"}], "}"}]}], "]"}], ",", "1", ",", 
         "5", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", "1", ",", 
         "5", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", "1", ",", 
         "4", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", "4", ",", 
         "8", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"ab", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "8", ",", 
         "4", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"neabp", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"abs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ab", "@@@", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Range", "[", "8", "]"}], ",", 
        RowBox[{"{", "4", "}"}]}], "]"}]}], ",", "abswithcap1", ",", 
     "abswithcap", ",", "abtwocaps"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"expandlog", "[", 
   RowBox[{"log", "[", "x_", "]"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"log", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}], "/@", 
    RowBox[{"FactorInteger", "[", "x", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"isfactor", "[", 
   RowBox[{"0", ",", "0"}], "]"}], ":=", "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isfactor", "[", 
   RowBox[{"0", ",", "x_"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{"x", "===", "0"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isfactor", "[", 
   RowBox[{"x_", ",", "0"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{"x", "===", "0"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isfactor", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Divisible", "[", 
   RowBox[{"x", ",", "y"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testfactor", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"ParallelEvaluate", "[", 
    RowBox[{
     RowBox[{"mom", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "4"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"isfactor", "[", 
      RowBox[{
       RowBox[{"myneab", "[", "x", "]"}], ",", 
       RowBox[{"myneab", "[", "y", "]"}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testfactor", "[", 
   RowBox[{"x_", ",", "y_List"}], "]"}], ":=", 
  RowBox[{"And", "@@@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelEvaluate", "[", 
     RowBox[{
      RowBox[{"mom", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "4"}], "}"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"isfactor", "[", 
         RowBox[{
          RowBox[{"myneab", "[", "x", "]"}], ",", 
          RowBox[{"myneab", "[", "#", "]"}]}], "]"}], "&"}], "/@", "y"}]}], 
     "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myabfactor", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "#", "]"}], "===", "Plus"}], ",", 
      RowBox[{"List", "@@", "#"}], ",", 
      RowBox[{"List", "[", "#", "]"}]}], "]"}], "&"}], "[", 
   RowBox[{
    RowBox[{"Boole", "[", 
     RowBox[{"testfactor", "[", 
      RowBox[{"x", ",", "abs"}], "]"}], "]"}], ".", "abs"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myabsim", "[", 
   RowBox[{"x_", " ", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"myabsim", "[", "x", "]"}], 
   RowBox[{"myabsim", "[", "y", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"myabsim", "[", 
   RowBox[{"ab", "[", "x__", "]"}], "]"}], ":=", 
  RowBox[{"ab", "[", "x", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"myabsim", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"x", ",", "ab"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"myabsim", "[", "x_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hh", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"myabfactor", "[", "x", "]"}]}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{
      RowBox[{"neabp", "[", 
       RowBox[{
        RowBox[{"hh", "/", "x"}], "/.", "cap1exp"}], "]"}], ",", "1", ",", 
      "hh", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "hh"}], ",", "_", ",", "x"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"abfactor", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lis", "=", 
       RowBox[{
        RowBox[{"Union", "@@", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"exp", "//.", "shifexp"}], "//.", "capexpand"}], ",", 
           "_ab", ",", "Infinity"}], "]"}]}], "/.", 
        RowBox[{"ab", "\[Rule]", "List"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"exp", "/", 
            RowBox[{"ab", "@@@", 
             RowBox[{"Subsets", "[", 
              RowBox[{"lis", ",", 
               RowBox[{"{", "4", "}"}]}], "]"}]}]}], "//", "neab"}], ",", 
          "_Integer"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"ab", "@@@", 
        RowBox[{
         RowBox[{"Subsets", "[", 
          RowBox[{"lis", ",", 
           RowBox[{"{", "4", "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"exp", "/", 
               RowBox[{"ab", "@@@", 
                RowBox[{"Subsets", "[", 
                 RowBox[{"lis", ",", 
                  RowBox[{"{", "4", "}"}]}], "]"}]}]}], "//", "neab"}], ",", 
             "_Integer"}], "]"}], "]"}], "]"}], "]"}]}], ",", "exp"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mom", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", "+", "i"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"neab", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
    RowBox[{
     RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Det", "[", 
      RowBox[{"mom", "[", 
       RowBox[{"[", 
        RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myneab", "[", "x_", "]"}], ":=", 
  RowBox[{"neab", "[", 
   RowBox[{"x", "/.", "cap1exp"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expandcap2", "=", 
   RowBox[{
    RowBox[{"ab", "[", 
     RowBox[{"a___", ",", 
      RowBox[{"cap2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_", ",", "e_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f_", ",", "g_", ",", "h_"}], "}"}]}], "]"}], ",", "b___"}], 
     "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"a", ",", "c", ",", "d", ",", "b"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"e", ",", "f", ",", "g", ",", "h"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"a", ",", "d", ",", "e", ",", "b"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"c", ",", "f", ",", "g", ",", "h"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"ab", "[", 
       RowBox[{"a", ",", "e", ",", "c", ",", "b"}], "]"}], 
      RowBox[{"ab", "[", 
       RowBox[{"d", ",", "f", ",", "g", ",", "h"}], "]"}]}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"redRcap", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"exp", "/.", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"x___", ",", 
              RowBox[{"cap", "[", 
               RowBox[{"y_", ",", "z_"}], "]"}], ",", "w___"}], "]"}], ":>", 
            RowBox[{
             RowBox[{"sixR", "[", 
              RowBox[{"x", ",", 
               RowBox[{"cap", "[", 
                RowBox[{"y", ",", "z"}], "]"}], ",", "w", ",", 
               RowBox[{"First", "@", "y"}]}], "]"}], "/;", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"IntersectingQ", "[", 
                RowBox[{"y", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "w"}], "}"}]}], "]"}]}], ")"}]}]}]}], 
          ")"}], "//", "redR"}], "//", "Expand"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"x___", ",", "y_", ",", "z___", ",", "y_", ",", "w___"}], 
        "]"}], "\[RuleDelayed]", "0"}]}], "/.", "sortab"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Qlog", "[", "x_", "]"}], 
      RowBox[{
       RowBox[{"R", "[", "y__", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z_"}], ")"}]}]}], "\[RuleDelayed]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"x", " ", "z"}], ",", 
         RowBox[{"Power", "[", 
          RowBox[{"_", ",", "2"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"z", "/", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}]}], "]"}], 
        RowBox[{"R", "[", "y", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Qlog", "[", 
          RowBox[{"z", "/", 
           RowBox[{"(", 
            RowBox[{"z", "-", "1"}], ")"}]}], "]"}]}], 
        RowBox[{"R", "[", "y", "]"}]}]}], "]"}]}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.7780580330677767`*^9, 3.7780580755518336`*^9}, {
   3.778058233833214*^9, 3.778058241599079*^9}, {3.7780585147861824`*^9, 
   3.7780585305982833`*^9}, {3.778058606005228*^9, 3.7780586350206223`*^9}, {
   3.7780587162703533`*^9, 3.778058728849331*^9}, 3.7780613636767855`*^9, {
   3.778070036333418*^9, 3.77807003653644*^9}, {3.778070613614246*^9, 
   3.778070650145401*^9}, 3.778073232788291*^9, {3.7780761487700586`*^9, 
   3.7780762194578266`*^9}, {3.7780765735045166`*^9, 3.7780766684577365`*^9}, 
   3.778076836270405*^9, 3.778077286551737*^9, {3.7780787847080083`*^9, 
   3.778078790676792*^9}, {3.7781308629841466`*^9, 3.778130876364403*^9}, {
   3.778205332065772*^9, 3.778205384721464*^9}, {3.778329042064069*^9, 
   3.778329069969858*^9}, {3.7783327475016975`*^9, 3.7783327478300643`*^9}, {
   3.7783327851263986`*^9, 3.7783328157047553`*^9}, 3.7783357520952034`*^9, {
   3.7783375003139267`*^9, 3.778337682314299*^9}, {3.7783390424546237`*^9, 
   3.778339042861211*^9}, {3.77834212545505*^9, 3.7783421258766985`*^9}, {
   3.7783917368806634`*^9, 3.778391756823392*^9}, {3.77847133042371*^9, 
   3.778471342142253*^9}, {3.778471424564045*^9, 3.778471438220434*^9}, 
   3.7784716706263065`*^9, {3.778822101143087*^9, 3.778822101377019*^9}, {
   3.7788224341899395`*^9, 3.7788224358149223`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a7347433-bc0a-415f-a991-f1d917b042cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"randomPositiveZs", "[", "20", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.778901886970613*^9, 3.7789018874113197`*^9}, 
   3.77890192238874*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"e57b5d87-4e76-402b-a65f-4dec5ca586e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "data1", " ", "\:662f\:975eirrational", " ", "box\:7684\:90e8\:5206"}], 
    "\:ff0c", 
    RowBox[{"data2\:662firrational", " ", "box"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data1", "=", 
     RowBox[{
      RowBox[{"<<", "\"\<datawithoutirbox\>\""}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"log", "\[Rule]", "Log"}], ",", 
        RowBox[{
         RowBox[{"Li", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Li", "[", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"part1", ":", " ", 
      RowBox[{"1", " ", "-", " ", "195"}]}], ",", " ", 
     RowBox[{"part2", ":", " ", 
      RowBox[{"196", " ", "-", " ", "393"}]}], ",", " ", 
     RowBox[{"part3", ":", " ", 
      RowBox[{"394", " ", "-", " ", "537"}]}], ",", " ", 
     RowBox[{"rationalbox", ":", " ", 
      RowBox[{"538", " ", "-", " ", "549"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data2", "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"_Integer", "\[Rule]", "_"}]}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"<<", "\"\<irrationalbox1\>\""}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"_Integer", "\[Rule]", "_"}]}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"<<", "\"\<irrationalbox21\>\""}]}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"Tensor", "[", 
        RowBox[{"x___", ",", "y_", ",", "w___"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"0", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"y", ",", "z"}], "]"}]}], ")"}], "||", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"y", ",", "\[CapitalDelta]"}], "]"}], ")"}]}]}], 
         ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"u1", "\[Rule]", "v2"}], ",", " ", 
     RowBox[{"v1", "\[Rule]", "u2"}], ",", " ", 
     RowBox[{"u2", "\[Rule]", "u1"}], ",", " ", 
     RowBox[{"v2", "\[Rule]", "v1"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.777553304560638*^9, 3.7775533146056485`*^9}, {
   3.7775533528872476`*^9, 3.7775533677581673`*^9}, {3.7776081120296044`*^9, 
   3.7776081621834517`*^9}, {3.7777097000993805`*^9, 3.777709711623054*^9}, {
   3.7777098203717628`*^9, 3.7777098237346306`*^9}, {3.778052299395315*^9, 
   3.77805230463033*^9}, 3.7780528167082095`*^9, {3.778070821411488*^9, 
   3.77807083577046*^9}, {3.778071829770485*^9, 3.778071860676894*^9}, {
   3.7780720040516343`*^9, 3.778072005505184*^9}, {3.7783338252988386`*^9, 
   3.7783338255327673`*^9}, {3.778334668704881*^9, 3.7783346889551997`*^9}, 
   3.7783347979390745`*^9, {3.778335805969863*^9, 3.778335806423034*^9}, 
   3.778400818251484*^9, {3.778401124955249*^9, 3.7784011281268787`*^9}, {
   3.778401242626746*^9, 3.778401334111456*^9}, {3.77840138086147*^9, 
   3.7784013880330906`*^9}, {3.7784014413456*^9, 3.7784014437673583`*^9}, {
   3.7784015339081554`*^9, 3.7784015461737075`*^9}, {3.7784016351893806`*^9, 
   3.7784016357518415`*^9}, 3.778822336424259*^9, {3.778832555392279*^9, 
   3.7788325905331106`*^9}, {3.77893013865842*^9, 3.778930138854732*^9}, {
   3.778930173703774*^9, 3.778930181040764*^9}, {3.7789305554825172`*^9, 
   3.778930555631074*^9}, {3.778930592476379*^9, 3.778930592694825*^9}},
 CellLabel->
  "In[874]:=",ExpressionUUID->"fcb1614d-b659-4324-8830-d8b0f1acc9a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Chi", ":", " ", "\:73b0\:5728\:8f7d\:5165irrationalbox22"}], ",",
     "\:800c\:4e0d\:662firrationalbox21", "\:ff0c", 
    RowBox[{
     RowBox[{"\:5177\:4f53\:533a\:522b\:662f", " ", 
      RowBox[{"R", "[", 
       RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "]"}], 
      RowBox[{"Qlog", "[", 
       FractionBox[
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", 
          RowBox[{"cap", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"5", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "7", ",",
           "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}]}], "->", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "]"}], 
      RowBox[{"Qlog", "[", 
       FractionBox[
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", 
          RowBox[{"cap", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"5", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "7", ",",
           "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}]], "]"}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Chi", ":", " ", "\:4e3a\:4e86\:8282\:7701\:65f6\:95f4"}], 
    "\:ff0c", 
    "\:4e4b\:95f4\:5728\:8fd0\:884c\:540e\:7684hh\:4e2d\:505a\:8fd9\:4e2a\
\:4fee\:6539"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.7788325970330205`*^9, {3.778930183758151*^9, 3.778930254919916*^9}, {
   3.778930340787161*^9, 3.778930424827045*^9}, 3.778930545440299*^9, {
   3.77893094904125*^9, 
   3.778930949605118*^9}},ExpressionUUID->"fa9cbc37-036d-4d76-bd68-\
51d3b2d30509"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"\:5168\:90e8", " ", "LiToG"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data11", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"LiToG", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "data1"}], "]"}], "/.", "sortab"}], "/.", "sortcap1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"data1Gs", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"data11", ",", "_G", ",", "Infinity"}], "]"}], "//", 
       "Union"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datasym", "=", "data11"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.777606516832616*^9, 3.7776065187123947`*^9}, {
   3.7776077546650205`*^9, 3.7776077758041573`*^9}, 3.777607817688168*^9, {
   3.7776082771315184`*^9, 3.7776082854316483`*^9}, {3.7776083467302427`*^9, 
   3.7776084255291433`*^9}, {3.777612978666848*^9, 3.7776129789338975`*^9}, {
   3.7777136930804567`*^9, 3.7777136943564463`*^9}, {3.7780720541142406`*^9, 
   3.77807205722404*^9}, {3.7783849569075394`*^9, 3.7783849781426363`*^9}, {
   3.7783884571048164`*^9, 3.7783884635644507`*^9}, {3.7783958517980537`*^9, 
   3.778395853845407*^9}, {3.7788326221267586`*^9, 3.7788326394553404`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"d628807b-aa81-45c3-82a8-5a1d06239424"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "\:8ba1\:7b97Symbol", "\:ff0c", "\:63d0\:51faalphabet", "\:ff0c", 
   "datasym1\:5148\:505acap\:5c55\:5f00", "\:ff0c", 
   "\:7136\:540e\:6574\:7406\:4e00\:4e0bsymbol"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7788326584708095`*^9, 
  3.7788327621431527`*^9}},ExpressionUUID->"0bd2caf7-7a8a-451f-b9b2-\
62e2d6561f9d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"datasym1", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"SymbolExpand", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "===", "Plus"}], ",", 
             RowBox[{"ComputeSymbol", "/@", "#"}], ",", 
             RowBox[{"ComputeSymbol", "[", "#", "]"}]}], "]"}], "&"}], "@", 
          RowBox[{"datasym", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempalpha", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"eeta", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "@", 
         RowBox[{"GetSymbolAlphabet", "[", "temp1", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
        RowBox[{"x", "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"x", ",", "ab"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
        RowBox[{"Last", "[", 
         RowBox[{"tempalpha", "\[LeftDoubleBracket]", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"First", "/@", "tempalpha"}], ",", "x"}], "]"}], "]"}], 
           "]"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"temp1", "/.", 
           RowBox[{"CiTi", "\[Rule]", "Tensor"}]}], "/.", 
          RowBox[{
           RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
           RowBox[{"Tensor", "@@", 
            RowBox[{"(", 
             RowBox[{"findeeta", "/@", 
              RowBox[{"{", "x", "}"}]}], ")"}]}]}]}], "/.", 
         RowBox[{"Tensor", "\[Rule]", "CiTi"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"restempalpha", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Reverse", "/@", "tempalpha"}], ")"}], "//.", 
             "capexpand"}], "/.", "cap1exp"}], "/.", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"x___", ",", "y_", ",", "z___", ",", "y_", ",", "w___"}],
              "]"}], "\[RuleDelayed]", "0"}]}], "/.", "sortab"}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"temp3", "=", 
        RowBox[{"SymbolExpand", "[", 
         RowBox[{"temp2", "/.", "restempalpha"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp4", "=", 
        RowBox[{"GetSymbolAlphabet", "[", "temp3", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"datasym", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "temp3", ",", "temp4", 
         ",", 
         RowBox[{"data1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "datasym"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "temp1", ",", "tempalpha", ",", "temp2", ",", "restempalpha", ",", "temp3", 
   ",", "temp4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.778329435501645*^9, 3.7783294825170293`*^9}, {
   3.7783295563454094`*^9, 3.7783296038452377`*^9}, {3.7783296380325937`*^9, 
   3.7783296420488267`*^9}, {3.778329676298442*^9, 3.7783298326261845`*^9}, 
   3.778331079376316*^9, {3.778331134110871*^9, 3.7783311927515416`*^9}, {
   3.7783338714855423`*^9, 3.7783338798448825`*^9}, {3.7783339345011563`*^9, 
   3.778333934642827*^9}, {3.7783815977511883`*^9, 3.7783816045486326`*^9}, {
   3.7783850070323844`*^9, 3.778385017735945*^9}, {3.77838631863515*^9, 
   3.778386349767311*^9}, {3.7783864207361655`*^9, 3.7783864227203646`*^9}, {
   3.7783868404387584`*^9, 3.7783868437824545`*^9}, {3.778387040271287*^9, 
   3.778387066532714*^9}, {3.7783871226260023`*^9, 3.7783871268610067`*^9}, {
   3.778388140173662*^9, 3.7783881977051477`*^9}, {3.778388404720456*^9, 
   3.7783884050794363`*^9}, {3.7783884991266813`*^9, 
   3.7783884993301973`*^9}, {3.7783896640954475`*^9, 
   3.7783896837827454`*^9}, {3.7783900506581182`*^9, 3.778390060736556*^9}, {
   3.7783901062360563`*^9, 3.7783901558763924`*^9}, 3.7783901997516932`*^9, 
   3.7783911864618907`*^9, 3.7784671954387856`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"41dd2337-fa74-41e4-abba-5522f6cf5665"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"372.784603`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.7783870374542522`*^9, 3.7783870902668777`*^9, 
  3.7783872270328865`*^9, 3.778388279736047*^9, 3.7783884505148926`*^9, 
  3.778389821284973*^9, 3.7783900844127855`*^9, 3.7783906887546787`*^9, 
  3.7783965936887283`*^9, 3.7783996516886873`*^9, 3.7784637570634937`*^9, 
  3.7784676746730814`*^9, 3.778902370601327*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"97bc0ff2-25a9-4fff-a4fd-17377a78e15d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "\:8ba1\:7b97Symbol", "\:ff0c", "\:63d0\:51faalphabet", "\:ff0c", 
   "datasym2\:5bf9datasym1\:7b97\:51fa\:7684alphabet\:6570\:503c\:505a\
myabfactor", "\:ff0c", "\:7136\:540e\:5e26\:56de\:53bb\:5316\:7b80symbol"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.77883274433068*^9, 
  3.7788328000021706`*^9}},ExpressionUUID->"17241c30-7b2a-4b53-9a4c-\
b2e7134e7d09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"datasym2", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"datasym1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "Plus"}], "]"}], ",", 
        RowBox[{"datasym1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp1", "=", 
          RowBox[{"datasym1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempalpha", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
               RowBox[{"eeta", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "@", 
           RowBox[{"GetSymbolAlphabet", "[", "temp1", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
          RowBox[{"x", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"x", ",", "ab"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
          RowBox[{"Last", "[", 
           RowBox[{"tempalpha", "\[LeftDoubleBracket]", 
            RowBox[{"First", "[", 
             RowBox[{"First", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"First", "/@", "tempalpha"}], ",", "x"}], "]"}], 
              "]"}], "]"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"temp1", "/.", 
             RowBox[{"CiTi", "\[Rule]", "Tensor"}]}], "/.", 
            RowBox[{
             RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{"Tensor", "@@", 
              RowBox[{"(", 
               RowBox[{"findeeta", "/@", 
                RowBox[{"{", "x", "}"}]}], ")"}]}]}]}], "/.", 
           RowBox[{"Tensor", "\[Rule]", "CiTi"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"restempalpha", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}], ",", 
               RowBox[{"myabsim", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"(", 
             RowBox[{"Reverse", "/@", "tempalpha"}], ")"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp3", "=", 
          RowBox[{"SymbolExpand", "[", 
           RowBox[{"temp2", "/.", "restempalpha"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp4", "=", 
          RowBox[{"GetSymbolAlphabet", "[", "temp3", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"datasym", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "temp3", ",", 
           "temp4", ",", 
           RowBox[{"data1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "datasym1"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "temp1", ",", "tempalpha", ",", "temp2", ",", "restempalpha", ",", "temp3", 
   ",", "temp4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7783324082049327`*^9, 3.778332430454979*^9}, {
   3.778332460970226*^9, 3.7783325430328903`*^9}, {3.778332575329793*^9, 
   3.778332655423346*^9}, {3.7783329278764644`*^9, 3.7783331149698906`*^9}, 
   3.7783338891261635`*^9, {3.7783339386417446`*^9, 3.7783339388136697`*^9}, 
   3.7783341028292084`*^9, {3.7783348907202263`*^9, 3.778334891236043*^9}, {
   3.778337696220111*^9, 3.778337696391758*^9}, {3.778340535251532*^9, 
   3.7783405518454103`*^9}, {3.778341165251417*^9, 3.778341170532854*^9}, 
   3.7783424850798607`*^9, 3.7783816388138905`*^9, {3.77839119358163*^9, 
   3.7783911947862225`*^9}, 3.778466760376706*^9, {3.7784669924075165`*^9, 
   3.778466994111495*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"3f14e009-cdc2-4d55-8b12-d2775ad09ccd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"480.831631`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.778379640043621*^9, 3.77838350951143*^9, 
  3.7783914926021333`*^9, 3.7783968773761764`*^9, 3.778399935173456*^9, 
  3.778464039735376*^9, 3.7784687334389267`*^9, 3.778472607001066*^9, 
  3.778902859557296*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"634febcb-59ea-4e84-baa2-47f2f14ebb9c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"part1", ":", " ", 
    RowBox[{"1", " ", "-", " ", "195"}]}], ",", " ", 
   RowBox[{"part2", ":", " ", 
    RowBox[{"196", " ", "-", " ", "393"}]}], ",", " ", 
   RowBox[{"part3", ":", " ", 
    RowBox[{"394", " ", "-", " ", "537"}]}], ",", " ", 
   RowBox[{"rationalbox", ":", " ", 
    RowBox[{"538", " ", "-", " ", "549"}]}]}], " ", "*)"}]], "Input",Expressio\
nUUID->"53483cb6-9075-494d-ae0f-91de8efac70c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "\:540c\:6837\:7684\:4e8b\:5bf9", " ", "data2", " ", 
   "\:4e5f\:505a\:4e00\:904d"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.778832812736512*^9, 
  3.778832833768094*^9}},ExpressionUUID->"18aabd92-a684-4b7c-b72e-\
3bbae553053e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"data2sym1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"SymbolExpand", "[", 
         RowBox[{
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "/.", 
          RowBox[{"Tensor", "\[Rule]", "CiTi"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempalpha", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"eeta", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "@", 
         RowBox[{"GetSymbolAlphabet", "[", "temp1", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
        RowBox[{"x", "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"x", ",", "ab"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
        RowBox[{"Last", "[", 
         RowBox[{"tempalpha", "\[LeftDoubleBracket]", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"First", "/@", "tempalpha"}], ",", "x"}], "]"}], "]"}], 
           "]"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp2", "=", 
        RowBox[{
         RowBox[{"temp1", "/.", 
          RowBox[{"CiTi", "\[Rule]", "Tensor"}]}], "/.", 
         RowBox[{
          RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
          RowBox[{"CiTi", "@@", 
           RowBox[{"(", 
            RowBox[{"findeeta", "/@", 
             RowBox[{"{", "x", "}"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"restempalpha", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Reverse", "/@", "tempalpha"}], ")"}], "//.", 
              "capexpand"}], "/.", "cap1exp"}], "/.", 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{
              "x___", ",", "y_", ",", "z___", ",", "y_", ",", "w___"}], "]"}],
              "\[RuleDelayed]", "0"}]}], "/.", "sortab"}], "//", "Simplify"}],
          ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"temp3", "=", 
        RowBox[{"SymbolExpand", "[", 
         RowBox[{"temp2", "/.", "restempalpha"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp4", "=", 
        RowBox[{"GetSymbolAlphabet", "[", "temp3", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "temp3", ",", "temp4", 
         ",", 
         RowBox[{"data2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "data2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"data2sym2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"temp1", "=", 
         RowBox[{"SymbolExpand", "[", 
          RowBox[{
           RowBox[{"data2sym1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "/.", 
           RowBox[{"Tensor", "\[Rule]", "CiTi"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tempalpha", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
              RowBox[{"eeta", "[", "i", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "@", 
          RowBox[{"GetSymbolAlphabet", "[", "temp1", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
         RowBox[{"x", "/;", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"x", ",", "ab"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
         RowBox[{"Last", "[", 
          RowBox[{"tempalpha", "\[LeftDoubleBracket]", 
           RowBox[{"First", "[", 
            RowBox[{"First", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"First", "/@", "tempalpha"}], ",", "x"}], "]"}], "]"}],
             "]"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"temp1", "/.", 
            RowBox[{"CiTi", "\[Rule]", "Tensor"}]}], "/.", 
           RowBox[{
            RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
            RowBox[{"Tensor", "@@", 
             RowBox[{"(", 
              RowBox[{"findeeta", "/@", 
               RowBox[{"{", "x", "}"}]}], ")"}]}]}]}], "/.", 
          RowBox[{"Tensor", "\[Rule]", "CiTi"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"restempalpha", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}], ",", 
              RowBox[{"myabsim", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{"Reverse", "/@", "tempalpha"}], ")"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp3", "=", 
         RowBox[{"SymbolExpand", "[", 
          RowBox[{"temp2", "/.", "restempalpha"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp4", "=", 
         RowBox[{"GetSymbolAlphabet", "[", "temp3", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "temp3", ",", "temp4",
           ",", 
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "data2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"data2sym3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"temp1", "=", 
          RowBox[{"data2sym2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempalpha", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
               RowBox[{"eeta", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}], "@", 
           RowBox[{"GetSymbolAlphabet", "[", "temp1", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
          RowBox[{"x", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"x", ",", "ab"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"findeeta", "[", "x_", "]"}], ":=", 
          RowBox[{"Last", "[", 
           RowBox[{"tempalpha", "\[LeftDoubleBracket]", 
            RowBox[{"First", "[", 
             RowBox[{"First", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"First", "/@", "tempalpha"}], ",", "x"}], "]"}], 
              "]"}], "]"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"temp1", "/.", 
             RowBox[{"CiTi", "\[Rule]", "Tensor"}]}], "/.", 
            RowBox[{
             RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{"Tensor", "@@", 
              RowBox[{"(", 
               RowBox[{"findeeta", "/@", 
                RowBox[{"{", "x", "}"}]}], ")"}]}]}]}], "/.", 
           RowBox[{"Tensor", "\[Rule]", "CiTi"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"restempalpha", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}], ",", 
               RowBox[{"mysim", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"(", 
             RowBox[{"Reverse", "/@", "tempalpha"}], ")"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp3", "=", 
          RowBox[{"SymbolExpand", "[", 
           RowBox[{"temp2", "/.", "restempalpha"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temp4", "=", 
          RowBox[{"GetSymbolAlphabet", "[", "temp3", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "temp3", ",", 
           "temp4", ",", 
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "data2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "temp1", ",", "tempalpha", ",", "temp2", ",", "restempalpha", ",", "temp3", 
   ",", "temp4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.778333270845227*^9, 3.7783333183139997`*^9}, {
   3.778333414876932*^9, 3.778333418657873*^9}, {3.7783339054073544`*^9, 
   3.778333910235519*^9}, {3.778334085579301*^9, 3.77833416617332*^9}, {
   3.778334217657756*^9, 3.778334249657427*^9}, {3.778334852126643*^9, 
   3.778334869532791*^9}, 3.778334927740791*^9, {3.778334967923006*^9, 
   3.7783349743918447`*^9}, {3.7783375913142347`*^9, 3.778337593063924*^9}, {
   3.7783431708298826`*^9, 3.778343199361205*^9}, {3.7783923712666006`*^9, 
   3.7783923797074194`*^9}, {3.778400309204337*^9, 3.7784003163452387`*^9}, {
   3.7784003685797358`*^9, 3.7784004050018344`*^9}, {3.7784004976736455`*^9, 
   3.778400512033147*^9}, {3.778400850236498*^9, 3.778400872313673*^9}, {
   3.778401002438929*^9, 3.7784010213300858`*^9}, {3.7784011044550548`*^9, 
   3.7784011046889877`*^9}, {3.7784722851886377`*^9, 3.7784722959698524`*^9}, 
   3.7786622589540477`*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"a4db6eb3-fd47-41ad-8bd7-13b7edd81898"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.918993`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.7783332774387674`*^9, 3.778333318688819*^9}, {
   3.7783334162199097`*^9, 3.778333419063825*^9}, {3.77833457672024*^9, 
   3.7783345799073496`*^9}, 3.7783346297291756`*^9, 3.778334701548208*^9, 
   3.7783348085949154`*^9, 3.778335407298018*^9, 3.7783355117516685`*^9, 
   3.7783382933917007`*^9, 3.778343211157447*^9, 3.778343332313616*^9, 
   3.7783923847030015`*^9, 3.7783999875637026`*^9, 3.7784003126105175`*^9, {
   3.77840037615736*^9, 3.7784004120949774`*^9}, {3.7784004990172157`*^9, 
   3.778400513376191*^9}, {3.7784008449232306`*^9, 3.7784008517203107`*^9}, {
   3.7784010066262803`*^9, 3.7784010252355895`*^9}, 3.7784011084700484`*^9, 
   3.7784728845325575`*^9, 3.778821345954867*^9, 3.778902922665098*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"738c09a6-fc3a-412a-8eb2-ebb93bc05654"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20.303702`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.7783332774387674`*^9, 3.778333318688819*^9}, {
   3.7783334162199097`*^9, 3.778333419063825*^9}, {3.77833457672024*^9, 
   3.7783345799073496`*^9}, 3.7783346297291756`*^9, 3.778334701548208*^9, 
   3.7783348085949154`*^9, 3.778335407298018*^9, 3.7783355117516685`*^9, 
   3.7783382933917007`*^9, 3.778343211157447*^9, 3.778343332313616*^9, 
   3.7783923847030015`*^9, 3.7783999875637026`*^9, 3.7784003126105175`*^9, {
   3.77840037615736*^9, 3.7784004120949774`*^9}, {3.7784004990172157`*^9, 
   3.778400513376191*^9}, {3.7784008449232306`*^9, 3.7784008517203107`*^9}, {
   3.7784010066262803`*^9, 3.7784010252355895`*^9}, 3.7784011084700484`*^9, 
   3.7784728845325575`*^9, 3.778821345954867*^9, 3.7789029429703407`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"523bdf9b-b242-46d6-80af-a50a335e93eb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "save", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"datasym2", ",", "data2sym2"}], "]"}], ">>", 
     "\"\<rational_data2\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphabet", ">>", "\"\<rational_alphabet\>\""}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.777642898126151*^9, 3.7776429432697096`*^9}, {
   3.7776430749692364`*^9, 3.777643095887026*^9}, {3.777643401208907*^9, 
   3.777643404892185*^9}, {3.7776441235808334`*^9, 3.7776441238501773`*^9}, {
   3.7784730956426735`*^9, 3.7784731400014887`*^9}, {3.7784732201111326`*^9, 
   3.778473241157733*^9}, 3.7788214540492907`*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"3304ccc8-0aca-417c-b5a4-ebd672f550f7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", "read", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"coefflist", "=", 
       RowBox[{"<<", "\"\<coeffs\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qlogRs", "=", 
       RowBox[{"<<", "\"\<qlogRsanditscoeffs\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"qlogRs2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"qlogRs", "//.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Qlog", "[", 
                   RowBox[{"x_", " ", "y_"}], "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Qlog", "[", "x", "]"}], "+", 
                   RowBox[{"Qlog", "[", "y", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Qlog", "[", 
                   RowBox[{"x_", "/", "y_"}], "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Qlog", "[", "x", "]"}], "-", 
                   RowBox[{"Qlog", "[", "y", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Qlog", "[", 
                   RowBox[{"1", "/", "x_"}], "]"}], "\[RuleDelayed]", 
                  RowBox[{"-", 
                   RowBox[{"Qlog", "[", "x", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Qlog", "[", 
                   RowBox[{"-", "1"}], "]"}], "\[RuleDelayed]", "0"}]}], 
                "}"}]}], "//.", "capexpand"}], "/.", "sortab"}], "/.", 
            "tocaps"}], "/.", "tocap2"}], "/.", "sortcap1"}], "/.", 
         "sortab"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Qlog", "[", 
            RowBox[{"x_", " ", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"Qlog", "[", "x", "]"}], "+", 
            RowBox[{"Qlog", "[", "y", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Qlog", "[", 
            RowBox[{"x_", "/", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"Qlog", "[", "x", "]"}], "-", 
            RowBox[{"Qlog", "[", "y", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Qlog", "[", 
            RowBox[{"1", "/", "x_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"-", 
            RowBox[{"Qlog", "[", "x", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Qlog", "[", 
            RowBox[{"-", "1"}], "]"}], "\[RuleDelayed]", "0"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"allR8", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"##", ",", "8"}], "]"}], "&"}], "@@", "#"}], "&"}], "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "7", "]"}], ",", 
          RowBox[{"{", "4", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Times", "@@@", "qlogRs2"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"sixR", "[", 
            RowBox[{"x", ",", "8"}], "]"}], "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", "8"}], "]"}]}]}]}], "/.", 
        "sortR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffRs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"temp", ",", "#"}], "]"}], "&"}], "/@", "allR8"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"temp1", "=", 
       RowBox[{"SymbolExpand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeffRs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", 
          RowBox[{"coefflist", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
         RowBox[{"_irr", "\[RuleDelayed]", "0"}]}], "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "temp2"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"temp1", "/.", 
         RowBox[{
          RowBox[{"Qlog", "[", 
           RowBox[{"-", "1"}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"CiTi", "[", "x__", "]"}], 
          RowBox[{"Qlog", "[", "y_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"CiTi", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], "/.", "sortab"}], "/.", 
      "sortcap1"}], "/.", "tocap2"}]}], ";"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.778475193038868*^9, 3.7784752138987246`*^9}, 
   3.778477445382165*^9, {3.7786423955162463`*^9, 3.7786424181261225`*^9}, {
   3.778832984517561*^9, 
   3.778833003955144*^9}},ExpressionUUID->"6d77b17e-9386-4a7d-9d46-\
999e8ca54d05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"\:76f4\:63a5\:628a\:6570\:636ecyclic\:4e00\:4e0b", "\:ff0c", 
    RowBox[{
     RowBox[{"\:6ce8\:610f\:8fd9\:91cc\:6211\:4eec\:5c06R", "[", 
      RowBox[{"___", ",", "_cap", ",", "___"}], "]"}], 
     "\:4e2d\:7684cap\:79fb\:5230\:4e86Qlog\:91cc"}], "\:ff0c", 
    "\:89c1redRcap"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"hh", "=", 
    RowBox[{
    "<<", "\"\<C:\\\\Users\\\\Buwai_Lee\\\\Desktop\\\\rationalpartsymdata\\\\\
rational_data2\>\""}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7786617576853733`*^9, 3.7786617607820377`*^9}, {
   3.778662322720337*^9, 3.778662340126503*^9}, 3.778822383049554*^9, {
   3.778833022705618*^9, 3.778833068299231*^9}, {3.7789308303240767`*^9, 
   3.7789308313201647`*^9}, {3.7791022421792164`*^9, 3.779102248007719*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"68303b2c-926d-4456-8eb9-1919fca90a9b"],

Cell[BoxData["\"\<\>"], "Input",
 CellChangeTimes->{
  3.7791022399290895`*^9},ExpressionUUID->"65198cbe-c6d6-4d19-8dd6-\
37b388aee3d2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Chi", ":", " ", "\:4e3a\:4e86\:8282\:7701\:65f6\:95f4"}], 
    "\:ff0c", 
    "\:4e4b\:95f4\:5728\:8fd0\:884c\:540e\:7684hh\:4e2d\:505a\:8fd9\:4e2a\
\:4fee\:6539"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.778930833071302*^9, 3.778930838665098*^9}, 
   3.778930882716242*^9, {3.778930931633171*^9, 
   3.778930937401451*^9}},ExpressionUUID->"64b1f2a0-ff34-4b0e-b8f9-\
8f7e23adbac1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"hh", ",", 
   RowBox[{"Qlog", "[", 
    FractionBox[
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", 
       RowBox[{"cap", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "7", ",", 
       "8"}], "]"}], 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.778930775170514*^9, 3.778930816096848*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"d023032e-d393-41c2-9bc1-7770f114b92d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"555", ",", "1", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.778930816891758*^9, 3.7790120369916954`*^9, 
  3.779013112257278*^9, 3.7791022639915037`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"36279cd4-5388-4744-86d1-7ed24e8a67bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hh", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.7789312767935*^9, 3.778931279007756*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"a4956612-0502-47bb-8c37-3aae6b1f16fe"],

Cell[BoxData["561"], "Output",
 CellChangeTimes->{3.778931279604269*^9, 3.7790120371479087`*^9, 
  3.779013112382392*^9, 3.7791022661480207`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"295c03ec-2a3a-4060-8585-1cc1e07f67de"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "8"}], ";"}]], "Input",
 CellChangeTimes->{{3.778931221352737*^9, 3.778931223668425*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"a0532bc5-9c2c-4493-b032-6538264ba546"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modhh", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hh", "/.", 
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", 
           RowBox[{"cap", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "7", 
           ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], ":>", 
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", 
           RowBox[{"cap", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], ",", "7", 
           ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}]], "]"}]}]}], 
     ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.778930784538982*^9, 3.778930789047473*^9}, {
  3.778930887864811*^9, 3.778930922337706*^9}, {3.77893112849013*^9, 
  3.778931139524662*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"41605690-b526-454b-a24c-592efc8dd20c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"firstentry", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "6", ",", "7"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "7"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"2", ",", "3", ",", "7", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "5", ",", "6", ",", "8"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7789310098650637`*^9, 3.7789310605426397`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"f8d7504c-18f5-465b-8257-a87f68a52bb4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "\:9996\:5148\:5c06hh\:5206\:4e3a\:4e24\:90e8\:5206", "\:ff0c", 
   "\:7b2c\:4e00\:90e8\:5206trival\:914d\:5e73", "\:ff0c", 
   RowBox[{"\:7b2c\:4e8c\:90e8\:5206non", " ", "trival\:914d\:5e73\:7684"}]}],
   " ", "*)"}]], "Input",
 CellChangeTimes->{{3.778985335655439*^9, 3.778985341987871*^9}, {
  3.778985401931937*^9, 
  3.778985408803041*^9}},ExpressionUUID->"da2cd07c-8273-42cb-a64e-\
7de102001d8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modhh1", "=", 
   RowBox[{"modhh", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"modhh", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Qlog", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Qlog", "[", 
              RowBox[{"x", "/.", "sortab"}], "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "i_", ",", "7", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "j_", ",", "7", ",", "8"}], "]"}]], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "1", ",", "i"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "1", ",", "j"}], "]"}]], "]"}]}]}],
           "/.", 
          RowBox[{
           RowBox[{"Qlog", "[", 
            FractionBox[
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "1", ",", 
               RowBox[{"cap", "[", "x___", "]"}]}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"7", ",", "8", ",", "1", ",", "b_"}], "]"}]], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"-", 
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "1", ",", "b"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"7", ",", "8", ",", "1", ",", 
                RowBox[{"cap", "[", "x", "]"}]}], "]"}]], "]"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "a_"}], 
               "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"x___", ",", 
                RowBox[{"cap", "[", "y___", "]"}], ",", "z___"}], "]"}]], 
             "]"}], "\[RuleDelayed]", 
            RowBox[{"0", "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", "y", "}"}], "]"}], ",", "a"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Qlog", "[", 
              FractionBox[
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "a_"}], 
                "]"}], 
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "b_"}], 
                "]"}]], "]"}], 
             RowBox[{"R", "[", "x___", "]"}]}], "\[RuleDelayed]", 
            RowBox[{"0", "/;", 
             RowBox[{"SubsetQ", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}]}], "}"}]}], ",", 
        "0"}], "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.778931074093803*^9, 3.778931094193519*^9}, {
  3.778931145835367*^9, 3.778931155936191*^9}, {3.778931199493516*^9, 
  3.778931215583681*^9}, {3.778931287288456*^9, 3.7789313071762867`*^9}, {
  3.77893151058567*^9, 3.778931513072423*^9}, {3.778974349103201*^9, 
  3.778974350409113*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"70b44ab2-283e-4480-8102-a50d86630c9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modhh2", "=", 
   RowBox[{"modhh", "[", 
    RowBox[{"[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "modhh", "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"modhh", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"Qlog", "[", "x_", "]"}], "\[RuleDelayed]", 
               RowBox[{"Qlog", "[", 
                RowBox[{"x", "/.", "sortab"}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"Qlog", "[", 
               FractionBox[
                RowBox[{"ab", "[", 
                 RowBox[{"1", ",", "i_", ",", "7", ",", "8"}], "]"}], 
                RowBox[{"ab", "[", 
                 RowBox[{"1", ",", "j_", ",", "7", ",", "8"}], "]"}]], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"Qlog", "[", 
               FractionBox[
                RowBox[{"ab", "[", 
                 RowBox[{"7", ",", "8", ",", "1", ",", "i"}], "]"}], 
                RowBox[{"ab", "[", 
                 RowBox[{"7", ",", "8", ",", "1", ",", "j"}], "]"}]], 
               "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"Qlog", "[", 
              FractionBox[
               RowBox[{"ab", "[", 
                RowBox[{"7", ",", "8", ",", "1", ",", 
                 RowBox[{"cap", "[", "x___", "]"}]}], "]"}], 
               RowBox[{"ab", "[", 
                RowBox[{"7", ",", "8", ",", "1", ",", "b_"}], "]"}]], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"-", 
              RowBox[{"Qlog", "[", 
               FractionBox[
                RowBox[{"ab", "[", 
                 RowBox[{"7", ",", "8", ",", "1", ",", "b"}], "]"}], 
                RowBox[{"ab", "[", 
                 RowBox[{"7", ",", "8", ",", "1", ",", 
                  RowBox[{"cap", "[", "x", "]"}]}], "]"}]], "]"}]}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Qlog", "[", 
               FractionBox[
                RowBox[{"ab", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "a_"}], 
                 "]"}], 
                RowBox[{"ab", "[", 
                 RowBox[{"x___", ",", 
                  RowBox[{"cap", "[", "y___", "]"}], ",", "z___"}], "]"}]], 
               "]"}], "\[RuleDelayed]", 
              RowBox[{"0", "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "y", "}"}], "]"}], ",", "a"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Qlog", "[", 
                FractionBox[
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "a_"}], 
                  "]"}], 
                 RowBox[{"ab", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "n", ",", "1", ",", "b_"}], 
                  "]"}]], "]"}], 
               RowBox[{"R", "[", "x___", "]"}]}], "\[RuleDelayed]", 
              RowBox[{"0", "/;", 
               RowBox[{"SubsetQ", "[", 
                RowBox[{
                 RowBox[{"{", "x", "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}]}], "}"}]}], ",",
           "0"}], "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.778931321128694*^9, 3.778931360624522*^9}, {
  3.778931516570306*^9, 3.778931519328516*^9}, {3.7789743812113953`*^9, 
  3.778974382225662*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"136f8e91-52ec-448f-b91c-540ea1765139"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "\:8fdb\:4e00\:6b65", "\:ff0c", 
   "\:518d\:628amodhh1\:548cmodhh2\:5206\:4e3a\:4e24\:90e8\:5206", "\:ff0c", 
   RowBox[{"\:7b2c\:4e00\:90e8\:5206\:4e0d\:6ee1\:8db3first", " ", "entry"}], 
   ",", 
   RowBox[{"\:7b2c\:4e8c\:90e8\:5206\:6ee1\:8db3first", " ", "entry"}]}], " ",
   "*)"}]], "Input",
 CellChangeTimes->{{3.7789854304453077`*^9, 3.778985432667161*^9}, {
  3.77898550913207*^9, 
  3.778985509714493*^9}},ExpressionUUID->"69b25096-0f20-4de3-9bf2-\
24c5ab0afda6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modhh11", "=", 
   RowBox[{"modhh1", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SubsetQ", "[", 
           RowBox[{"firstentry", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"modhh1", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"CiTi", "[", 
                  RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                 "x"}]}], ",", 
               RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
              "Union"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", 
            RowBox[{"Length", "@", "modhh1"}]}], "}"}]}], "]"}], ",", 
        "False"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modhh12", "=", 
   RowBox[{"modhh1", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SubsetQ", "[", 
           RowBox[{"firstentry", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"modhh1", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"CiTi", "[", 
                  RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                 "x"}]}], ",", 
               RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
              "Union"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", 
            RowBox[{"Length", "@", "modhh1"}]}], "}"}]}], "]"}], ",", 
        "True"}], "]"}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7789313644013987`*^9, 3.77893137755364*^9}, {
  3.778931411506927*^9, 3.7789314610813913`*^9}, {3.778931539264142*^9, 
  3.7789315689894333`*^9}, {3.778932160888167*^9, 3.7789321790219603`*^9}, {
  3.778974484715692*^9, 3.778974516495386*^9}, {3.7789745579879847`*^9, 
  3.778974572347731*^9}, {3.7789753811597967`*^9, 3.778975413379583*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"e87e0340-bbc1-497f-8a9b-94266332499f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modhh21", "=", 
   RowBox[{"modhh2", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SubsetQ", "[", 
           RowBox[{"firstentry", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"modhh2", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"CiTi", "[", 
                  RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                 "x"}]}], ",", 
               RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
              "Union"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", 
            RowBox[{"Length", "@", "modhh2"}]}], "}"}]}], "]"}], ",", 
        "False"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"modhh22", "=", 
   RowBox[{"modhh2", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SubsetQ", "[", 
           RowBox[{"firstentry", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"modhh2", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"CiTi", "[", 
                  RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                 "x"}]}], ",", 
               RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
              "Union"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", 
            RowBox[{"Length", "@", "modhh2"}]}], "}"}]}], "]"}], ",", 
        "True"}], "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.778932185192246*^9, 3.778932231829974*^9}, {
  3.778974531971468*^9, 3.778974551591875*^9}, {3.778975397361401*^9, 
  3.778975421732772*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"017e8247-bded-46b6-ac7c-4f5cf13c24b8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.778931489809637*^9, 3.778931505445382*^9}, 
   3.778931536992071*^9, {3.778932242634041*^9, 3.778932252507267*^9}, {
   3.778974583976453*^9, 3.778974594160275*^9}, {3.778975404479088*^9, 
   3.778975420496913*^9}, {3.7789756452672577`*^9, 3.778975646347674*^9}, {
   3.778975676447734*^9, 
   3.778975676971704*^9}},ExpressionUUID->"3ea9b5a1-13f1-4f11-bc39-\
111164a9dcb7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"replacemod21", " ", "\:9700\:8981double", " ", "check"}], ",", 
   "\:5c06replacemod21\:4f5c\:7528\:5728modhh21\:4e0a", ",", " ", 
   "\:4f5c\:7528\:7ed3\:679c\:662fnewmodhh21"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.77898553149299*^9, 3.778985542490532*^9}, {
  3.778985586794063*^9, 3.77898558741051*^9}, {3.778985692393858*^9, 
  3.778985720661339*^9}, {3.779012462320176*^9, 
  3.779012462414629*^9}},ExpressionUUID->"9dd9de1f-2678-4865-8cca-\
4be8e8a2ab44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"replacemod21", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "3", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "4", ",", 
         "6", ",", "8"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "6"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "3", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "8"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"8", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "7"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "8"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "5", ",", 
         "6", ",", "8"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "5", ",", "6"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "5", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "4", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "4", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "8"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"4", ",", "5", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"8", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "7"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "8"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "2", ",", 
         "3", ",", "7"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", 
             RowBox[{"cap1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "4"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"7", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "]"}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "4", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "5", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "5", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "3", ",", "4", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "7"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "2", ",", 
         "3", ",", "7"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", 
             RowBox[{"cap1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"6", ",", "4"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"7", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "]"}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "4", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "6", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "7"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "6", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "3", ",", "4", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "7"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "2", ",", 
         "3", ",", "8"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "6"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "4", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "3", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "3", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "8"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"8", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "7"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "8"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"1", ",", 
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "2", ",", 
         "4", ",", "7"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", 
             RowBox[{"cap1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"6", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"7", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], "]"}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "5", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "6", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "5", ",", "7"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "5", ",", "6", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "4", ",", "5", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "7"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"cap", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", "2", ",", 
         "3", ",", "4", ",", "7"}], "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"6", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "7", ",", "8"}], "}"}]}], "]"}], ",", "2", 
             ",", "3", ",", "4"}], "]"}]], "]"}]}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "5", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "7"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "3", ",", "5", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "4", ",", "5", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "7"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "5", ",", "7"}], "]"}]}], 
          RowBox[{"ab", "[", 
           RowBox[{"7", ",", 
            RowBox[{"cap1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "8"}], "}"}]}], "]"}]}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7"}], "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
       RowBox[{"R", "[", 
        RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
      "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "4", ",", "5", ",", "7"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "7"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"4", ",", "5", ",", "6", ",", "8"}], "]"}]}], 
          RowBox[{
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
           RowBox[{"ab", "[", 
            RowBox[{"2", ",", "4", ",", "5", ",", "8"}], "]"}]}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}]], "]"}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "5", ",", "7", ",", "8"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "4", ",", "7", ",", "8"}], "]"}]}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "4", ",", "6", ",", "7", ",", "8"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "2", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"2", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"2", ",", "5", ",", "6", ",", "7", ",", "8"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "]"}]}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "6", ",", "7", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}], "]"}], 
        " ", 
        RowBox[{"R", "[", 
         RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "]"}]}]}]}]}],
     "}"}]}], ";"}]], "Code", "Input",
 CellChangeTimes->{{3.778975679614389*^9, 3.778975710825348*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"2d7c4545-bbd9-45e8-b9a1-458e3a2006b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newmodhh21", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@@", "modhh21"}], "/.", "replacemod21"}], "/.", 
        "sortcap1"}], "/.", 
       RowBox[{
        RowBox[{"Qlog", "[", 
         RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Qlog", "[", "x", "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"Qlog", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "a_Integer", ",", "7", ",", "8"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "b_Integer", ",", "7", ",", "8"}], "]"}]], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Qlog", "[", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "b", ",", "7", ",", "8"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "a", ",", "7", ",", "8"}], "]"}]], "]"}]}], "/;", 
        RowBox[{"a", ">", "b"}]}]}]}], "]"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.778975726990982*^9, 3.778975748347673*^9}, {
   3.778975787830717*^9, 3.778975790268182*^9}, {3.77897584061522*^9, 
   3.7789758524762793`*^9}, {3.778975889747859*^9, 3.778975891644546*^9}, {
   3.7789760216266193`*^9, 3.778976026205502*^9}, {3.778976503450482*^9, 
   3.778976505293371*^9}, {3.778976555343731*^9, 3.778976595886602*^9}, 
   3.778976904465933*^9, {3.7789793176754503`*^9, 3.7789793205851603`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"b1e21b55-be89-411e-a7bf-7b4c4b77f13a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qlistofmod", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"newmodhh21", ",", 
      RowBox[{"Qlog", "[", "__", "]"}], ",", "Infinity"}], "]"}], "//", 
    "Union"}]}], ";", 
  RowBox[{"lastofmod", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"qlistofmod", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"newmodhh21", ",", 
            RowBox[{"qlistofmod", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"R", "[", "__", "]"}], ",", "Infinity"}], "]"}]}], "//", 
       "Union"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "qlistofmod"}]}], "}"}]}], "]"}], "]"}]}], ";", 
  RowBox[{"rewmodhh21", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lastofmod", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{"newmodhh21", ",", 
         RowBox[{
          RowBox[{"lastofmod", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"R", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}], ",", 
         RowBox[{
          RowBox[{"lastofmod", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Qlog", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "lastofmod"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.778975881188192*^9, 3.778975911231512*^9}, {
   3.778976011671809*^9, 3.778976036030039*^9}, {3.77897613743458*^9, 
   3.778976138981792*^9}, 3.778985783144841*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"ce6ab76f-c2bc-49a9-a15e-35fe14619d98"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\:518d\:628arewmodhh21", "\:ff0c", 
    RowBox[{
    "\:5206\:4e3a\:6ee1\:8db3first", " ", 
     "entry\:548c\:4e0d\:6ee1\:8db3first", " ", "entry"}], ",", 
    RowBox[{"\:524d\:8005\:90fd\:662fnon", " ", "trival\:914d\:5e73"}], 
    "\:ff0c", "\:540e\:8005\:5219\:662f\:5df2\:7ecf\:914d\:5e73\:7684", 
    "\:ff0c", "\:524d\:8005\:4e0emodhh22\:5408\:5e76", "\:ff0c", 
    "\:8bb0\:4e3anewmodhh22", ",", 
    RowBox[{
    "\:540e\:8005\:5219\:76f4\:63a5\:8bb0\:4e3a", " ", "addmodhh11"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.778985727633831*^9, 3.778985732041555*^9}, {
  3.778985983100017*^9, 3.778985984088979*^9}, {3.7791043783936834`*^9, 
  3.779104383601577*^9}},ExpressionUUID->"fcec85a8-89bc-41f7-a066-\
d105c0a0218a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newmodhh22", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rewmodhh21", "[", 
      RowBox[{"[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"firstentry", ",", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"List", "@@", 
                   RowBox[{"rewmodhh21", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                  RowBox[{
                   RowBox[{"CiTi", "[", 
                    RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                   "x"}]}], ",", 
                 RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
                "Union"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", 
              RowBox[{"Length", "@", "rewmodhh21"}]}], "}"}]}], "]"}], ",", 
          "True"}], "]"}], "]"}], "]"}], "]"}], ",", "modhh22"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.778976317121615*^9, 3.778976358740823*^9}, {
  3.778976399081258*^9, 3.778976414607443*^9}, {3.77897660780165*^9, 
  3.7789766172300043`*^9}, {3.7789769149035254`*^9, 3.7789769254289227`*^9}, {
  3.7789773830178623`*^9, 3.778977409801219*^9}, {3.778977440054624*^9, 
  3.778977472211383*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"19ccb98b-31fd-4ade-972b-97d86d10ccbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addmodhh11", "=", 
   RowBox[{"rewmodhh21", "[", 
    RowBox[{"[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SubsetQ", "[", 
           RowBox[{"firstentry", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"rewmodhh21", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "2"}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"CiTi", "[", 
                  RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", 
                 "x"}]}], ",", 
               RowBox[{"ab", "[", "___", "]"}], ",", "Infinity"}], "]"}], "//",
              "Union"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", 
            RowBox[{"Length", "@", "rewmodhh21"}]}], "}"}]}], "]"}], ",", 
        "False"}], "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7789757658240833`*^9, 3.7789758380002317`*^9}, {
  3.778976424340805*^9, 3.77897644739462*^9}, {3.778976624409713*^9, 
  3.778976641734309*^9}, {3.7789768558807917`*^9, 3.7789768586768837`*^9}, {
  3.778976933822193*^9, 3.778976942039339*^9}, {3.778977413261216*^9, 
  3.778977422839306*^9}, {3.778977493158903*^9, 3.778977540123426*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"94eb7f4f-ebbc-4c73-bb10-39d939fee84b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"\:5408\:5e76modhh11\:548caddmodhh11", ",", 
   RowBox[{
   "\:5e76\:914d\:5e73Qlog", ".", "\:7136\:540e\:5408\:5e76Qlog\:548cCiTi"}], 
   "\:ff0c", "\:7ed3\:679c\:8bb0\:4e3asymofnewmodhh11"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7789859957332563`*^9, 3.7789859958164186`*^9}, {
  3.778986026768667*^9, 3.7789860278249073`*^9}, {3.778986124968726*^9, 
  3.778986125425529*^9}},ExpressionUUID->"178799b1-7023-4726-bb7e-\
d4e5b6b0dac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newmodhh11", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"Qlog", "[", "x__", "]"}], ":>", 
               RowBox[{"Qlog", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "/.", "capexpand"}], "/.", "sortab"}], "/.", 
                   "tocaps"}], "/.", "tocap2"}], "/.", "sortcap1"}], 
                "]"}]}]}], "/.", "sortab"}], "/.", 
            RowBox[{
             RowBox[{"Qlog", "[", 
              RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"Qlog", "[", "x", "]"}]}]}], "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Qlog", "[", 
              RowBox[{
               RowBox[{"ab", "[", "x__", "]"}], "y_"}], "]"}], 
             RowBox[{"R", "[", "a__", "]"}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"Qlog", "[", "y", "]"}], 
              RowBox[{"R", "[", "a", "]"}]}], "/;", 
             RowBox[{"SubsetQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", 
               RowBox[{"{", "x", "}"}]}], "]"}]}]}]}], "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"Qlog", "[", 
             RowBox[{"y_", "/", 
              RowBox[{"ab", "[", "x__", "]"}]}], "]"}], 
            RowBox[{"R", "[", "a__", "]"}]}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"Qlog", "[", "y", "]"}], 
             RowBox[{"R", "[", "a", "]"}]}], "/;", 
            RowBox[{"SubsetQ", "[", 
             RowBox[{
              RowBox[{"{", "a", "}"}], ",", 
              RowBox[{"{", "x", "}"}]}], "]"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "a_", ",", "7", ",", "8"}], "]"}], "x__"], 
             "]"}], 
            RowBox[{"R", "[", 
             RowBox[{"y___", ",", "a_", ",", "z___"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"Qlog", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"ab", "[", 
                RowBox[{"1", ",", "a", ",", "7", ",", "8"}], "]"}], 
               RowBox[{"ab", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}], "x"], "]"}], 
            RowBox[{"R", "[", 
             RowBox[{"y", ",", "a", ",", "z"}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"Qlog", "[", 
           FractionBox["x__", 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "a_", ",", "7", ",", "8"}], "]"}]], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"y___", ",", "a_", ",", "z___"}], "]"}]}], 
         "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Qlog", "[", 
           FractionBox["x", 
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "a", ",", "7", ",", "8"}], "]"}], 
             RowBox[{"ab", "[", 
              RowBox[{"y", ",", "z"}], "]"}]}]], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"y", ",", "a", ",", "z"}], "]"}]}]}]}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Join", "[", 
     RowBox[{"modhh11", ",", "addmodhh11"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.77897756219804*^9, 3.778977636942811*^9}, {
   3.778977668830551*^9, 3.778977675579206*^9}, 3.7789777465138893`*^9, {
   3.778977785597725*^9, 3.7789779652797832`*^9}, {3.7789780022549067`*^9, 
   3.778978093452582*^9}, {3.778979241672379*^9, 3.778979273654735*^9}, {
   3.778979685277594*^9, 3.77897968544726*^9}, {3.7789797596506042`*^9, 
   3.77897977974795*^9}, 3.778979810683152*^9, 3.77898010903062*^9, {
   3.778980819060191*^9, 3.7789808214166*^9}, {3.7789810811284313`*^9, 
   3.778981084483185*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"35bbdda6-bd4d-48b9-b31c-3d50768671b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rlistofnewmodhh11", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"newmodhh11", ",", 
      RowBox[{"R", "[", "__", "]"}], ",", "Infinity"}], "]"}], "//", 
    "Union"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7789784403622837`*^9, 3.778978454195178*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ca7eca6e-390e-4789-85c8-65f5b1f35f25"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"symofnewmodhh11", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"temp", "=", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"Times", "@@@", "newmodhh11"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"CiTi", "[", "x__", "]"}], 
             RowBox[{"Qlog", "[", "y_", "]"}]}], "\[RuleDelayed]", 
            RowBox[{"CiTi", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rlistofnewmodhh11", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"rlistofnewmodhh11", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "rlistofnewmodhh11"}]}], "}"}]}], "]"}]}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.7789781012379837`*^9, 3.7789781067733*^9}, {
   3.7789783358948193`*^9, 3.778978390347547*^9}, {3.778978462654293*^9, 
   3.7789785104838953`*^9}, {3.778978605526753*^9, 3.7789786195881643`*^9}, 
   3.778980126965925*^9, {3.7790120834611278`*^9, 3.7790121062581797`*^9}, {
   3.7791054801165714`*^9, 
   3.779105483820727*^9}},ExpressionUUID->"c79ec8f9-2a23-491b-9a9c-\
4aff92d6941a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7790120736947875`*^9, 3.7790121895385885`*^9, 3.7790131317729197`*^9, {
   3.779105476788457*^9, 3.77910548346029*^9}},
 CellLabel->
  "Out[112]=",ExpressionUUID->"c0d93566-7731-4ae4-9a85-4df92471f94a"]
}, Open  ]],

Cell["\<\
(*
  1 \[Rule] 11,12
  2 \[Rule] 21,22
  21 \[Rule] 211, 212
  212, 11 \[Rule] newmodhh11
  212, 22 \[Rule] newmodhh22
  12 \[Rule] newmodhh12
  -----
  {newmodhh12,newmodhh22,newmodhh11}
*)\
\>", "Text",
 CellChangeTimes->{{3.779105076429595*^9, 3.7791051891643887`*^9}, {
  3.7791052275860023`*^9, 3.7791053804455605`*^9}, {3.7791054618040695`*^9, 
  3.779105464663496*^9}},ExpressionUUID->"5c7ad367-db04-4735-a956-\
e17ff1220923"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Check", " ", "First", " ", "entry", " ", "of", " ", "symofnewmodhh11"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.778986131484009*^9, 
  3.7789861522811317`*^9}},ExpressionUUID->"0e01736a-f420-4e69-ad27-\
7ec7109b848c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"SubsetQ", "[", 
    RowBox[{"firstentry", ",", 
     RowBox[{
      RowBox[{"First", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"SymbolExpand", "[", 
          RowBox[{"symofnewmodhh11", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"CiTi", "[", 
           RowBox[{"x_", ",", "y__"}], "]"}], "\[RuleDelayed]", "x"}], ",", 
         "Infinity"}], "]"}]}], "//", "Union"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "symofnewmodhh11"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.778978973557818*^9, 3.778978974955882*^9}, {
  3.778979044217025*^9, 3.778979049452318*^9}, {3.778979453631659*^9, 
  3.7789794957732353`*^9}, {3.7791055618978224`*^9, 3.7791055657891235`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"52fbb746-baf4-437c-8863-89fd19b6cf73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.778979051525359*^9, {3.778979443849494*^9, 3.778979467985833*^9}, 
   3.778979522325181*^9, 3.778980256061479*^9, 3.778980936759561*^9, 
   3.778981218266934*^9, 3.779012225226055*^9, 3.779105596304033*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"787bd156-d133-46df-94ee-a4b1423efd2b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\:914d\:5e73modhh12", " ", "\:7684", " ", "Qlog"}], ",", 
   "\:7136\:540e\:5408\:5e76Qlog\:548cCiTi", "\:ff0c", 
   "\:7ed3\:679c\:8bb0\:4e3asymofnewmodhh12"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7789861963577223`*^9, 
  3.778986262080413*^9}},ExpressionUUID->"571e60f1-5562-4c93-8644-\
b909340ae555"],

Cell[BoxData[
 RowBox[{
  RowBox[{"newmodhh12", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"Qlog", "[", "x__", "]"}], ":>", 
                 RowBox[{"Qlog", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "/.", "capexpand"}], "/.", "sortab"}], "/.", 
                    "tocaps"}], "/.", "tocap2"}], "/.", "sortcap1"}], 
                  "]"}]}]}], "/.", "sortab"}], "/.", 
              RowBox[{
               RowBox[{"Qlog", "[", 
                RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"Qlog", "[", "x", "]"}]}]}], "//.", 
             RowBox[{
              RowBox[{
               RowBox[{"Qlog", "[", 
                RowBox[{
                 RowBox[{"ab", "[", "x__", "]"}], "y_"}], "]"}], 
               RowBox[{"R", "[", "a__", "]"}]}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{
                RowBox[{"Qlog", "[", "y", "]"}], 
                RowBox[{"R", "[", "a", "]"}]}], "/;", 
               RowBox[{"SubsetQ", "[", 
                RowBox[{
                 RowBox[{"{", "a", "}"}], ",", 
                 RowBox[{"{", "x", "}"}]}], "]"}]}]}]}], "//.", 
            RowBox[{
             RowBox[{
              RowBox[{"Qlog", "[", 
               RowBox[{"y_", "/", 
                RowBox[{"ab", "[", "x__", "]"}]}], "]"}], 
              RowBox[{"R", "[", "a__", "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"Qlog", "[", "y", "]"}], 
               RowBox[{"R", "[", "a", "]"}]}], "/;", 
              RowBox[{"SubsetQ", "[", 
               RowBox[{
                RowBox[{"{", "a", "}"}], ",", 
                RowBox[{"{", "x", "}"}]}], "]"}]}]}]}], "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"Qlog", "[", 
              RowBox[{"1", "/", 
               RowBox[{"ab", "[", "x__", "]"}]}], "]"}], 
             RowBox[{"R", "[", "a__", "]"}]}], "\[RuleDelayed]", 
            RowBox[{"0", "/;", 
             RowBox[{"SubsetQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", 
               RowBox[{"{", "x", "}"}]}], "]"}]}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Qlog", "[", 
              FractionBox[
               RowBox[{"ab", "[", 
                RowBox[{"1", ",", "a_", ",", "7", ",", "8"}], "]"}], "x__"], 
              "]"}], 
             RowBox[{"R", "[", 
              RowBox[{"y___", ",", "a_", ",", "z___"}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Qlog", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"ab", "[", 
                 RowBox[{"1", ",", "a", ",", "7", ",", "8"}], "]"}], 
                RowBox[{"ab", "[", 
                 RowBox[{"y", ",", "z"}], "]"}]}], "x"], "]"}], 
             RowBox[{"R", "[", 
              RowBox[{"y", ",", "a", ",", "z"}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"Qlog", "[", 
            FractionBox["x__", 
             RowBox[{"ab", "[", 
              RowBox[{"1", ",", "a_", ",", "7", ",", "8"}], "]"}]], "]"}], 
           RowBox[{"R", "[", 
            RowBox[{"y___", ",", "a_", ",", "z___"}], "]"}]}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"Qlog", "[", 
            FractionBox["x", 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{"1", ",", "a", ",", "7", ",", "8"}], "]"}], 
              RowBox[{"ab", "[", 
               RowBox[{"y", ",", "z"}], "]"}]}]], "]"}], 
           RowBox[{"R", "[", 
            RowBox[{"y", ",", "a", ",", "z"}], "]"}]}]}]}], ")"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "modhh12"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.778980272858098*^9, 3.7789802814157133`*^9}, {
   3.778980961871513*^9, 3.778980963268343*^9}, {3.778981000152338*^9, 
   3.778981007868679*^9}, 3.7789810392922163`*^9, {3.778983579322144*^9, 
   3.778983619014635*^9}, {3.778983719808133*^9, 3.7789837832283*^9}, {
   3.7789838375596657`*^9, 3.778983935056767*^9}, {3.778983976486787*^9, 
   3.7789840044116783`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"2f446743-d9c6-4d30-be1a-47fe20f1df08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rlistofnewmodhh12", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"newmodhh12", ",", 
      RowBox[{"R", "[", "__", "]"}], ",", "Infinity"}], "]"}], "//", 
    "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symofnewmodhh12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rlistofnewmodhh12", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Times", "@@@", "newmodhh12"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"CiTi", "[", "x__", "]"}], 
              RowBox[{"Qlog", "[", "y_", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"CiTi", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"rlistofnewmodhh12", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "rlistofnewmodhh12"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7789840088603897`*^9, 3.7789840470933123`*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"0e424895-3b45-484f-a734-5f1e284e202f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7790122876010313`*^9},
 CellLabel->
  "Out[331]=",ExpressionUUID->"2c98aec5-b1d0-4b6e-9dcf-ef4f34298da8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:5408\:5e76", " ", "symofnewmodhh11", " ", "\:548c", " ", 
    "symofnewmodhh12"}], ",", "\:7ed3\:679c\:8bb0\:4e3asymofpeipingdata", ",", 
   RowBox[{
   "ntrpeipingdata", " ", "\:662f", " ", "newmodhh22", " ", 
    "\:7684\:91cd\:65b0\:547d\:540d"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.778986283107624*^9, 3.778986339360845*^9}, {
  3.7789863906561937`*^9, 3.7789863940886917`*^9}, {3.7789864262960863`*^9, 
  3.778986431808037*^9}},ExpressionUUID->"73bf2fab-0147-4ecf-b7e8-\
7fa897471588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"totrlist", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"rlistofnewmodhh11", ",", "rlistofnewmodhh12"}], "]"}]}], ";"}]], \
"Input",
 CellChangeTimes->{{3.7789844576814413`*^9, 3.778984471318226*^9}},
 CellLabel->
  "In[1143]:=",ExpressionUUID->"5d117e63-8047-46a9-8e0a-3415c16211e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symofpeipingdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"totrlist", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"(", 
             RowBox[{"Times", "@@@", "symofnewmodhh11"}], ")"}], "]"}], "+", 
           RowBox[{"Total", "[", 
            RowBox[{"(", 
             RowBox[{"Times", "@@@", "symofnewmodhh12"}], ")"}], "]"}]}], ",", 
          RowBox[{"totrlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "//", "SymbolExpand"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "totrlist"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7789842357620564`*^9, 3.778984296233082*^9}, {
  3.778984342177265*^9, 3.7789843803018913`*^9}, {3.778984449654285*^9, 
  3.7789845708504457`*^9}, {3.7789850099876633`*^9, 3.778985018175859*^9}},
 CellLabel->
  "In[1166]:=",ExpressionUUID->"dadbcf03-ff66-47f0-b398-e49c6418a426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntrpeipingdata", "=", "newmodhh22"}], ";"}]], "Input",
 CellChangeTimes->{{3.7789850286706953`*^9, 3.778985076277054*^9}},
 CellLabel->
  "In[1167]:=",ExpressionUUID->"9700d180-dfcd-43d4-9138-c98e78dbbf21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{"newmodhh12", ",", "newmodhh22", ",", "newmodhh11"}], "]"}], ">>", 
  "\"\<rational_newdata\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"Total", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"GatherBy", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"newmodhh12", ",", "newmodhh22", ",", "newmodhh11"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "_"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"_", ",", "0"}], "}"}]}]}], "]"}], ",", "First"}], "]"}]}], 
  ">>", "\"\<rational_newdata2\>\""}]}], "Input",
 CellChangeTimes->{{3.778985079827783*^9, 3.778985101742391*^9}, {
  3.779012600929706*^9, 3.779012615460763*^9}, {3.7790126489608974`*^9, 
  3.7790126629767756`*^9}, {3.7790133653985248`*^9, 3.7790134430235004`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"8aa1c539-ea6c-4af1-9a63-fc0df0b1be84"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hh1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"redRcap", "[", 
            RowBox[{"hh", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "/.", "sortR"}], "/.",
           "sortab"}], "/.", 
         RowBox[{
          RowBox[{"Qlog", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Qlog", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", "x", "]"}], "/.", "tocaps"}], "]"}]}]}], 
        ",", 
        RowBox[{"hh", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "hh"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"cyclic", "[", "hh1", "]"}], ",", "1"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"R", "[", "x__", "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"sixR", "[", 
          RowBox[{"x", ",", "8"}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", "8"}], "]"}]}]}]}], "/.", "sortR"}], 
     "/.", "sortab"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7787554111886683`*^9, 3.778755500172818*^9}, 
   3.778755750891547*^9, {3.7788237423457923`*^9, 3.7788238170958633`*^9}, {
   3.778823904377091*^9, 3.7788239051583996`*^9}, {3.7788244486583757`*^9, 
   3.778824452017288*^9}, {3.778824485455823*^9, 3.7788244994240212`*^9}, {
   3.778830191330394*^9, 3.7788301921898055`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"a1176629-f02b-419b-ab5a-947ba57603f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.338937`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.778902954788126*^9, 3.778902986505455*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"46eed54d-e9a0-4ca8-9d46-3d240a371bea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"214.068028`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.778902954788126*^9, 3.778903200574244*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"95846a94-26aa-4640-96b7-231df4285f5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "\:8fd9\:91cc\:5c31\:662f\:628a", " ", "\:53ef\:80fd\:7684Qlog", " ", 
        "R"}], "+", 
       RowBox[{"Qlog", " ", "R"}], "+"}], "..."}], 
     "\:5c55\:5f00\:6210\:591a\:9879"}], "\:ff0c", 
    "\:7136\:540e\:628aQlog\:79fb\:5230\:540e\:9762"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hhtempfun", "[", "aaa_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bbb", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"aaa", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"bbb", ",", "Plus"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"aaa", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"List", "@@", "bbb"}], ")"}]}], ",", 
        RowBox[{"{", "aaa", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hh2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"hhtempfun", "/@", "hh1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "0"}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hh3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pp", "=", 
            RowBox[{"FirstCase", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "_R"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Expand", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "pp"}], ")"}], 
             " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}], "&"}], "/@",
        "hh2"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hh4", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Total", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"hh3", ",", "First"}], "]"}]}]}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.778830310001996*^9, 3.7788303443461947`*^9}, {
  3.7788304027366195`*^9, 3.7788304059555693`*^9}, {3.778830456595997*^9, 
  3.778830467752243*^9}, {3.778830503424296*^9, 3.7788305404242783`*^9}, {
  3.778830637033121*^9, 3.7788306431894054`*^9}, {3.7788308315180845`*^9, 
  3.778830839939646*^9}, {3.7788309054711776`*^9, 3.778830922877035*^9}, {
  3.778831038830428*^9, 3.7788310399704876`*^9}, {3.7788310996743536`*^9, 
  3.7788311410019636`*^9}, {3.7788312061268816`*^9, 3.778831241236972*^9}, {
  3.77883307625216*^9, 3.778833136611422*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"a84e9d89-cf8a-44d6-9699-26649b53828f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.078135`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7788247977048535`*^9, 3.778830259767476*^9, {3.7788303256578937`*^9, 
   3.7788303454704447`*^9}, 3.7788304065329823`*^9, 3.778830468314542*^9, 
   3.778830541079938*^9, 3.7788306438770046`*^9, 3.7788308410329857`*^9, 
   3.778830923501763*^9, 3.778831040423846*^9, {3.778831128001718*^9, 
   3.77883114156418*^9}, {3.7788312210799685`*^9, 3.778831242455083*^9}, 
   3.7789029596979113`*^9, 3.778903233336626*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"4c749995-b8d1-44b6-b359-d782cbcfc3eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.362411`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7788247977048535`*^9, 3.778830259767476*^9, {3.7788303256578937`*^9, 
   3.7788303454704447`*^9}, 3.7788304065329823`*^9, 3.778830468314542*^9, 
   3.778830541079938*^9, 3.7788306438770046`*^9, 3.7788308410329857`*^9, 
   3.778830923501763*^9, 3.778831040423846*^9, {3.778831128001718*^9, 
   3.77883114156418*^9}, {3.7788312210799685`*^9, 3.778831242455083*^9}, 
   3.7789029596979113`*^9, 3.778903233699551*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"01c70b7e-d36c-46b8-94a0-0319e7b088ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.088876`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7788247977048535`*^9, 3.778830259767476*^9, {3.7788303256578937`*^9, 
   3.7788303454704447`*^9}, 3.7788304065329823`*^9, 3.778830468314542*^9, 
   3.778830541079938*^9, 3.7788306438770046`*^9, 3.7788308410329857`*^9, 
   3.778830923501763*^9, 3.778831040423846*^9, {3.778831128001718*^9, 
   3.77883114156418*^9}, {3.7788312210799685`*^9, 3.778831242455083*^9}, 
   3.7789029596979113`*^9, 3.778903233788988*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"9dfba747-d866-4c47-a135-9133389159f7"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.778665794251565*^9, 3.778665800673134*^9}, 
   3.7788332264865*^9},ExpressionUUID->"367d2eac-8f1c-422d-b761-56942b73b934"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.77875445464156*^9, {3.7787545413290157`*^9, 3.778754599547741*^9}, {
   3.7787559138450003`*^9, 3.7787559253293715`*^9}, 
   3.77882242851814*^9},ExpressionUUID->"911151da-b5d0-4d88-bbd6-\
1efcf386e057"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testtemp", "=", 
   RowBox[{"<<", "testtest"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.779108278398242*^9, 3.779108291648082*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"cee0c938-236c-4d4a-8fcc-b1548dfca9f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"SymbolExpand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"testtemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/.", "sortab"}], "/.", "sortcap1"}],
       "/.", "capexpand"}], "/.", "sortab"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "testtemp"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7791083045231504`*^9, 3.7791083566478205`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"01b9a7fd-028c-4906-8577-763923620957"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7791083085072713`*^9, 3.7791083608045015`*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"c4cb8468-0dc1-49fa-af1b-7ce8d3565f79"]
}, Open  ]]
},
WindowSize->{2974, 1836},
WindowMargins->{{33, Automatic}, {Automatic, 134}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 641, 13, 168, "Input",ExpressionUUID->"fc7f3f57-40d1-4ffe-9e20-9017892b93bc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1246, 39, 1388, 24, 44, "Print",ExpressionUUID->"e3e64a0e-8996-4cfa-989d-f9f31969f208"],
Cell[2637, 65, 1202, 18, 44, "Print",ExpressionUUID->"440a07c1-f6a3-40cc-a931-f93f0edea4de"],
Cell[3842, 85, 1224, 19, 44, "Print",ExpressionUUID->"6900b06f-feeb-4730-999a-2f9ce9a25f6f"],
Cell[5069, 106, 1303, 20, 44, "Print",ExpressionUUID->"1597d80e-8c36-4535-9b64-6ef0b522a341"],
Cell[6375, 128, 1299, 20, 44, "Print",ExpressionUUID->"0dd3a82f-e44a-48de-868b-d6771b4d10ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7723, 154, 1794, 53, 192, "Input",ExpressionUUID->"79f40ed2-03df-4afd-82e1-9bb0cd59327a"],
Cell[9520, 209, 497, 7, 65, "Output",ExpressionUUID->"3263128d-a4f7-4fb3-a6f3-5739111b9e88"]
}, Open  ]],
Cell[10032, 219, 40200, 1054, 910, "Code",ExpressionUUID->"18a4c61e-41a1-4a4d-a058-b41b9bcf268e"],
Cell[50235, 1275, 27960, 664, 1050, "Code",ExpressionUUID->"89ffd185-ce06-4f2a-a5ca-43f218fab69a"],
Cell[78198, 1941, 25267, 731, 1011, "Code",ExpressionUUID->"a7347433-bc0a-415f-a991-f1d917b042cc"],
Cell[103468, 2674, 386, 8, 97, "Input",ExpressionUUID->"e57b5d87-4e76-402b-a65f-4dec5ca586e4"],
Cell[103857, 2684, 4853, 117, 292, "Input",ExpressionUUID->"fcb1614d-b659-4324-8830-d8b0f1acc9a0"],
Cell[108713, 2803, 1951, 51, 156, "Input",ExpressionUUID->"fa9cbc37-036d-4d76-bd68-51d3b2d30509"],
Cell[110667, 2856, 1644, 38, 175, "Input",ExpressionUUID->"d628807b-aa81-45c3-82a8-5a1d06239424"],
Cell[112314, 2896, 371, 8, 57, "Input",ExpressionUUID->"0bd2caf7-7a8a-451f-b9b2-62e2d6561f9d"],
Cell[CellGroupData[{
Cell[112710, 2908, 5075, 119, 487, "Input",ExpressionUUID->"41dd2337-fa74-41e4-abba-5522f6cf5665"],
Cell[117788, 3029, 503, 8, 65, "Output",ExpressionUUID->"97bc0ff2-25a9-4fff-a4fd-17377a78e15d"]
}, Open  ]],
Cell[118306, 3040, 416, 9, 57, "Input",ExpressionUUID->"17241c30-7b2a-4b53-9a4c-b2e7134e7d09"],
Cell[CellGroupData[{
Cell[118747, 3053, 5033, 120, 526, "Input",ExpressionUUID->"3f14e009-cdc2-4d55-8b12-d2775ad09ccd"],
Cell[123783, 3175, 397, 7, 65, "Output",ExpressionUUID->"634febcb-59ea-4e84-baa2-47f2f14ebb9c"]
}, Open  ]],
Cell[124195, 3185, 468, 11, 57, "Input",ExpressionUUID->"53483cb6-9075-494d-ae0f-91de8efac70c"],
Cell[124666, 3198, 283, 7, 57, "Input",ExpressionUUID->"18aabd92-a684-4b7c-b72e-3bbae553053e"],
Cell[CellGroupData[{
Cell[124974, 3209, 12110, 307, 1228, "Input",ExpressionUUID->"a4db6eb3-fd47-41ad-8bd7-13b7edd81898"],
Cell[137087, 3518, 905, 13, 65, "Output",ExpressionUUID->"738c09a6-fc3a-412a-8eb2-ebb93bc05654"],
Cell[137995, 3533, 908, 13, 65, "Output",ExpressionUUID->"523bdf9b-b242-46d6-80af-a50a335e93eb"]
}, Open  ]],
Cell[138918, 3549, 804, 17, 136, "Input",ExpressionUUID->"3304ccc8-0aca-417c-b5a4-ebd672f550f7"],
Cell[139725, 3568, 5008, 130, 526, "Input",ExpressionUUID->"6d77b17e-9386-4a7d-9d46-999e8ca54d05"],
Cell[144736, 3700, 922, 18, 97, "Input",ExpressionUUID->"68303b2c-926d-4456-8eb9-1919fca90a9b"],
Cell[145661, 3720, 136, 3, 57, "Input",ExpressionUUID->"65198cbe-c6d6-4d19-8dd6-37b388aee3d2"],
Cell[145800, 3725, 473, 11, 97, "Input",ExpressionUUID->"64b1f2a0-ff34-4b0e-b8f9-8f7e23adbac1"],
Cell[CellGroupData[{
Cell[146298, 3740, 650, 18, 92, "Input",ExpressionUUID->"d023032e-d393-41c2-9bc1-7770f114b92d"],
Cell[146951, 3760, 303, 6, 65, "Output",ExpressionUUID->"36279cd4-5388-4744-86d1-7ed24e8a67bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147291, 3771, 199, 3, 57, "Input",ExpressionUUID->"a4956612-0502-47bb-8c37-3aae6b1f16fe"],
Cell[147493, 3776, 224, 3, 65, "Output",ExpressionUUID->"295c03ec-2a3a-4060-8585-1cc1e07f67de"]
}, Open  ]],
Cell[147732, 3782, 212, 4, 57, "Input",ExpressionUUID->"a0532bc5-9c2c-4493-b032-6538264ba546"],
Cell[147947, 3788, 1448, 40, 92, "Input",ExpressionUUID->"41605690-b526-454b-a24c-592efc8dd20c"],
Cell[149398, 3830, 2037, 47, 97, "Input",ExpressionUUID->"f8d7504c-18f5-465b-8257-a87f68a52bb4"],
Cell[151438, 3879, 452, 10, 57, "Input",ExpressionUUID->"da2cd07c-8273-42cb-a64e-7de102001d8f"],
Cell[151893, 3891, 3754, 94, 272, "Input",ExpressionUUID->"70b44ab2-283e-4480-8102-a50d86630c9f"],
Cell[155650, 3987, 3929, 96, 330, "Input",ExpressionUUID->"136f8e91-52ec-448f-b91c-540ea1765139"],
Cell[159582, 4085, 522, 12, 57, "Input",ExpressionUUID->"69b25096-0f20-4de3-9bf2-24c5ab0afda6"],
Cell[160107, 4099, 2582, 64, 97, "Input",ExpressionUUID->"e87e0340-bbc1-497f-8a9b-94266332499f"],
Cell[162692, 4165, 2344, 61, 97, "Input",ExpressionUUID->"017e8247-bded-46b6-ac7c-4f5cf13c24b8"],
Cell[165039, 4228, 423, 7, 57, "Input",ExpressionUUID->"3ea9b5a1-13f1-4f11-bc39-111164a9dcb7"],
Cell[165465, 4237, 528, 10, 57, "Input",ExpressionUUID->"9dd9de1f-2678-4865-8cca-4be8e8a2ab44"],
Cell[165996, 4249, 31389, 811, 124, "Code",ExpressionUUID->"2d7c4545-bbd9-45e8-b9a1-458e3a2006b3"],
Cell[197388, 5062, 1615, 39, 93, "Input",ExpressionUUID->"b1e21b55-be89-411e-a7bf-7b4c4b77f13a"],
Cell[199006, 5103, 1939, 54, 136, "Input",ExpressionUUID->"ce6ab76f-c2bc-49a9-a15e-35fe14619d98"],
Cell[200948, 5159, 823, 17, 97, "Input",ExpressionUUID->"fcec85a8-89bc-41f7-a066-d105c0a0218a"],
Cell[201774, 5178, 1599, 39, 97, "Input",ExpressionUUID->"19ccb98b-31fd-4ade-972b-97d86d10ccbc"],
Cell[203376, 5219, 1527, 36, 57, "Input",ExpressionUUID->"94eb7f4f-ebbc-4c73-bb10-39d939fee84b"],
Cell[204906, 5257, 491, 10, 57, "Input",ExpressionUUID->"178799b1-7023-4726-bb7e-d4e5b6b0dac8"],
Cell[205400, 5269, 4311, 111, 266, "Input",ExpressionUUID->"35bbdda6-bd4d-48b9-b31c-3d50768671b1"],
Cell[209714, 5382, 387, 10, 57, "Input",ExpressionUUID->"ca7eca6e-390e-4789-85c8-65f5b1f35f25"],
Cell[CellGroupData[{
Cell[210126, 5396, 1557, 39, 97, "Input",ExpressionUUID->"c79ec8f9-2a23-491b-9a9c-4aff92d6941a"],
Cell[211686, 5437, 262, 5, 65, "Output",ExpressionUUID->"c0d93566-7731-4ae4-9a85-4df92471f94a"]
}, Open  ]],
Cell[211963, 5445, 443, 15, 464, "Text",ExpressionUUID->"5c7ad367-db04-4735-a956-e17ff1220923"],
Cell[212409, 5462, 270, 7, 57, "Input",ExpressionUUID->"0e01736a-f420-4e69-ad27-7ec7109b848c"],
Cell[CellGroupData[{
Cell[212704, 5473, 977, 24, 57, "Input",ExpressionUUID->"52fbb746-baf4-437c-8863-89fd19b6cf73"],
Cell[213684, 5499, 740, 14, 65, "Output",ExpressionUUID->"787bd156-d133-46df-94ee-a4b1423efd2b"]
}, Open  ]],
Cell[214439, 5516, 365, 8, 57, "Input",ExpressionUUID->"571e60f1-5562-4c93-8644-b909340ae555"],
Cell[214807, 5526, 4722, 121, 289, "Input",ExpressionUUID->"2f446743-d9c6-4d30-be1a-47fe20f1df08"],
Cell[CellGroupData[{
Cell[219554, 5651, 1345, 37, 97, "Input",ExpressionUUID->"0e424895-3b45-484f-a734-5f1e284e202f"],
Cell[220902, 5690, 162, 3, 65, "Output",ExpressionUUID->"2c98aec5-b1d0-4b6e-9dcf-ef4f34298da8"]
}, Open  ]],
Cell[221079, 5696, 556, 12, 57, "Input",ExpressionUUID->"73bf2fab-0147-4ecf-b7e8-7fa897471588"],
Cell[221638, 5710, 318, 8, 57, "Input",ExpressionUUID->"5d117e63-8047-46a9-8e0a-3415c16211e2"],
Cell[221959, 5720, 1133, 30, 57, "Input",ExpressionUUID->"dadbcf03-ff66-47f0-b398-e49c6418a426"],
Cell[223095, 5752, 241, 5, 57, "Input",ExpressionUUID->"9700d180-dfcd-43d4-9138-c98e78dbbf21"],
Cell[223339, 5759, 1251, 34, 98, "Input",ExpressionUUID->"8aa1c539-ea6c-4af1-9a63-fc0df0b1be84"],
Cell[CellGroupData[{
Cell[224615, 5797, 1910, 52, 97, "Input",ExpressionUUID->"a1176629-f02b-419b-ab5a-947ba57603f4"],
Cell[226528, 5851, 227, 4, 65, "Output",ExpressionUUID->"46eed54d-e9a0-4ca8-9d46-3d240a371bea"],
Cell[226758, 5857, 229, 4, 65, "Output",ExpressionUUID->"95846a94-26aa-4640-96b7-231df4285f5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227024, 5866, 3648, 101, 214, "Input",ExpressionUUID->"a84e9d89-cf8a-44d6-9699-26649b53828f"],
Cell[230675, 5969, 601, 10, 65, "Output",ExpressionUUID->"4c749995-b8d1-44b6-b359-d782cbcfc3eb"],
Cell[231279, 5981, 601, 10, 65, "Output",ExpressionUUID->"01c70b7e-d36c-46b8-94a0-0319e7b088ee"],
Cell[231883, 5993, 601, 10, 65, "Output",ExpressionUUID->"9dfba747-d866-4c47-a135-9133389159f7"]
}, Open  ]],
Cell[232499, 6006, 171, 2, 57, "Input",ExpressionUUID->"367d2eac-8f1c-422d-b761-56942b73b934"],
Cell[232673, 6010, 254, 5, 57, "Input",ExpressionUUID->"911151da-b5d0-4d88-bbd6-1efcf386e057"],
Cell[232930, 6017, 246, 5, 57, "Input",ExpressionUUID->"cee0c938-236c-4d4a-8fcc-b1548dfca9f0"],
Cell[CellGroupData[{
Cell[233201, 6026, 570, 15, 57, "Input",ExpressionUUID->"01b9a7fd-028c-4906-8577-763923620957"],
Cell[233774, 6043, 423, 7, 136, "Output",ExpressionUUID->"c4cb8468-0dc1-49fa-af1b-7ce8d3565f79"]
}, Open  ]]
}
]
*)

